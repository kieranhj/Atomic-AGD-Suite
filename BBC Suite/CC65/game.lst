ca65 V2.17 - Git cc5c093
Main file   : game.asm
Current file: game.asm

000000r 1               ;----------------------------------------------
000000r 1               ; BBC AGD Engine
000000r 1               ; Z80 conversion by Kees van Oss 2017
000000r 1               ; BBC Micro version by Kieran Connell 2018
000000r 1               ;----------------------------------------------
000000r 1               
000000r 1               .DEFINE asm_code $0e00		; assembly address _BEEB
000000r 1               .DEFINE load_address $1200	; load address _BEEB
000000r 1               
000000r 1               ;----------------------------------------------------------------------
000000r 1               ; BBC MICRO PLATFORM DEFINES
000000r 1               ;----------------------------------------------------------------------
000000r 1               
000000r 1               ; _BEEB MOS calls
000000r 1               
000000r 1               	OSBYTE	 = $fff4
000000r 1               	OSFILE	 = $ffdd
000000r 1               	OSWRCH	 = $ffee
000000r 1               	OSASCI	 = $ffe3
000000r 1               	OSWORD	 = $fff1
000000r 1               	OSFIND	 = $ffce
000000r 1               	OSGBPB	 = $ffd1
000000r 1               	OSARGS	 = $ffda
000000r 1               
000000r 1               	PAL_black = 0 ^ 7
000000r 1               	PAL_white = 7 ^ 7
000000r 1               
000000r 1               ; System constants
000000r 1               
000000r 1               	ScreenSize  = $1800	; Startaddress video RAM _BEEB
000000r 1               	ScreenAddr 	= $8000 - ScreenSize	; Screen size bytes _BEEB
000000r 1               	ScreenRowBytes = 256				; 40 columns
000000r 1               
000000r 1               	SpriteMaxY	= 177	; used for clipping bottom of screen
000000r 1               
000000r 1               ; AGD Engine Workspace
000000r 1               
000000r 1               	MAP 		= $300				; properties map buffer (3x256 bytes)
000000r 1               	SCADTB_lb	= MAP + $300
000000r 1               	SCADTB_hb	= SCADTB_lb + $100
000000r 1               
000000r 1               .if pflag
000000r 1                   SHRAPN 		= $B00 - (NUMSHR * SHRSIZ)	; shrapnel table (55x6 bytes)
000000r 1               .endif
000000r 1               
000000r 1               	sprtab		= $B00				; NUMSPR*TABSIZ
000000r 1               
000000r 1               ;----------------------------------------------------------------------
000000r 1               ; ZERO PAGE SEGMENT
000000r 1               ;----------------------------------------------------------------------
000000r 1               
000000r 1               .segment "ZEROPAGE"
000000r 1               
000000r 1               .include "z80-zp.inc"
000000r 2               ;ws	 = $60
000000r 2               
000000r 2  xx           z80_f: .res 1;	 = ws+$00
000001r 2  xx           z80_a: .res 1;	 = ws+$01
000002r 2               z80_af	 = z80_f
000002r 2               
000002r 2  xx           z80_c: .res 1;	 = ws+$02
000003r 2  xx           z80_b: .res 1;	 = ws+$03
000004r 2               z80_bc	 = z80_c
000004r 2               
000004r 2  xx           z80_e: .res 1;	 = ws+$04
000005r 2  xx           z80_d: .res 1;	 = ws+$05
000006r 2               z80_de	 = z80_e
000006r 2               
000006r 2  xx           z80_l: .res 1;	 = ws+$06
000007r 2  xx           z80_h: .res 1;	 = ws+$07
000008r 2               z80_hl	 = z80_l
000008r 2               
000008r 2  xx           z80_x: .res 1;    = ws+$08
000009r 2  xx           z80_i: .res 1;    = ws+$09
00000Ar 2               z80_ix	 = z80_x
00000Ar 2               
00000Ar 2  xx xx        z80_iy: .res 2;	 = ws+$0a
00000Cr 2               
00000Cr 2  xx           z80_fp: .res 1;	 = ws+$0c
00000Dr 2  xx           z80_ap: .res 1;	 = ws+$0d
00000Er 2               
00000Er 2  xx           z80_cp: .res 1;	 = ws+$0e
00000Fr 2  xx           z80_bp: .res 1;	 = ws+$0f
000010r 2               z80_bcp	 = z80_cp
000010r 2               
000010r 2  xx           z80_ep: .res 1;	 = ws+$10
000011r 2  xx           z80_dp: .res 1;	 = ws+$11
000012r 2               z80_dep	 = z80_ep
000012r 2               
000012r 2  xx           z80_lp: .res 1;	 = ws+$12
000013r 2  xx           z80_hp: .res 1;	 = ws+$13
000014r 2               z80_hlp	 = z80_lp
000014r 2               
000014r 2  xx xx        z80_sp: .res 2;   = ws+$14
000016r 2               
000016r 2  xx           z80_reg0: .res 1; = ws+$16
000017r 2  xx           z80_reg1: .res 1; = ws+$17
000018r 2  xx           z80_reg2: .res 1; = ws+$18
000019r 2  xx           z80_reg3: .res 1; = ws+$19
00001Ar 2               
00001Ar 2               ;z80_r: .res 1;	 = ws+$1a
00001Ar 2               
00001Ar 1               .include "engine-zp.inc"
00001Ar 2               ;----------------------------------------------------------------------
00001Ar 2               ; AGD 6502 Engine Zero Page Variables
00001Ar 2               ;----------------------------------------------------------------------
00001Ar 2               
00001Ar 2               ; Variables start here.
00001Ar 2               
00001Ar 2  xx           scno:	.res 1			; present screen number.
00001Br 2  xx           numlif:	.res 1			; number of lives.
00001Cr 2               
00001Cr 2  xx           vara:	.res 1			; general-purpose variable.
00001Dr 2  xx           varb:	.res 1			; general-purpose variable.
00001Er 2  xx           varc:	.res 1			; general-purpose variable.
00001Fr 2  xx           vard:	.res 1			; general-purpose variable.
000020r 2  xx           vare:	.res 1			; general-purpose variable.
000021r 2  xx           varf:	.res 1			; general-purpose variable.
000022r 2  xx           varg:	.res 1			; general-purpose variable.
000023r 2  xx           varh:	.res 1			; general-purpose variable.
000024r 2  xx           vari:	.res 1			; general-purpose variable.
000025r 2  xx           varj:	.res 1			; general-purpose variable.
000026r 2  xx           vark:	.res 1			; general-purpose variable.
000027r 2  xx           varl:	.res 1			; general-purpose variable.
000028r 2  xx           varm:	.res 1			; general-purpose variable.
000029r 2  xx           varn:	.res 1			; general-purpose variable.
00002Ar 2  xx           varo:	.res 1			; general-purpose variable.
00002Br 2  xx           varp:	.res 1			; general-purpose variable.
00002Cr 2  xx           varq:	.res 1			; general-purpose variable.
00002Dr 2  xx           varr:	.res 1			; general-purpose variable.
00002Er 2  xx           vars:	.res 1			; general-purpose variable.
00002Fr 2  xx           vart:	.res 1			; general-purpose variable.
000030r 2  xx           varu:	.res 1			; general-purpose variable.
000031r 2  xx           varv:	.res 1			; general-purpose variable.
000032r 2  xx           varw:	.res 1			; general-purpose variable.
000033r 2  xx           varz:	.res 1			; general-purpose variable.
000034r 2               
000034r 2  xx           charx:	.res 1			; cursor x position.
000035r 2  xx           chary:	.res 1			; cursor y position.
000036r 2               
000036r 2  xx           clock:	.res 1			; last clock reading.
000037r 2  xx           varrnd:	.res 1	        ; last random number.
000038r 2  xx           varobj:	.res 1  	    ; last object number.
000039r 2  xx           varopt:	.res 1     		; last option chosen from menu.
00003Ar 2  xx           varblk:	.res 1  		; block type.
00003Br 2  xx           nexlev:	.res 1			; next level flag.
00003Cr 2  xx           restfl:	.res 1			; restart screen flag.
00003Dr 2  xx           deadf:	.res 1			; dead flag.
00003Er 2  xx           gamwon:	.res 1			; game won flag.
00003Fr 2  xx           dispx:	.res 1			; cursor x position.
000040r 2  xx           dispy:	.res 1			; cursor y position.
000041r 2               
000041r 2  xx           contrl:	.res 1			; control = keyboard, 1 = Kempston, 2 = Sinclair, 3 = Mouse.
000042r 2  xx           joyval:	.res 1			; joystick reading.
000043r 2  xx           frmno:	.res 1			; selected frame.
000044r 2               
000044r 2               ;----------------------------------------------------
000044r 2               ; Missing vars
000044r 2               ;----------------------------------------------------
000044r 2               
000044r 2  xx           loopa:		.res 1
000045r 2  xx           loopb:		.res 1
000046r 2  xx           loopc:		.res 1
000047r 2  xx xx        FontPtr:    .res 2
000049r 2               
000049r 2               ; Local vars
000049r 2               
000049r 2  xx xx        scraddr:    .res 2
00004Br 2  xx xx        fntaddr:    .res 2
00004Dr 2  xx xx        tileaddr:   .res 2
00004Fr 2  xx xx        bufaddr:    .res 2
000051r 2               
000051r 2  xx xx        tmp:        .res 2
000053r 2  xx xx        scr_l:      .res 2
000055r 2  xx xx        scr_r:      .res 2
000057r 2  xx xx        scr_txt:    .res 2
000059r 2               
000059r 2  xx           xtmp:	    .res 1
00005Ar 2  xx           spcnt:	    .res 1
00005Br 2  xx xx        spptr:	    .res 2		; spawned sprite pointer.
00005Dr 2  xx           seed:	    .res 1		; seed for random numbers.
00005Er 2               
00005Er 2  xx           ccnt:       .res 1
00005Fr 2  xx           flag:	    .res 1
000060r 2  xx           rcol:	    .res 1
000061r 2  xx           rrow:	    .res 1
000062r 2               
000062r 2  xx           combyt:	    .res 1		; byte type compressed.
000063r 2  xx           comcnt:	    .res 1		; compression counter.
000064r 2  xx           prtmod:	    .res 1      ; print mode, 0 = standard, 1 = double-height.
000065r 2  xx           qscnt:	    .res 1
000066r 2               
000066r 2  xx           sprptr:	    .res 1      ; not a ptr
000067r 2  xx           sprcnt:	    .res 1
000068r 2               
000068r 2  xx xx        skptr:	    .res 2		; search pointer.
00006Ar 2  xx           sktptr:	    .res 1      ; not a ptr
00006Br 2  xx           tmproom:	.res 1
00006Cr 2  xx xx        ogptr:	    .res 2		; original sprite pointer.
00006Er 2               
00006Er 2               .if mflag
00006Er 2               TmpAddr:	.res 2
00006Er 2               bwid:	    .res 1     ; box/menu width.
00006Er 2               blen:	    .res 1     ; box/menu height.
00006Er 2               btop:	    .res 1     ; box coordinates.
00006Er 2               blft:	    .res 1
00006Er 2               .endif
00006Er 2               
00006Er 2               .if pflag
00006Er 2               shrctr:	    .res 1
00006Er 2               explcnt:	.res 1
00006Er 2               seed3:	    .res 1
00006Er 2               .endif
00006Er 2               
00006Er 1               
00006Er 1               ;----------------------------------------------------------------------
00006Er 1               ; ZCODE SEGMENT
00006Er 1               ;----------------------------------------------------------------------
00006Er 1               
00006Er 1               .segment "CODE"
000000r 1               .org asm_code
000E00  1               
000E00  1               start_asm:
000E00  1               
000E00  1  4C E0 78     	jmp relocate + load_address - asm_code
000E03  1               
000E03  1               boot_game:
000E03  1               
000E03  1               ; Zero ZP vars
000E03  1               
000E03  1               clear_zp:
000E03  1  A2 00        	ldx #0
000E05  1  8A           	txa
000E06  1               	:
000E06  1  95 00        	sta $00, x
000E08  1  E8           	inx
000E09  1  E0 A0        	cpx #$a0
000E0B  1  D0 F9        	bne :-
000E0D  1               
000E0D  1               	; Init non-zero vars
000E0D  1  A9 03        	lda #3
000E0F  1  85 rr        	sta numlif
000E11  1               
000E11  1  A2 FF        	ldx #255
000E13  1  86 rr        	stx varrnd
000E15  1  86 rr        	stx varopt
000E17  1  86 rr        	stx varblk
000E19  1  CA           	dex
000E1A  1  86 rr        	stx varobj
000E1C  1               
000E1C  1               	; Call AGD Engine start game
000E1C  1  20 6D 10     	jsr start_game
000E1F  1               
000E1F  1                   ; Wait for keypress
000E1F  1  A2 FF        	ldx #$ff
000E21  1  A0 7F        	ldy #$7f
000E23  1  A9 81        	lda #$81
000E25  1  20 F4 FF     	jsr OSBYTE
000E28  1               
000E28  1               	; Restart or exit
000E28  1  4C 03 0E     	jmp boot_game
000E2B  1               
000E2B  1               ;----------------------------------------------------------------------
000E2B  1               ; PLATFORM SPECIFIC ENGINE CODE
000E2B  1               ;----------------------------------------------------------------------
000E2B  1               
000E2B  1               	.include "z80.asm"
000E2B  2               ;------------------------------------------------------
000E2B  2               ; z80.asm
000E2B  2               ; spectrum stuff
000E2B  2               ; adresses
000E2B  2               
000E2B  2               ;ws	 = $60
000E2B  2               
000E2B  2               ;z80_f	 = ws+$00
000E2B  2               ;z80_a	 = ws+$01
000E2B  2               ;z80_af	 = z80_f
000E2B  2               
000E2B  2               ;z80_c	 = ws+$02
000E2B  2               ;z80_b	 = ws+$03
000E2B  2               ;z80_bc	 = z80_c
000E2B  2               
000E2B  2               ;z80_e	 = ws+$04
000E2B  2               ;z80_d	 = ws+$05
000E2B  2               ;z80_de	 = z80_e
000E2B  2               
000E2B  2               ;z80_l	 = ws+$06
000E2B  2               ;z80_h	 = ws+$07
000E2B  2               ;z80_hl	 = z80_l
000E2B  2               
000E2B  2               ;z80_x    = ws+$08
000E2B  2               ;z80_i    = ws+$09
000E2B  2               ;z80_ix	 = z80_x
000E2B  2               
000E2B  2               ;z80_iy	 = ws+$0a
000E2B  2               
000E2B  2               ;z80_fp	 = ws+$0c
000E2B  2               ;z80_ap	 = ws+$0d
000E2B  2               
000E2B  2               ;z80_cp	 = ws+$0e
000E2B  2               ;z80_bp	 = ws+$0f
000E2B  2               ;z80_bcp = z80_cp
000E2B  2               
000E2B  2               ;z80_ep	 = ws+$10
000E2B  2               ;z80_dp	 = ws+$11
000E2B  2               ;z80_dep = z80_ep
000E2B  2               
000E2B  2               ;z80_lp	 = ws+$12
000E2B  2               ;z80_hp	 = ws+$13
000E2B  2               ;z80_hlp = z80_lp
000E2B  2               
000E2B  2               ;z80_sp   = ws+$14
000E2B  2               
000E2B  2               ;z80_reg0 = ws+$16
000E2B  2               ;z80_reg1 = ws+$17
000E2B  2               ;z80_reg2 = ws+$18
000E2B  2               ;z80_reg3 = ws+$19
000E2B  2               
000E2B  2               ;z80_r	 = ws+$1a
000E2B  2               
000E2B  2               ; Contains seperatly 1 bit set
000E2B  2               ; _BEEB this is not safe memory to use as required by MOS
000E2B  2               
000E2B  2               _bitmem0	= $f8
000E2B  2               _bitmem1	= $f9
000E2B  2               _bitmem2	= $fa
000E2B  2               _bitmem3	= $fb
000E2B  2               _bitmem4	= $fc
000E2B  2               _bitmem5	= $fd
000E2B  2               _bitmem6	= $fe
000E2B  2               _bitmem7	= $ff
000E2B  2               
000E2B  2               ; constants
000E2B  2               _bitvalue0	= $01
000E2B  2               _bitvalue1	= $02
000E2B  2               _bitvalue2	= $04
000E2B  2               _bitvalue3	= $08
000E2B  2               _bitvalue4	= $10
000E2B  2               _bitvalue5	= $20
000E2B  2               _bitvalue6	= $40
000E2B  2               _bitvalue7	= $80
000E2B  2               
000E2B  2               _notbitvalue0	= $fe
000E2B  2               _notbitvalue1	= $fd
000E2B  2               _notbitvalue2	= $fb
000E2B  2               _notbitvalue3	= $f7
000E2B  2               _notbitvalue4	= $ef
000E2B  2               _notbitvalue5	= $df
000E2B  2               _notbitvalue6	= $bf
000E2B  2               _notbitvalue7	= $7f
000E2B  2               
000E2B  2               
000E2B  2               ;add_hl_bc:
000E2B  2               ;		lda z80_l
000E2B  2               ;		clc
000E2B  2               ;		adc z80_c
000E2B  2               ;		sta z80_l
000E2B  2               ;		lda z80_h
000E2B  2               ;		adc z80_b
000E2B  2               ;		sta z80_h
000E2B  2               ;		rts
000E2B  2               ;
000E2B  2               ;add_ix_de:
000E2B  2               ;		lda z80_ix
000E2B  2               ;		clc
000E2B  2               ;		adc z80_e
000E2B  2               ;		sta z80_ix
000E2B  2               ;		lda z80_ix+1
000E2B  2               ;		adc z80_d
000E2B  2               ;		sta z80_ix+1
000E2B  2               ;		rts
000E2B  2               ;
000E2B  2               ;add_iy_de:
000E2B  2               ;		lda z80_iy
000E2B  2               ;		clc
000E2B  2               ;		adc z80_e
000E2B  2               ;		sta z80_iy
000E2B  2               ;		lda z80_iy+1
000E2B  2               ;		adc z80_d
000E2B  2               ;		sta z80_iy+1
000E2B  2               ;		rts
000E2B  2               ;
000E2B  2               ;add_hl_de:
000E2B  2               ;		lda z80_l
000E2B  2               ;		clc
000E2B  2               ;		adc z80_e
000E2B  2               ;		sta z80_l
000E2B  2               ;		lda z80_h
000E2B  2               ;		adc z80_d
000E2B  2               ;		sta z80_h
000E2B  2               ;		rts
000E2B  2               ;
000E2B  2               ;add_ix_bc:
000E2B  2               ;		lda z80_ix
000E2B  2               ;		clc
000E2B  2               ;		adc z80_c
000E2B  2               ;		sta z80_ix
000E2B  2               ;		lda z80_ix+1
000E2B  2               ;		adc z80_b
000E2B  2               ;		sta z80_ix+1
000E2B  2               ;		rts
000E2B  2               ;
000E2B  2               ;add_iy_bc:
000E2B  2               ;		lda z80_iy
000E2B  2               ;		clc
000E2B  2               ;		adc z80_c
000E2B  2               ;		sta z80_iy
000E2B  2               ;		lda z80_iy+1
000E2B  2               ;		adc z80_b
000E2B  2               ;		sta z80_iy+1
000E2B  2               ;		rts
000E2B  2               ;
000E2B  2               ;sbc_hl_de:
000E2B  2               ;		lda z80_l
000E2B  2               ;		sbc z80_e
000E2B  2               ;		sta z80_l
000E2B  2               ;		lda z80_h
000E2B  2               ;		sbc z80_d
000E2B  2               ;		sta z80_h
000E2B  2               ;		rts
000E2B  2               ;
000E2B  2               ;sbc_hl_bc:
000E2B  2               ;		lda z80_l
000E2B  2               ;		sbc z80_c
000E2B  2               ;		sta z80_l
000E2B  2               ;		lda z80_h
000E2B  2               ;		sbc z80_b
000E2B  2               ;		sta z80_h
000E2B  2               ;		rts
000E2B  2               ;
000E2B  2               ;cmp_hl_bc:
000E2B  2               ;		lda z80_l
000E2B  2               ;		cmp z80_c
000E2B  2               ;		bne cmp_hl_bc_end
000E2B  2               ;		lda z80_h
000E2B  2               ;		cmp z80_b
000E2B  2               ;cmp_hl_bc_end:
000E2B  2               ;		rts
000E2B  2               ;
000E2B  2               ;cmp_iy_ix:
000E2B  2               ;		lda z80_iy
000E2B  2               ;		cmp z80_ix
000E2B  2               ;		bne cmp_iy_ix_end
000E2B  2               ;		lda z80_iy+1
000E2B  2               ;		cmp z80_ix+1
000E2B  2               ;cmp_iy_ix_end:
000E2B  2               ;		rts
000E2B  2               ;
000E2B  2               ;dec_hl:
000E2B  2               ;		lda z80_l
000E2B  2               ;		bne dec_hl_no_dec_h
000E2B  2               ;		dec z80_h
000E2B  2               ;dec_hl_no_dec_h:
000E2B  2               ;		dec z80_l
000E2B  2               ;		rts
000E2B  2               ;
000E2B  2               ;dec_ix:
000E2B  2               ;		lda z80_ix
000E2B  2               ;		bne dec_ix_no_dec_h
000E2B  2               ;		dec z80_ix+1
000E2B  2               ;dec_ix_no_dec_h:
000E2B  2               ;		dec z80_ix
000E2B  2               ;		rts
000E2B  2               ;
000E2B  2               ;dec_bc:
000E2B  2               ;		lda z80_c
000E2B  2               ;		bne dec_bc_no_dec_b
000E2B  2               ;		dec z80_b
000E2B  2               ;dec_bc_no_dec_b:
000E2B  2               ;		dec z80_c
000E2B  2               ;		rts
000E2B  2               ;
000E2B  2               ;dec_de:
000E2B  2               ;		lda z80_e
000E2B  2               ;		bne dec_de_no_dec_d
000E2B  2               ;		dec z80_d
000E2B  2               ;dec_de_no_dec_d:
000E2B  2               ;		dec z80_e
000E2B  2               ;		rts
000E2B  2               ;
000E2B  2               ;ex_af_afs:
000E2B  2               ;	rts
000E2B  2               ;ex_de_hl:
000E2B  2               ;		lda z80_e
000E2B  2               ;		ldx z80_l
000E2B  2               ;		stx z80_e
000E2B  2               ;		sta z80_l
000E2B  2               ;		lda z80_d
000E2B  2               ;		ldx z80_h
000E2B  2               ;		stx z80_d
000E2B  2               ;		sta z80_h
000E2B  2               ;		rts
000E2B  2               ;
000E2B  2               exx:
000E2B  2  A5 rr        		lda z80_c
000E2D  2  A4 rr        		ldy z80_cp
000E2F  2  84 rr        		sty z80_c
000E31  2  85 rr        		sta z80_cp
000E33  2  A5 rr        		lda z80_b
000E35  2  A4 rr        		ldy z80_bp
000E37  2  84 rr        		sty z80_b
000E39  2  85 rr        		sta z80_bp
000E3B  2  A5 rr        		lda z80_e
000E3D  2  A4 rr        		ldy z80_ep
000E3F  2  84 rr        		sty z80_e
000E41  2  85 rr        		sta z80_ep
000E43  2  A5 rr        		lda z80_d
000E45  2  A4 rr        		ldy z80_dp
000E47  2  84 rr        		sty z80_d
000E49  2  85 rr        		sta z80_dp
000E4B  2  A5 rr        		lda scraddr
000E4D  2  A4 rr        		ldy z80_lp
000E4F  2  84 rr        		sty scraddr
000E51  2  85 rr        		sta z80_lp
000E53  2  A5 rr        		lda scraddr+1
000E55  2  A4 rr        		ldy z80_hp
000E57  2  84 rr        		sty scraddr+1
000E59  2  85 rr        		sta z80_hp
000E5B  2  60           		rts
000E5C  2               
000E5C  2               ;ex_sp_hl:
000E5C  2               ;		tsx
000E5C  2               ;		lda $0103,x
000E5C  2               ;		ldy z80_h
000E5C  2               ;		sta z80_h
000E5C  2               ;		tya
000E5C  2               ;		sta $0103,x
000E5C  2               ;		lda $0104,x
000E5C  2               ;		ldy z80_l
000E5C  2               ;		sta z80_l
000E5C  2               ;		tya
000E5C  2               ;		sta $104,x
000E5C  2               ;		rts
000E5C  2               ;
000E5C  2               ;ldi:
000E5C  2               ;	rts
000E5C  2               ;ldir:
000E5C  2               ;		ldy #$00
000E5C  2               ;		ldx z80_b
000E5C  2               ;		beq ldir_last_page
000E5C  2               ;ldir_loop:
000E5C  2               ;		lda (z80_hl),y
000E5C  2               ;		sta (z80_de),y
000E5C  2               ;		iny
000E5C  2               ;		bne ldir_loop
000E5C  2               ;		inc z80_h
000E5C  2               ;		inc z80_d
000E5C  2               ;		dex
000E5C  2               ;		bne ldir_loop
000E5C  2               ;ldir_last_page:
000E5C  2               ;		lda z80_c
000E5C  2               ;		beq ldir_end
000E5C  2               ;ldir_last_page_loop:
000E5C  2               ;		lda (z80_hl),y
000E5C  2               ;		sta (z80_de),y
000E5C  2               ;		iny
000E5C  2               ;		cpy z80_c
000E5C  2               ;		bne ldir_last_page_loop
000E5C  2               ;ldir_end:
000E5C  2               ;		stx z80_c
000E5C  2               ;		stx z80_b
000E5C  2               ;		tya
000E5C  2               ;		clc
000E5C  2               ;		adc z80_l
000E5C  2               ;		sta z80_l
000E5C  2               ;		bcc *+4
000E5C  2               ;		inc z80_h
000E5C  2               ;		tya
000E5C  2               ;		clc
000E5C  2               ;		adc z80_e
000E5C  2               ;		sta z80_e
000E5C  2               ;		bcc *+4
000E5C  2               ;		inc z80_d
000E5C  2               ;		rts
000E5C  2               ;
000E5C  2               ;lddr:		ldy #$00
000E5C  2               ;lddr_loop:
000E5C  2               ;		lda (z80_hl),y
000E5C  2               ;		sta (z80_de),y
000E5C  2               ;		jsr dec_hl
000E5C  2               ;		jsr dec_de
000E5C  2               ;		jsr dec_bc
000E5C  2               ;		lda z80_b
000E5C  2               ;		ora z80_c
000E5C  2               ;		bne lddr_loop
000E5C  2               ;		rts
000E5C  2               ;ei:
000E5C  2               ;		rts
000E5C  2               ;di:
000E5C  2               ;		rts
000E5C  2               
000E5C  2               ;-------------------------------------------------------------
000E5C  2               ; Set bits in bitmem
000E5C  2               ;-------------------------------------------------------------
000E5C  2               
000E5C  2               .if 0
000E5C  2               z80_init:
000E5C  2               	ldx #$00
000E5C  2               	lda #$01
000E5C  2               z80_init_loop:
000E5C  2               	sta _bitmem0,x
000E5C  2               	inx
000E5C  2               	asl a
000E5C  2               	bne z80_init_loop
000E5C  2               	rts
000E5C  2               .endif
000E5C  2               
000E5C  2               push_af:
000E5C  2               push_bc:
000E5C  2               push_de:
000E5C  2               push_hl:
000E5C  2               
000E5C  2               pop_af:
000E5C  2               pop_bc:
000E5C  2               pop_de:
000E5C  2               pop_ix:
000E5C  2               pop_hl:
000E5C  2               
000E5C  2               add_hl_hl:
000E5C  2               
000E5C  2               inc_bc:
000E5C  2               inc_de:
000E5C  2               inc_hl:
000E5C  2               inc_ix:
000E5C  2               inc_sp:
000E5C  2               
000E5C  2               cpir:
000E5C  2               
000E5C  2               ex_af_af:
000E5C  2               ;	rts
000E5C  2               
000E5C  1               	.include "bbc.inc"
000E5C  2               ;----------------------------------------------------------------------
000E5C  2               ; BBC Platform Specific functions
000E5C  2               ;----------------------------------------------------------------------
000E5C  2               
000E5C  2               ;--------------------------------------------------------
000E5C  2               ; Keys
000E5C  2               ;
000E5C  2               ; Out: joyval=x65FUDLR (bit cleared if key pressed)
000E5C  2               ;             ||||||||
000E5C  2               ;             |||||||+> Right    KEY 0  - X
000E5C  2               ;             ||||||+-> Left     KEY 1  - Z
000E5C  2               ;             |||||+--> Down     KEY 2  - .
000E5C  2               ;             ||||+---> Up       KEY 3  - ;
000E5C  2               ;             |||+----> Fire1    KEY 4  - SPC
000E5C  2               ;             ||+-----> Fire2    KEY 5  - Q
000E5C  2               ;             |+------> Fire3    KEY 6  - P
000E5C  2               ;             +-------> Not used
000E5C  2               ;
000E5C  2               ;                       Option1  KEY 7  - 1
000E5C  2               ;                       Option2  KEY 8  - 2
000E5C  2               ;                       Option3  KEY 9  - 3
000E5C  2               ;                       Option4  KEY 10 - 4
000E5C  2               ;--------------------------------------------------------
000E5C  2               
000E5C  2               ;              X   Z   .   ;  SPC  Q   P
000E5C  2               ;keys:   .byte $42,$61,$68,$48,$62,$10,$37       ; Keys defined by game designer.
000E5C  2               ;        .byte $30,$31,$11,$12                   ; menu options.
000E5C  2               
000E5C  2  42 61 68 48  jkeys:  .byte $42,$61,$68,$48,$62,$10,$37       ; Keys defined by game designer.
000E60  2  62 10 37     
000E63  2  30 31 11 12          .byte $30,$31,$11,$12                   ; menu options.
000E67  2               
000E67  2               ;----------------------------------------------------
000E67  2               ; Wait for keypress.
000E67  2               ;----------------------------------------------------
000E67  2               
000E67  2               prskey:
000E67  2  8A           	txa
000E68  2  48           	pha
000E69  2               prsloop:
000E69  2  20 BC 0E     	jsr vsync
000E6C  2               
000E6C  2  A9 79        	lda #$79
000E6E  2  A2 01        	ldx #$01
000E70  2  20 F4 FF     	jsr OSBYTE
000E73  2               
000E73  2  E0 FF        	cpx #$ff
000E75  2  F0 F2        	beq prsloop		; wait until key pressed
000E77  2  68           	pla
000E78  2  AA           	tax
000E79  2  60           	rts
000E7A  2               
000E7A  2               ;--------------------------------------------------------
000E7A  2               ; Keyboard test routine.
000E7A  2               ;
000E7A  2               ; Input:
000E7A  2               ;  A = key to read, high nibble=row and low nibble=col
000E7A  2               ;
000E7A  2               ; Output:
000E7A  2               ;  carry clr = key pressed
000E7A  2               ;  carry set = key not pressed
000E7A  2               ;--------------------------------------------------------
000E7A  2               
000E7A  2               ktest:
000E7A  2  85 rr        	sta z80_a		; save key
000E7C  2  98           	tya
000E7D  2  48           	pha
000E7E  2               
000E7E  2               ; _BEEB keyboard read
000E7E  2  A5 rr        	lda z80_a
000E80  2  49 80        	eor #$80		; _BEEB just look for this key
000E82  2  AA           	tax
000E83  2               
000E83  2  A9 79        	lda #$79
000E85  2  20 F4 FF     	jsr OSBYTE
000E88  2               
000E88  2  8A           	txa
000E89  2  30 04        	bmi pressed 	; _BEEB X is negative if key is pressed
000E8B  2               
000E8B  2  38           	sec			; key not pressed
000E8C  2  68           	pla
000E8D  2  A8           	tay
000E8E  2  60           	rts
000E8F  2               
000E8F  2               pressed:
000E8F  2  18           	clc			; key pressed
000E90  2  68           	pla
000E91  2  A8           	tay
000E92  2  60           	rts
000E93  2               
000E93  2               ;---------------------------------------------------------------
000E93  2               ; Getkey in column,row format
000E93  2               ;
000E93  2               ; Output:
000E93  2               ;  A = high nibble=row and low nibble=column key in matrix
000E93  2               ;---------------------------------------------------------------
000E93  2               
000E93  2               kget:
000E93  2  86 rr        	stx xtmp
000E95  2               
000E95  2               kget1:
000E95  2  A9 79        	lda #$79			; _BEEB read keyboard with OSBYTE &79
000E97  2  A2 01        	ldx #$01
000E99  2  20 F4 FF     	jsr OSBYTE
000E9C  2               
000E9C  2  E0 FF        	cpx #$ff
000E9E  2  F0 F5        	beq kget1
000EA0  2               
000EA0  2  8A           	txa
000EA1  2               
000EA1  2  A6 rr        	ldx xtmp
000EA3  2  60           	rts
000EA4  2               
000EA4  2               ;----------------------------------------------------
000EA4  2               ; AtoMMC joystick controls.
000EA4  2               ; _BEEB TODO
000EA4  2               ;----------------------------------------------------
000EA4  2               
000EA4  2               joyinit:
000EA4  2               joysin:
000EA4  2  60           	rts
000EA5  2               
000EA5  2               
000EA5  2               ;----------------------------------------------------
000EA5  2               ; Delay routine 1/50 sec
000EA5  2               ;
000EA5  2               ; Wait 1/60 sec = 16666 usec
000EA5  2               ; Wait 208 x 16 =  3328 usec
000EA5  2               ;                 19994 usec
000EA5  2               ; rts           =     6 usec
000EA5  2               ; Total         = 20000 usec
000EA5  2               ;----------------------------------------------------
000EA5  2               
000EA5  2               delay:
000EA5  2  85 rr        	sta xtmp
000EA7  2               del_loop:
000EA7  2  A9 13        	lda #19
000EA9  2  20 F4 FF     	jsr OSBYTE		; wait for vsync _BEEB
000EAC  2               
000EAC  2  A0 D0        	ldy #208		; wait 208 x 16 = 3328 usec
000EAE  2               delay1:
000EAE  2  61 80        	adc ($80,x)		;	 6 usec
000EB0  2  61 80        	adc ($80,x)		;	 6 usec
000EB2  2  88           	dey			;	 2 usec
000EB3  2  D0 F9        	bne delay1		;	 2 usec
000EB5  2  EA           	nop			; 2 usec
000EB6  2  EA           	nop			; 2 usec
000EB7  2               				; tot: 20000 usec
000EB7  2  C6 rr        	dec xtmp
000EB9  2  D0 EC        	bne del_loop
000EBB  2  60           	rts
000EBC  2               
000EBC  2               ;-------------------------------------------------------------
000EBC  2               ; Screen synchronisation.
000EBC  2               ;
000EBC  2               ;  - read joystick/keyboard
000EBC  2               ;  - handle sound
000EBC  2               ;  - sync framerate with clock
000EBC  2               ;  - handle shrapnel every even frame
000EBC  2               ;-------------------------------------------------------------
000EBC  2               
000EBC  2               vsync:
000EBC  2  48           	pha
000EBD  2  98           	tya
000EBE  2  48           	pha
000EBF  2  8A           	txa
000EC0  2  48           	pha
000EC1  2  20 B3 1A     	jsr joykey		; read joystick/keyboard.
000EC4  2               vsync1:
000EC4  2               ;	lda Timer2_High		; sync framerate with clock
000EC4  2               ;	bne vsync1
000EC4  2               ;	lda #>50000
000EC4  2               ;	sta Timer2_High
000EC4  2               ;	lda #<50000
000EC4  2               ;	sta Timer2_Low
000EC4  2               
000EC4  2  A9 13        	lda #19
000EC6  2  20 F4 FF     	jsr OSBYTE		; _BEEB vsync
000EC9  2               
000EC9  2  A5 rr        	lda clock
000ECB  2  29 01        	and #1
000ECD  2  D0 03        	bne:+
000ECF  2  20 62 11     	jsr proshr		; handle shrapnel every even frame
000ED2  2               :
000ED2  2  AD DD 0E     	lda sndtyp
000ED5  2  F0 00        	beq sndskip
000ED7  2               ; _BEEB TODO SOUND
000ED7  2               ;sndloop:
000ED7  2               ;	lda SpeakerBit		; handle sound
000ED7  2               ;	ldy sndtyp
000ED7  2               ;sndwait:
000ED7  2               ;	dey
000ED7  2               ;	bne sndwait
000ED7  2               ;	eor #4
000ED7  2               ;	sta SpeakerBit
000ED7  2               ;	dec sndtyp
000ED7  2               ;	bne sndloop
000ED7  2               sndskip:
000ED7  2  68           	pla
000ED8  2  AA           	tax
000ED9  2  68           	pla
000EDA  2  A8           	tay
000EDB  2  68           	pla
000EDC  2  60           	rts
000EDD  2               
000EDD  2  00           sndtyp:	.byte 0
000EDE  2               
000EDE  2               ;----------------------------------------------------------------------
000EDE  2               ; BBC video hardware fns
000EDE  2               ;----------------------------------------------------------------------
000EDE  2               
000EDE  2               screeninit:
000EDE  2  A2 0D        	ldx #13
000EE0  2               crtcloop:
000EE0  2  8E 00 FE     	stx $FE00
000EE3  2  BD 00 0F     	lda crtc_regs_high,x
000EE6  2  8D 01 FE     	sta $FE01
000EE9  2  CA           	dex
000EEA  2  10 F4        	bpl crtcloop
000EEC  2               
000EEC  2                   ; Set ULA
000EEC  2  A9 88            lda #$88            ; MODE 4
000EEE  2  8D 48 02         sta $248            ; Tell the OS or it will mess with ULA settings at vsync
000EF1  2  8D 20 FE         sta $FE20
000EF4  2               
000EF4  2               ; fall through to palette
000EF4  2               
000EF4  2               setpal:
000EF4  2  A2 0F        	ldx #15
000EF6  2               palloop:
000EF6  2  BD 0E 0F     	lda ula_pal,x
000EF9  2  8D 21 FE     	sta $fe21
000EFC  2  CA           	dex
000EFD  2  10 F7        	bpl palloop
000EFF  2  60           	rts
000F00  2               
000F00  2               crtc_regs_high:
000F00  2  3F           	.byte 63				; R0  horizontal total
000F01  2  20           	.byte 32				; R1  horizontal displayed
000F02  2  31           	.byte 49				; R2  horizontal position
000F03  2  24           	.byte $24				; R3  sync width 40 = &28
000F04  2  26           	.byte 38				; R4  vertical total
000F05  2  00           	.byte 0					; R5  vertical total adjust
000F06  2  18           	.byte 24				; R6  vertical displayed
000F07  2  23           	.byte 35				; R7  vertical position; 35=top of screen
000F08  2  00           	.byte $00				; R8  interlace
000F09  2  07           	.byte 7					; R9  scanlines per row
000F0A  2  20           	.byte 32				; R10 cursor start
000F0B  2  08           	.byte 8					; R11 cursor end
000F0C  2  0D           	.byte >(ScreenAddr/8)	; R12 screen start address, high
000F0D  2  00           	.byte <(ScreenAddr/8)	; R13 screen start address, low
000F0E  2               
000F0E  2               ula_pal:
000F0E  2  07           	.byte $00 + PAL_black
000F0F  2  17           	.byte $10 + PAL_black
000F10  2  27           	.byte $20 + PAL_black
000F11  2  37           	.byte $30 + PAL_black
000F12  2  47           	.byte $40 + PAL_black
000F13  2  57           	.byte $50 + PAL_black
000F14  2  67           	.byte $60 + PAL_black
000F15  2  77           	.byte $70 + PAL_black
000F16  2  80           	.byte $80 + PAL_white
000F17  2  90           	.byte $90 + PAL_white
000F18  2  A0           	.byte $a0 + PAL_white
000F19  2  B0           	.byte $b0 + PAL_white
000F1A  2  C0           	.byte $c0 + PAL_white
000F1B  2  D0           	.byte $d0 + PAL_white
000F1C  2  E0           	.byte $e0 + PAL_white
000F1D  2  F0           	.byte $f0 + PAL_white
000F1E  2               
000F1E  2               ;----------------------------------------------------
000F1E  2               ; Draw sprite
000F1E  2               ;----------------------------------------------------
000F1E  2               
000F1E  2               sprite:
000F1E  2  86 rr        	stx xtmp		; Save X-reg
000F20  2  20 7B 0F     	jsr scadd 		; get screen address in scraddr.
000F23  2               
000F23  2  A5 rr        	lda dispx 		; x position.
000F25  2  29 07        	and #7 			; position straddling cells.
000F27  2  85 rr        	sta z80_b		; store in b register.
000F29  2               
000F29  2  A5 rr        	lda z80_l		; store sprite graphic address.
000F2B  2  8D 3E 0F     	sta sprit1+1
000F2E  2  8D 45 0F     	sta sprit2+1
000F31  2  A5 rr        	lda z80_h
000F33  2  8D 3F 0F     	sta sprit1+2
000F36  2  8D 46 0F     	sta sprit2+2
000F39  2               
000F39  2  A2 00        	ldx #0			; pixel height.
000F3B  2  A0 00        	ldy #0
000F3D  2               sprit1:
000F3D  2  BD 7F 70     	lda objdta,x		; fetch first byte.
000F40  2  8D 78 0F     	sta spr
000F43  2  E8           	inx
000F44  2               sprit2:
000F44  2  BD 7F 70     	lda objdta,x
000F47  2  8D 79 0F     	sta spr+1
000F4A  2               
000F4A  2  A9 00        	lda #0
000F4C  2  8D 7A 0F     	sta spr+2
000F4F  2  20 28 17     	jsr sprit7		; shift sprite
000F52  2               
000F52  2  AD 78 0F     	lda spr			; fetch graphic.
000F55  2  A0 00        	ldy #0			; _BEEB
000F57  2  51 rr        	eor (scraddr),y		; merge with screen image.
000F59  2  91 rr        	sta (scraddr),y		; write to screen.
000F5B  2               
000F5B  2  AD 79 0F     	lda spr+1		; fetch graphic.
000F5E  2  A0 08        	ldy #8			; _BEEB
000F60  2  51 rr        	eor (scraddr),y		; merge with screen image.
000F62  2  91 rr        	sta (scraddr),y		; write to screen.
000F64  2               
000F64  2  AD 7A 0F     	lda spr+2		; fetch graphic.
000F67  2  A0 10        	ldy #16			; _BEEB
000F69  2  51 rr        	eor (scraddr),y		; merge with screen image.
000F6B  2  91 rr        	sta (scraddr),y		; write to screen.
000F6D  2               
000F6D  2  20 13 10     	jsr nline
000F70  2               
000F70  2  E8           	inx			; next source byte.
000F71  2  E0 20        	cpx #32
000F73  2  D0 C8        	bne sprit1		; repeat
000F75  2               
000F75  2  A6 rr        	ldx xtmp		; retreive X-reg
000F77  2  60           	rts
000F78  2               
000F78  2  00 00 00     spr:	.byte 0,0,0
000F7B  2               
000F7B  2               ;------------------------------------------------------------------
000F7B  2               ; This routine returns a screen address for (dispx, dispy) in scraddr.
000F7B  2               ;------------------------------------------------------------------
000F7B  2               
000F7B  2               scadd:
000F7B  2  A6 rr        	ldx dispy
000F7D  2  A5 rr        	lda dispx
000F7F  2  29 F8        	and #$f8
000F81  2  18           	clc
000F82  2  7D 00 06     	adc SCADTB_lb,x
000F85  2  85 rr        	sta scraddr
000F87  2  BD 00 07     	lda SCADTB_hb,x
000F8A  2  69 00        	adc #0
000F8C  2  85 rr        	sta scraddr+1
000F8E  2  60           	rts
000F8F  2               
000F8F  2               ;-----------------------------------------------------------------
000F8F  2               ; These are the sprite routines.
000F8F  2               ; sspria = single sprite, old (ix).
000F8F  2               ; ssprib = single sprite, new (ix+5).
000F8F  2               ; sspric = both sprites, old (ix) and new (ix+5).
000F8F  2               ;-----------------------------------------------------------------
000F8F  2               
000F8F  2               sspria:
000F8F  2  20 01 1E     	jsr gsprad		; get old sprite address.
000F92  2               sspri2:
000F92  2  A9 10        	lda #16			; vertical lines.
000F94  2  8D A0 0F     	sta acnt
000F97  2               sspri0:
000F97  2  20 CA 0F     	jsr dline		; draw a line.
000F9A  2  CE A0 0F     	dec acnt
000F9D  2  D0 F8        	bne sspri0		; repeat 16 times
000F9F  2  60           	rts
000FA0  2               
000FA0  2  00           acnt:	.byte 0
000FA1  2               
000FA1  2               ;-----------------------------------------------------------------
000FA1  2               
000FA1  2               ssprib:
000FA1  2  20 E2 1D     	jsr gspran 		; get new sprite address.
000FA4  2  4C 92 0F     	jmp sspri2
000FA7  2               
000FA7  2               ;-----------------------------------------------------------------
000FA7  2               
000FA7  2               sspric:
000FA7  2  20 01 1E     	jsr gsprad 		; get old sprite address.
000FAA  2  20 2B 0E     	jsr exx  		; store addresses.
000FAD  2  20 E2 1D     	jsr gspran 		; get new sprite addresses.
000FB0  2               
000FB0  2  A9 0F        	lda #15
000FB2  2  85 rr        	sta ccnt
000FB4  2               lloop:
000FB4  2  20 CA 0F     	jsr dline 		; draw a line.
000FB7  2  20 2B 0E     	jsr exx  		; restore old addresses.
000FBA  2  20 CA 0F     	jsr dline 		; delete a line.
000FBD  2  20 2B 0E     	jsr exx  		; flip to new sprite addresses.
000FC0  2  C6 rr        	dec ccnt
000FC2  2  D0 F0        	bne lloop
000FC4  2               
000FC4  2  20 CA 0F     	jsr dline		; draw a line.
000FC7  2  20 2B 0E     	jsr exx 		; restore old addresses.
000FCA  2               
000FCA  2               ;-------------------------------------------------------------
000FCA  2               ; Drop through.
000FCA  2               ; Line drawn, now work out next target address.
000FCA  2               ;
000FCA  2               ; Input:
000FCA  2               ;  B  = right mask
000FCA  2               ;  C  = left mask
000FCA  2               ;  DE = spriteaddress
000FCA  2               ;  scraddr = screen address
000FCA  2               ;-------------------------------------------------------------
000FCA  2               
000FCA  2               dline:
000FCA  2  A0 00        	ldy #0
000FCC  2  B1 rr        	lda (z80_de),y 		; graphic data.
000FCE  2  25 rr        	and z80_c 		; mask away what's not needed.
000FD0  2  51 rr        	eor (scraddr),y 	; XOR with what's there.
000FD2  2  91 rr        	sta (scraddr),y 	; bung it in.
000FD4  2               
000FD4  2               ; _BEEB screen arrangement
000FD4  2  18           	clc
000FD5  2  A5 rr        	lda scraddr
000FD7  2  69 10        	adc #16
000FD9  2  85 rr        	sta scraddr
000FDB  2  90 02        	bcc :+
000FDD  2  E6 rr        	inc scraddr+1
000FDF  2               :
000FDF  2               
000FDF  2  B1 rr        	lda (z80_de),y 		; fetch data.
000FE1  2  25 rr        	and z80_b 		; mask away unwanted bits.
000FE3  2  51 rr        	eor (scraddr),y 	; XOR with what's there.
000FE5  2  91 rr        	sta (scraddr),y 	; bung it in.
000FE7  2               
000FE7  2  E6 rr        	inc z80_e 		; next graphic.
000FE9  2  D0 02        	bne :+
000FEB  2  E6 rr        	inc z80_d
000FED  2               :
000FED  2               ; _BEEB screen arrangement
000FED  2  38           	sec
000FEE  2  A5 rr        	lda scraddr 		; one character cell to the left.
000FF0  2  E9 08        	sbc #8
000FF2  2  85 rr        	sta scraddr
000FF4  2  A5 rr        	lda scraddr+1
000FF6  2  E9 00        	sbc #0
000FF8  2  85 rr        	sta scraddr+1
000FFA  2               
000FFA  2  B1 rr        	lda (z80_de),y 		; second bit of data.
000FFC  2  51 rr        	eor (scraddr),y 	; XOR with what's there.
000FFE  2  91 rr        	sta (scraddr),y 	; bung it in.
001000  2               
001000  2  E6 rr        	inc z80_e 		; point to next line of data.
001002  2  D0 02        	bne :+
001004  2  E6 rr        	inc z80_d
001006  2               :
001006  2               ; _BEEB screen arrangement
001006  2  38           	sec
001007  2  A5 rr        	lda scraddr 		; another char left.
001009  2  E9 08        	sbc #8
00100B  2  85 rr        	sta scraddr
00100D  2  A5 rr        	lda scraddr+1
00100F  2  E9 00        	sbc #0
001011  2  85 rr        	sta scraddr+1
001013  2               
001013  2               ;----------------------------------------------------------------------
001013  2               ; Line drawn, now work out next target address.
001013  2               ;----------------------------------------------------------------------
001013  2               
001013  2               ; _BEEB screen arrangement
001013  2               
001013  2               nline:
001013  2  A5 rr        	lda scraddr 		; get low byte of address.
001015  2  29 07        	and #7
001017  2  C9 07        	cmp #7				; is this last line of row?
001019  2  F0 03        	beq beeb_next_row
00101B  2               
00101B  2               	; within same row
00101B  2  E6 rr        	inc scraddr			; new low byte of address.
00101D  2               ;	bne :+
00101D  2               ;	inc scraddr+1		; new high byte of address.
00101D  2               :
00101D  2  60           	rts
00101E  2               
00101E  2               beeb_next_row:
00101E  2  18           	clc
00101F  2  A5 rr        	lda scraddr
001021  2  69 F9        	adc #<(ScreenRowBytes-7)
001023  2  85 rr        	sta scraddr			; new low byte of address.
001025  2  A5 rr        	lda scraddr+1
001027  2  69 00        	adc #>(ScreenRowBytes-7)
001029  2  85 rr        	sta scraddr+1		; new high byte of address.
00102B  2  60           	rts
00102C  2               
00102C  2               ;----------------------------------------------------
00102C  2               ; Display character in A at dispx,dispy.
00102C  2               ;
00102C  2               ; Input:
00102C  2               ;  A 	   = character to print
00102C  2               ;----------------------------------------------------
00102C  2               
00102C  2               pchar:
00102C  2  85 rr        	sta fntaddr
00102E  2  A9 00        	lda #0
001030  2  85 rr        	sta fntaddr+1
001032  2  06 rr        	asl fntaddr  		; multiply char by 8.
001034  2  26 rr        	rol fntaddr+1
001036  2  06 rr        	asl fntaddr
001038  2  26 rr        	rol fntaddr+1
00103A  2  06 rr        	asl fntaddr
00103C  2  26 rr        	rol fntaddr+1
00103E  2               
00103E  2  A5 rr        	lda fntaddr
001040  2  18           	clc
001041  2  65 rr        	adc FontPtr
001043  2  85 rr        	sta fntaddr		; that's the low byte.
001045  2  A5 rr        	lda fntaddr+1
001047  2  65 rr        	adc FontPtr+1
001049  2  85 rr        	sta fntaddr+1		; add displacement.
00104B  2               pchark:
00104B  2  20 6E 16     	jsr gprad		; get screen address.
00104E  2  A2 07        	ldx #7			; lines to write.
001050  2               pchar0:
001050  2  A0 00        	ldy #0
001052  2  B1 rr        	lda (fntaddr),y 	; get image byte.
001054  2  BC 65 10     	ldy scrtab,x		; Get rowoffset
001057  2               
001057  2  49 00        	eor #TxtInvert		; Invert
001059  2               
001059  2  91 rr        	sta (scraddr),y 	; copy to screen.
00105B  2  E6 rr        	inc fntaddr		; next image byte.
00105D  2  D0 02        	bne :+
00105F  2  E6 rr        	inc fntaddr+1
001061  2               :
001061  2  CA           	dex			; next screen row down.
001062  2  10 EC        	bpl pchar0		; repeat.
001064  2  60           	rts
001065  2               
001065  2  07 06 05 04  scrtab:		.byte $07,$06,$05,$04,$03,$02,$01,$00
001069  2  03 02 01 00  
00106D  2               ;scrtab:	.byte $e0,$c0,$a0,$80,$60,$40,$20,$00
00106D  2               
00106D  1               
00106D  1               ;----------------------------------------------------------------------
00106D  1               ; AGD 6502 ENGINE CODE + COMPILED GAME SCRIPT
00106D  1               ;----------------------------------------------------------------------
00106D  1               
00106D  1               start_game:
00106D  1               
00106D  1               	.include "game.inc"
00106D  2               .include "terrapins.inc"
00106D  3               ; Game engine code --------------------------------------------------------------
00106D  3               
00106D  3               ; Arcade Game Designer.
00106D  3               ; (C) 2008 Jonathan Cauldwell.
00106D  3               ; ZX Spectrum Next Engine v0.1.
00106D  3               
00106D  3               ; Global definitions ------------------------------------------------------------
00106D  3               
00106D  3               	FONT = font			; Font address
00106D  3               
00106D  3               ; Block characteristics.
00106D  3               
00106D  3               	PLATFM = 1			; platform.
00106D  3               	WALL = PLATFM + 1	; solid wall.
00106D  3               	LADDER = WALL + 1	; ladder.
00106D  3               	FODDER = LADDER + 1	; fodder block.
00106D  3               	DEADLY = FODDER + 1	; deadly block.
00106D  3               	CUSTOM = DEADLY + 1	; custom block.
00106D  3               	WATER  = CUSTOM + 1	; water block.
00106D  3                   COLECT = WATER + 1      ; collectable block.
00106D  3                   NUMTYP = COLECT + 1     ; number of types.
00106D  3               
00106D  3               ; Sprites.
00106D  3               
00106D  3               	NUMSPR = 12			; number of sprites.
00106D  3               	TABSIZ = 17			; size of each entry.
00106D  3               	SPRBUF = NUMSPR * TABSIZ; size of entire table.
00106D  3               	NMESIZ = 4			; bytes stored in nmetab for each sprite.
00106D  3               
00106D  3               ; Sprite table variable offsets.
00106D  3               
00106D  3               	var_Type = 0		; sprite type
00106D  3               	var_Image = 1		; sprite time number
00106D  3               	var_Frame = 2		; sprite frame
00106D  3               	var_Y = 3			; sprite y coordinate
00106D  3               	var_X = 4			; sprite X coordinate
00106D  3               
00106D  3               	var_newType = 5		; sprite new type
00106D  3               	var_newImage = 6	; sprite new image number
00106D  3               	var_newFrame = 7	; sprite new frame
00106D  3               	var_newY = 8		; sprite new y coordinate
00106D  3               	var_newX = 9		; sprite new x coordinate
00106D  3               
00106D  3               	var_Direction = 10	; sprite direction
00106D  3               	var_Param1 = 11		; sprite parameter 1
00106D  3               	var_Param2 = 12		; sprite parameter 2
00106D  3               
00106D  3               	var_jumpLo = 13		; sprite jump ptr low
00106D  3               	var_jumpHi = 14		; sprite jump ptr high
00106D  3               	var_dataLo = 15		; sprite data ptr low
00106D  3               	var_dataHi = 16		; sprite data ptr high
00106D  3               
00106D  3               ; Particle engine.
00106D  3               
00106D  3               	NUMSHR = 55			; pieces of shrapnel.
00106D  3               	SHRSIZ = 6			; bytes per particle.
00106D  3               
00106D  3               ; Conditional compilation flags
00106D  3               ; Flags are set in commandline assembly
00106D  3               
00106D  3               ;	mflag = 0 		; MENU + INV
00106D  3               ;	pflag = 0		; Particle engine
00106D  3               ;	sflag = 0		; scrollytext
00106D  3               ;	fflag = 1		; Fontflag
00106D  3               
00106D  3               .if iflag
00106D  3               	TxtInvert   = $ff	; Invert byte for character printing
00106D  3               	ScrFillByte = $ff	; Screen fill byte for CLS
00106D  3               .else
00106D  3               	TxtInvert   = $00	; Invert byte for character printing
00106D  3               	ScrFillByte = $00	; Screen fill byte for CLS
00106D  3               .endif
00106D  3               
00106D  3               	ASCII_NEWLINE = 13
00106D  3               
00106D  3               ;===============================================================
00106D  3               ; Game starts here
00106D  3               ;===============================================================
00106D  3               
00106D  3               ;--------------------------------------------------------------
00106D  3               ; If a font is required...
00106D  3               ;--------------------------------------------------------------
00106D  3               
00106D  3  A9 D5        	lda #<(FONT-256)	; address of font.
00106F  3  85 rr        	sta FontPtr
001071  3  A9 70        	lda #>(FONT-256)
001073  3  85 rr        	sta FontPtr+1
001075  3               
001075  3  20 63 11     	jsr game	 		; start the game.
001078  3  60           	rts
001079  3               
001079  3               ; Don't change the order of these four.
001079  3               ; Menu routine relies on winlft following wintop.
001079  3               
001079  3  00           wintop:	.byte WINDOWTOP		; top of window.
00107A  3  00           winlft:	.byte WINDOWLFT		; left edge.
00107B  3  17           winhgt:	.byte WINDOWHGT		; window height.
00107C  3  1A           winwid:	.byte WINDOWWID		; window width.
00107D  3  09           numob:	.byte NUMOBJ		; number of objects in game.
00107E  3               
00107E  3               ; Pixel versions of wintop, winlft, winhgt, winwid.
00107E  3               
00107E  3  00           wntopx:	.byte (8 * WINDOWTOP)
00107F  3  00           wnlftx:	.byte (8 * WINDOWLFT)
001080  3  A8           wnbotx:	.byte ((WINDOWTOP * 8) + (WINDOWHGT * 8) - 16)
001081  3  BE           wnrgtx:	.byte ((WINDOWLFT * 8) + (WINDOWWID * 8) - 16)-2
001082  3               
001082  3               ; Make sure pointers are arranged in the same order as the data itself.
001082  3               
001082  3  78 6B        frmptr:	.word frmlst         ; sprite frames.
001084  3               
001084  3               ; Assorted game routines which can go in contended memory.
001084  3               
001084  3               ;--------------------------------------------------------------
001084  3               ; Modify for inventory.
001084  3               ; called by the INV command
001084  3               ;
001084  3               ; Input:
001084  3               ;  X   = message nr with objects seperated with ,
001084  3               ;
001084  3               ; Output:
001084  3               ;  OPT = selected line nr of INV menu
001084  3               ;--------------------------------------------------------------
001084  3               
001084  3               .if mflag
001084  3               minve:
001084  3               	lda #<(invdis)		; routine address.
001084  3               	sta mod0+1		; set up menu routine.
001084  3               	sta mod2+1		; set up count routine.
001084  3               	lda #>(invdis)
001084  3               	sta mod0+2
001084  3               	sta mod2+2
001084  3               	lda #<(fopt)		; find option from available objects.
001084  3               	sta mod1+1		; set up routine.
001084  3               	lda #>(fopt)
001084  3               	sta mod1+1+1
001084  3               	jmp dbox		; do menu routine.
001084  3               
001084  3               ;--------------------------------------------------------------
001084  3               ; Modify for menu.
001084  3               ; called by the MENU command
001084  3               ;
001084  3               ; Input:
001084  3               ;  X   = message nr with menu items seperated with ,
001084  3               ;
001084  3               ; Output:
001084  3               ;  OPT = selected line nr of MENU menu
001084  3               ;--------------------------------------------------------------
001084  3               
001084  3               mmenu:
001084  3               	lda #<(always)		; routine address.
001084  3               	sta mod0+1		; set up routine.
001084  3               	sta mod2+1		; set up count routine.
001084  3               	lda #>(always)
001084  3               	sta mod0+2
001084  3               	sta mod2+2
001084  3               
001084  3               	lda #<(fstd)		; standard option selection.
001084  3               	sta mod1+1		; set up routine.
001084  3               	lda #>(fstd)
001084  3               	sta mod1+2
001084  3               
001084  3               ; Drop through into box routine.
001084  3               
001084  3               ;--------------------------------------------------------------
001084  3               ; Work out size of box for message or menu.
001084  3               ;--------------------------------------------------------------
001084  3               
001084  3               dbox:
001084  3               	lda #<(msgdat)		; pointer to messages.
001084  3               	sta z80_l
001084  3               	lda #>(msgdat)
001084  3               	sta z80_h
001084  3               
001084  3               	jsr getwrd		; get message number.
001084  3               
001084  3               	lda z80_h		; store pointer to message.
001084  3               	sta TmpAddr
001084  3               	lda z80_l
001084  3               	sta TmpAddr+1
001084  3               
001084  3               	lda #1			; height.
001084  3               	sta z80_d
001084  3               	lda #0			; start at object zero.
001084  3               	sta combyt		; store number of object in combyt.
001084  3               	sta z80_e		; maximum width.
001084  3               dbox5:
001084  3               	lda #0			; this line"s width.
001084  3               	sta z80_b
001084  3               mod2:
001084  3               	jsr always		; item in player"s possession?
001084  3               	cmp #255
001084  3               	bne dbox6		; not in inventory, skip this line.
001084  3               	inc z80_d		; add to tally.
001084  3               dbox6:
001084  3               	ldy #0			; get character.
001084  3               	lda (z80_hl),y
001084  3               	sta z80_a
001084  3               	inc z80_l		; next character.
001084  3               	bne :+
001084  3               	inc z80_h
001084  3               :
001084  3               	lda z80_a		; reached end of line?
001084  3               	cmp #','
001084  3               	beq dbox3		; yes.
001084  3               	cmp #ASCII_NEWLINE
001084  3               	beq dbox3		; yes.
001084  3               	inc z80_b		; add to this line"s width.
001084  3               	lda z80_a
001084  3               	bmi dbox4		; end of message? yes, end count.
001084  3               	jmp dbox6		; repeat until we find the end.
001084  3               dbox3:
001084  3               	lda z80_e		; maximum line width.
001084  3               	cmp z80_b		; have we exceeded longest so far?
001084  3               	bpl dbox5		; no, carry on looking.
001084  3               	lda z80_b		; make this the widest so far.
001084  3               	sta z80_e
001084  3               	jmp dbox5		; keep looking.
001084  3               dbox4:
001084  3               	lda z80_e		; maximum line width.
001084  3               	cmp z80_b		; have we exceeded longest so far?
001084  3               	bpl dbox8		; no, carry on looking.
001084  3               	lda z80_b		; final line is the longest so far.
001084  3               	sta z80_e
001084  3               dbox8:
001084  3               	dec z80_d		; decrement items found.
001084  3               	bne :+			; total was zero.
001084  3               	jmp dbox15
001084  3               :
001084  3               	lda z80_e		; longest line.
001084  3               	bne :+			; was it zero?
001084  3               	jmp dbox15		; total was zero.
001084  3               :
001084  3               	sta bwid		; set up size.
001084  3               	lda z80_d
001084  3               	sta blen
001084  3               
001084  3               ;--------------------------------------------------------------
001084  3               ; That's set up our box size.
001084  3               ;--------------------------------------------------------------
001084  3               
001084  3               	lda winhgt		; window height in characters.
001084  3               	sec
001084  3               	sbc z80_d		; subtract height of box.
001084  3               	lsr a			; divide by 2.
001084  3               	clc
001084  3               	adc wintop		; add top edge of window.
001084  3               	sta btop		; set up box top.
001084  3               
001084  3               	lda winwid		; window width in characters.
001084  3               	sec
001084  3               	sbc z80_e		; subtract box width.
001084  3               	lsr a			; divide by 2.
001084  3               	clc
001084  3               	adc winlft		; add left edge of window.
001084  3               	sta blft		; box left.
001084  3               
001084  3               	lda FontPtr		; font.
001084  3               	sta grbase		; set up for text display.
001084  3               	lda FontPtr+1
001084  3               	sta grbase+1
001084  3               
001084  3               	lda TmpAddr+1		; restore message pointer.
001084  3               	sta z80_l
001084  3               	lda TmpAddr
001084  3               	sta z80_h
001084  3               
001084  3               	lda btop		; box top.
001084  3               	sta dispy		; set display coordinate.
001084  3               	lda #0			; start at object zero.
001084  3               	sta combyt		; store number of object in combyt.
001084  3               dbox2:
001084  3               	lda combyt		; get object number.
001084  3               	sta z80_a
001084  3               mod0:
001084  3               	jsr always		; check inventory for display.
001084  3               	cmp #255
001084  3               	beq :+
001084  3               	jmp dbox13		; not in inventory, skip this line.
001084  3               :
001084  3               	lda blft		; box left.
001084  3               	sta dispx		; set left display position.
001084  3               	lda bwid		; box width.
001084  3               	sta z80_b		; store width.
001084  3               dbox0:
001084  3               	ldy #0			; get character.
001084  3               	lda (z80_hl),y
001084  3               	cmp #','		; end of line?
001084  3               	beq dbox1		; yes, next one.
001084  3               	cmp #ASCII_NEWLINE			; end of line?
001084  3               	beq dbox1		; yes, next one.
001084  3               
001084  3               	dec z80_b		; one less to display.
001084  3               	and #127		; remove terminator.
001084  3               
001084  3               	jsr pchr		; display on screen.
001084  3               
001084  3               	ldy #0
001084  3               	lda (z80_hl),y		; get character.
001084  3               	sta z80_a
001084  3               	inc z80_l		; next character.
001084  3               	bne :+
001084  3               	inc z80_h
001084  3               :
001084  3               	lda z80_a
001084  3               	cmp #128		; end of message?
001084  3               	bmi :+
001084  3               	jmp dbox7		; yes, job done.
001084  3               :
001084  3               	lda z80_b		; chars remaining.
001084  3               	beq :+			; are any left?
001084  3               	jmp dbox0		; yes, continue.
001084  3               :
001084  3               ;---------------------------------------------------
001084  3               ; Reached limit of characters per line.
001084  3               ;---------------------------------------------------
001084  3               
001084  3               dbox9:
001084  3               	ldy #0
001084  3               	lda (z80_hl),y		; get character.
001084  3               	inc z80_l		; next one.
001084  3               	bne :+
001084  3               	inc z80_h
001084  3               :
001084  3               	cmp #','		; another line?
001084  3               	beq dbox10		; yes, do next line.
001084  3               	cmp #ASCII_NEWLINE			; another line?
001084  3               	beq dbox10		; yes, do next line.
001084  3               	cmp #128		; end of message?
001084  3               	bcs :+
001084  3               	jmp dbox11		; yes, finish message.
001084  3               :
001084  3               	jmp dbox9
001084  3               
001084  3               ;---------------------------------------------------
001084  3               ; Fill box to end of line.
001084  3               ;---------------------------------------------------
001084  3               
001084  3               dboxf:
001084  3               	lda #32			; space character.
001084  3               	jsr pchr		; display character.
001084  3               	dec z80_b
001084  3               	beq :+
001084  3               	jmp dboxf		; repeat for remaining chars on line.
001084  3               :
001084  3               	rts
001084  3               dbox1:
001084  3               	inc z80_l		; skip character.
001084  3               	bne :+
001084  3               	inc z80_h
001084  3               :
001084  3               	jsr dboxf		; fill box out to right side.
001084  3               dbox10:
001084  3               	inc dispy		; y coordinate down a line next position.
001084  3               	jmp dbox2		; next line.
001084  3               dbox7:
001084  3               	lda z80_b		; chars remaining.
001084  3               	bne :+			; are any left?
001084  3               	jmp dbox11		; no, nothing to draw.
001084  3               :
001084  3               	jsr dboxf		; fill message to line.
001084  3               
001084  3               ;------------------------------------------------------
001084  3               ; Drawn the box menu, now select option.
001084  3               ;------------------------------------------------------
001084  3               
001084  3               dbox11:
001084  3               	lda btop		; box top.
001084  3               	sta dispy		; set bar position.
001084  3               dbox14:
001084  3               	jsr joykey		; get controls.
001084  3               	cmp #$7f		; anything pressed?
001084  3               	bne dbox14		; yes, debounce it.
001084  3               	jsr dbar		; draw bar.
001084  3               dbox12:
001084  3               	jsr joykey		; get controls.
001084  3               	cmp #$7f		; anything pressed?
001084  3               	beq dbox12		; no, nothing.
001084  3               	and #16			; fire button pressed?
001084  3               	bne :+
001084  3               mod1:
001084  3               	jmp fstd		; yes, job done.
001084  3               :
001084  3               	jsr dbar		; delete bar.
001084  3               
001084  3               	lda joyval		; joystick reading.
001084  3               	and #8			; going up?
001084  3               	beq dboxu		; yes, go up.
001084  3               
001084  3               	ldx dispy		; vertical position of bar.
001084  3               	inx			; look down.
001084  3               	txa
001084  3               	sec
001084  3               	sbc btop		; find distance from top.
001084  3               	cmp blen		; top of box.
001084  3               	bne :+
001084  3               	jmp dbox14		; yes, go no further.
001084  3               :
001084  3               	inc dispy		; move bar.
001084  3               	jmp dbox14		; continue.
001084  3               dboxu:
001084  3               	lda dispy		; vertical position of bar.
001084  3               	cmp btop		; are we at the top?
001084  3               	bne :+
001084  3               	jmp dbox14		; yes, go no further.
001084  3               :
001084  3               	dec dispy		; move bar.
001084  3               	jmp dbox14		; continue.
001084  3               fstd:
001084  3               	lda dispy		; bar position.
001084  3               	sec
001084  3               	sbc btop		; find selected option.
001084  3               	sta varopt		; store the option.
001084  3               	jmp redraw		; redraw the screen.
001084  3               
001084  3               ;------------------------------------------------------
001084  3               ; Option not available.  Skip this line.
001084  3               ;------------------------------------------------------
001084  3               
001084  3               dbox13:
001084  3               	ldy #0
001084  3               	lda (z80_hl),y		; get character.
001084  3               	inc z80_l		; next one.
001084  3               	bne :+
001084  3               	inc z80_h
001084  3               :
001084  3               	cmp #','		; another line?
001084  3               	bne :+
001084  3               	jmp dbox2		; yes, do next line.
001084  3               :
001084  3               	cmp #ASCII_NEWLINE			; another line?
001084  3               	bne :+
001084  3               	jmp dbox2		; yes, do next line.
001084  3               :
001084  3               
001084  3               	bpl :+			; end of message?
001084  3               	jmp dbox11		; yes, finish message.
001084  3               :
001084  3               	jmp dbox13
001084  3               dbox15:
001084  3               	lda TmpAddr		; pop message pointer from the stack.
001084  3               	sta z80_h
001084  3               	lda TmpAddr+1
001084  3               	sta z80_l
001084  3               	rts
001084  3               
001084  3               ;------------------------------------------------------
001084  3               ; Invert bar
001084  3               ;------------------------------------------------------
001084  3               
001084  3               dbar:
001084  3               	lda blft		; box left.
001084  3               	sta dispx		; set display coordinate.
001084  3               	jsr gprad		; get printing address.
001084  3               
001084  3               	lda bwid		; box width.
001084  3               	sta z80_c		; loop counter in c.
001084  3               	lda z80_h
001084  3               	sta z80_d		; store screen address high byte.
001084  3               dbar1:
001084  3               	ldx #7			; pixel height in b.
001084  3               dbar0:
001084  3               	ldy scrtab,x
001084  3               	lda (scraddr),y		; get screen byte.
001084  3               	eor #255		; reverse all bits.
001084  3               	sta (scraddr),y		; write back to screen.
001084  3               	dex			; next line down.
001084  3               	bpl dbar0		; draw rest of character.
001084  3               
001084  3               	clc
001084  3               	lda scraddr		; one char right.
001084  3               	adc #8
001084  3               	sta scraddr
001084  3               	bcc :+
001084  3               	inc scraddr+1
001084  3               :
001084  3               
001084  3               	dec z80_c		; decrement character counter.
001084  3               	beq :+
001084  3               	jmp dbar1		; repeat for whole line.
001084  3               :
001084  3               	rts
001084  3               
001084  3               ;------------------------------------------------------
001084  3               ; Point to object
001084  3               ;
001084  3               ; Input:
001084  3               ;  -
001084  3               ;
001084  3               ; Output:
001084  3               ;  A = object number, A=255 if already in possession
001084  3               ;------------------------------------------------------
001084  3               
001084  3               invdis:
001084  3               	lda z80_l		; store message text pointer.
001084  3               	pha
001084  3               	lda z80_h
001084  3               	pha
001084  3               	lda combyt		; object number.
001084  3               	inc combyt		; ready for next one.
001084  3               	jsr gotob		; check if we have object.
001084  3               	tay
001084  3               	pla
001084  3               	sta z80_h
001084  3               	pla
001084  3               	sta z80_l
001084  3               	tya
001084  3               	rts
001084  3               
001084  3               ;------------------------------------------------------
001084  3               ; Find option selected.
001084  3               ;
001084  3               ; Input:
001084  3               ;  -
001084  3               ;
001084  3               ; Output:
001084  3               ;  OPT = selected object
001084  3               ;------------------------------------------------------
001084  3               
001084  3               fopt:
001084  3               	lda dispy
001084  3               	sec
001084  3               	sbc btop		; find selected option.
001084  3               	sta tmp+2		; option selected in b register.
001084  3               	inc tmp+2
001084  3               
001084  3               	lda #0			; set to first item.
001084  3               	sta combyt		; object number.
001084  3               fopt0:
001084  3               	jsr fobj		; find next object in inventory.
001084  3               	dec tmp+2
001084  3               	bne fopt0		; repeat for relevant steps down the list.
001084  3               
001084  3               	lda combyt		; get option.
001084  3               	sta varopt		; store the option.
001084  3               	dec varopt		; one less, due to where we increment combyt.
001084  3               	jmp redraw		; redraw the screen.
001084  3               fobj:
001084  3               	ldy combyt		; object number.
001084  3               	inc combyt		; ready for next item.
001084  3               	tya
001084  3               	jsr gotob		; do we have this item?
001084  3               	cmp #255
001084  3               	bne :+
001084  3               	rts
001084  3               :
001084  3               	jmp fobj		; yes, it's on the list.
001084  3               .endif
001084  3               
001084  3               ;----------------------------------------------------
001084  3               ; Clear sprite table.
001084  3               ;
001084  3               ; sprtab[0] - sprtab[SPRBUF-1] = 255
001084  3               ;----------------------------------------------------
001084  3               
001084  3               xspr:
001084  3  A9 FF        	lda #255		; clear byte.
001086  3  A2 00        	ldx #0			; length of table.
001088  3               xspr0:
001088  3  9D 00 0B     	sta sprtab,x		; sprite table.
00108B  3  E8           	inx			; move to next byte.
00108C  3  E0 CC        	cpx #SPRBUF
00108E  3  D0 F8        	bne xspr0		; repeat for rest of table.
001090  3  60           	rts
001091  3               
001091  3               ;~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
001091  3               ; Sound, NOT IMPLEMENTED!!!
001091  3               ;~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
001091  3               ;
001091  3               ;silenc:
001091  3               ;	jsr silen1 		; silence channel 1.
001091  3               ;	jsr silen2 		; silence channel 2.
001091  3               ;	jsr silen3 		; silence channel 3.
001091  3               ;	jmp plsnd 		; play all channels to switch them off.
001091  3               ;~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
001091  3               
001091  3               ;-------------------------------------------------------------
001091  3               ; Initialise all objects.
001091  3               ;
001091  3               ; Reset current room,y,x to start room,y,x for all objects
001091  3               ;-------------------------------------------------------------
001091  3               
001091  3               iniob:
001091  3  A9 7F        	lda #<objdta 		; objects table.
001093  3  85 rr        	sta z80_x
001095  3  A9 70        	lda #>objdta
001097  3  85 rr        	sta z80_i
001099  3               
001099  3  AE 7D 10     	ldx numob 		; number of objects in the game.
00109C  3               iniob0:
00109C  3  A0 23        	ldy #35
00109E  3  B1 rr        	lda (z80_ix),y 		; start screen.
0010A0  3  A0 20        	ldy #32
0010A2  3  91 rr        	sta (z80_ix),y 		; set start screen.
0010A4  3               
0010A4  3  A0 24        	ldy #36
0010A6  3  B1 rr        	lda (z80_ix),y 		; find start y.
0010A8  3  A0 21        	ldy #33
0010AA  3  91 rr        	sta (z80_ix),y 		; set start y.
0010AC  3               
0010AC  3  A0 25        	ldy #37
0010AE  3  B1 rr        	lda (z80_ix),y 		; get initial x.
0010B0  3  A0 22        	ldy #34
0010B2  3  91 rr        	sta (z80_ix),y 		; set x coord.
0010B4  3               
0010B4  3  18           	clc 			; point to next object.
0010B5  3  A5 rr        	lda z80_x
0010B7  3  69 26        	adc #38			; distance between objects.
0010B9  3  85 rr        	sta z80_x
0010BB  3  90 02        	bcc :+
0010BD  3  E6 rr        	inc z80_i
0010BF  3               :
0010BF  3  CA           	dex 			; repeat.
0010C0  3  D0 DA        	bne iniob0
0010C2  3               
0010C2  3  60           	rts
0010C3  3               
0010C3  3               ;-----------------------------------------------
0010C3  3               ; Redraw the screen.
0010C3  3               ;
0010C3  3               ; Remove old copy of all sprites for redraw.
0010C3  3               ;-----------------------------------------------
0010C3  3               
0010C3  3               redraw:
0010C3  3  A5 rr        	lda z80_i 		; place sprite pointer on stack.
0010C5  3  48           	pha
0010C6  3  A5 rr        	lda z80_x
0010C8  3  48           	pha
0010C9  3               
0010C9  3  20 71 17     	jsr droom		; show screen layout.
0010CC  3  20 52 13     	jsr shwob		; draw objects.
0010CF  3               numsp0:
0010CF  3  A9 0C        	lda #NUMSPR		; sprites to draw.
0010D1  3  85 rr        	sta tmp
0010D3  3               
0010D3  3  A9 00        	lda #<sprtab		; sprite table.
0010D5  3  85 rr        	sta z80_x
0010D7  3  A9 0B        	lda #>sprtab
0010D9  3  85 rr        	sta z80_i
0010DB  3               redrw0:
0010DB  3  A0 00        	ldy #0
0010DD  3  B1 rr        	lda (z80_ix),y		; old sprite type.
0010DF  3  C9 FF        	cmp #255		; is it enabled?
0010E1  3  F0 0B        	beq redrw1 		; no, find next one.
0010E3  3               
0010E3  3  A0 03        	ldy #var_Y
0010E5  3  B1 rr        	lda (z80_ix),y 		; sprite y.
0010E7  3  C9 B1        	cmp #177		; beyond maximum?
0010E9  3  B0 03        	bcs redrw1		; yes, nothing to draw.
0010EB  3               
0010EB  3  20 8F 0F     	jsr sspria		; show single sprite.
0010EE  3               
0010EE  3               redrw1:
0010EE  3  18           	clc			; next sprite.
0010EF  3  A5 rr        	lda z80_x
0010F1  3  69 11        	adc #TABSIZ		; distance to next odd/even entry.
0010F3  3  85 rr        	sta z80_x
0010F5  3  90 02        	bcc :+
0010F7  3  E6 rr        	inc z80_i
0010F9  3               :
0010F9  3  C6 rr        	dec tmp			; repeat for remaining sprites.
0010FB  3  D0 DE        	bne redrw0
0010FD  3               
0010FD  3               rpblc1:
0010FD  3               ;	jsr dshrp		; redraw shrapnel.
0010FD  3               
0010FD  3  68           	pla			; retrieve sprite pointer.
0010FE  3  85 rr        	sta z80_x
001100  3  68           	pla
001101  3  85 rr        	sta z80_i
001103  3               
001103  3  60           	rts
001104  3               
001104  3               ;----------------------------------------------------------------------
001104  3               ; Clear screen routine.
001104  3               ;
001104  3               ; Fill screenmem $8000-$97ff with ScrFillByte
001104  3               ;----------------------------------------------------------------------
001104  3               
001104  3               cls:
001104  3  A9 68        	lda #>ScreenAddr		; screen address.
001106  3  8D 0F 11     	sta clsloop+2
001109  3  A9 00        	lda #ScrFillByte
00110B  3  A0 00        	ldy #0
00110D  3               clsloop:
00110D  3  99 00 68     	sta ScreenAddr,y
001110  3  C8           	iny
001111  3  D0 FA        	bne clsloop
001113  3  EE 0F 11     	inc clsloop+2
001116  3  AE 0F 11     	ldx clsloop+2
001119  3  E0 80        	cpx #>(ScreenAddr+ScreenSize)		; _BEEB
00111B  3  D0 F0        	bne clsloop
00111D  3  60           	rts
00111E  3               
00111E  3               ;----------------------------------------------------------------------
00111E  3               ; FODDER check
00111E  3               ;----------------------------------------------------------------------
00111E  3               
00111E  3               fdchk:
00111E  3  A0 00        	ldy #0
001120  3  B1 rr        	lda (z80_hl),y	 	; fetch cell.
001122  3  C9 04        	cmp #FODDER 		; is it fodder?
001124  3  F0 01        	beq :+
001126  3  60           	rts 			; no.
001127  3               :
001127  3  A9 00        	lda #0
001129  3  A0 00        	ldy #0
00112B  3  91 rr        	sta (z80_hl),y 		; rewrite block type.
00112D  3               
00112D  3  A5 rr        	lda z80_h		; store pointer to block.
00112F  3  48           	pha
001130  3  A5 rr        	lda z80_l
001132  3  48           	pha
001133  3               
001133  3  38           	sec			; set carry flag for subtraction.
001134  3  A5 rr        	lda z80_l 		; find simple displacement for block.
001136  3  E9 00        	sbc #<MAP
001138  3  85 rr        	sta z80_l
00113A  3  A5 rr        	lda z80_h
00113C  3  E9 03        	sbc #>MAP
00113E  3  85 rr        	sta z80_h
001140  3               
001140  3  A5 rr        	lda z80_l		; low byte is y coordinate.
001142  3  29 1F        	and #31 		; column position 0 - 31.
001144  3  85 rr        	sta dispx		; set up x position.
001146  3               
001146  3  06 rr        	asl z80_l		; multiply displacement by 8.
001148  3  26 rr        	rol z80_h
00114A  3  06 rr        	asl z80_l
00114C  3  26 rr        	rol z80_h
00114E  3  06 rr        	asl z80_l
001150  3  26 rr        	rol z80_h
001152  3               
001152  3  A5 rr        	lda z80_h		; x coordinate now in h.
001154  3  85 rr        	sta dispy		; set the display coordinate.
001156  3               
001156  3  A9 00        	lda #0 			; block to write.
001158  3  20 C9 16     	jsr pattr 		; write block.
00115B  3               
00115B  3  68           	pla 			; restore block pointer.
00115C  3  85 rr        	sta z80_l
00115E  3  68           	pla
00115F  3  85 rr        	sta z80_h
001161  3               
001161  3  60           	rts
001162  3               
001162  3               ;----------------------------------------------------
001162  3               ; Scrolly text and puzzle variables.
001162  3               ;----------------------------------------------------
001162  3               
001162  3               .if sflag
001162  3               txtbit:	.byte 128		; bit to write.
001162  3               txtwid:	.byte 16		; width of ticker message.
001162  3               txtpos:	.word msgdat
001162  3               txtini:	.word msgdat
001162  3               txtscr:	.word ScreenAddr
001162  3               .endif
001162  3               
001162  3               ;----------------------------------------------------
001162  3               ; Specialist routines.
001162  3               ; Process shrapnel.
001162  3               ;----------------------------------------------------
001162  3               proshr:
001162  3               .if pflag
001162  3               	lda #<SHRAPN		; table.
001162  3               	sta z80_x
001162  3               	lda #>SHRAPN
001162  3               	sta z80_i
001162  3               
001162  3               	lda #NUMSHR		; shrapnel pieces to process.
001162  3               	sta shrctr
001162  3               prosh0:
001162  3               	ldy #0
001162  3               	lda (z80_ix),y		; on/off marker.
001162  3               	asl a
001162  3               proshx:
001162  3               	bcs :+
001162  3               	jsr prosh1 		; on, so process it.
001162  3               :
001162  3               	clc
001162  3               	lda z80_x
001162  3               	adc #SHRSIZ
001162  3               	sta z80_x
001162  3               	bcc :+
001162  3               	inc z80_i
001162  3               :
001162  3               	dec shrctr		; round again.
001162  3               	bne prosh0
001162  3               .endif
001162  3               .if sflag
001162  3               	jsr scrly
001162  3               .endif
001162  3  60           	rts
001163  3               
001163  3               .if pflag
001163  3               ;----------------------------------------------------
001163  3               ; Proces shrapnel piece
001163  3               ;----------------------------------------------------
001163  3               
001163  3               prosh1:
001163  3               	jsr plot 		; delete the pixel.
001163  3               
001163  3               	lda #<shrptr		; shrapnel routine pointers.
001163  3               	sta z80_l
001163  3               	lda #>shrptr
001163  3               	sta z80_h
001163  3               
001163  3               	ldy #0
001163  3               	lda (z80_ix),y		; restore shrapnel type.
001163  3               	jsr prosh2 		; run the routine.
001163  3               	jsr chkxy		; check x and y are good before we redisplay.
001163  3               
001163  3               	lda #<SHRSIZ 		; distance to next.
001163  3               	sta z80_e
001163  3               	lda #>SHRSIZ
001163  3               	sta z80_d
001163  3               	rts
001163  3               
001163  3               ;----------------------------------------------------
001163  3               ; Run the routine
001163  3               ;----------------------------------------------------
001163  3               
001163  3               prosh2:
001163  3               	asl a 			; 2 bytes per address.
001163  3               	tay
001163  3               	lda shrptr,y
001163  3               	sta z80_l
001163  3               	lda shrptr+1,y 		; fetch high byte from table.
001163  3               	sta z80_h
001163  3               	jmp (z80_hl) 		; jump to routine.
001163  3               
001163  3               ;----------------------------------------------------
001163  3               ; Paricle routine table
001163  3               ;----------------------------------------------------
001163  3               
001163  3               shrptr:	.word laser		; laser.
001163  3               	.word trail		; vapour trail.
001163  3               	.word shrap		; shrapnel from explosion.
001163  3               	.word dotl		; horizontal starfield left.
001163  3               	.word dotr		; horizontal starfield right.
001163  3               	.word dotu		; vertical starfield up.
001163  3               	.word dotd		; vertical starfield down.
001163  3               	.word ptcusr		; user particle.
001163  3               
001163  3               ;----------------------------------------------------
001163  3               ; Explosion shrapnel.
001163  3               ;----------------------------------------------------
001163  3               
001163  3               shrap:
001163  3               	ldy #1
001163  3               	lda (z80_ix),y 		; get the angle.
001163  3               	clc
001163  3               	adc #<shrsin		; shrapnel sine table.
001163  3               	sta z80_l
001163  3               	lda #>shrsin
001163  3               	adc #0
001163  3               	sta z80_h
001163  3               
001163  3               	ldy #0
001163  3               	lda (z80_hl),y 		; fetch value from table.
001163  3               	sta z80_e
001163  3               	inc z80_l 		; next byte of table.
001163  3               	bne :+
001163  3               	inc z80_h
001163  3               :
001163  3               	ldy #0
001163  3               	lda (z80_hl),y		; fetch value from table.
001163  3               	sta z80_d
001163  3               	inc z80_l		; next byte of table.
001163  3               	bne :+
001163  3               	inc z80_h
001163  3               :
001163  3               	ldy #0
001163  3               	lda (z80_hl),y 		; fetch value from table.
001163  3               	sta z80_c
001163  3               	inc z80_l 		; next byte of table.
001163  3               	bne :+
001163  3               	inc z80_h
001163  3               :
001163  3               	ldy #0
001163  3               	lda (z80_hl),y 		; fetch value from table.
001163  3               	sta z80_b
001163  3               
001163  3               	ldy #2
001163  3               	lda (z80_ix),y 		; x coordinate in hl.
001163  3               	clc
001163  3               	adc z80_e		; add sine lb
001163  3               	sta (z80_ix),y		; store new coordinate lb.
001163  3               	ldy #3
001163  3               	lda (z80_ix),y
001163  3               	adc z80_d		; add sine hb
001163  3               	sta (z80_ix),y		; store new coordinate hb.
001163  3               
001163  3               	ldy #4
001163  3               	lda (z80_ix),y	 	; y coordinate in hl.
001163  3               	clc
001163  3               	adc z80_c		; add cosine lb
001163  3               	sta (z80_ix),y		; store new coordinate lb.
001163  3               	ldy #5
001163  3               	lda (z80_ix),y
001163  3               	adc z80_b		; add cosine lb
001163  3               	sta (z80_ix),y		; store new coordinate hb.
001163  3               
001163  3               	rts
001163  3               
001163  3               ;----------------------------------------------------
001163  3               ; Move dots
001163  3               ;----------------------------------------------------
001163  3               
001163  3               dotl:
001163  3               	ldy #5
001163  3               	lda (z80_ix),y
001163  3               	sec
001163  3               	sbc #1		 	; move left.
001163  3               	sta (z80_ix),y
001163  3               	rts
001163  3               dotr:
001163  3               	ldy #5
001163  3               	lda (z80_ix),y
001163  3               	clc
001163  3               	adc #1		 	; move left.
001163  3               	sta (z80_ix),y
001163  3               	rts
001163  3               dotu:
001163  3               	ldy #3
001163  3               	lda (z80_ix),y
001163  3               	sec
001163  3               	sbc #1		 	; move up.
001163  3               	sta (z80_ix),y
001163  3               	rts
001163  3               dotd:
001163  3               	ldy #3
001163  3               	lda (z80_ix),y
001163  3               	clc
001163  3               	adc #1			; move down.
001163  3               	sta (z80_ix),y
001163  3               	rts
001163  3               
001163  3               ;----------------------------------------------------
001163  3               ; Check if coordinates are ok before redrawing at new position.
001163  3               ;
001163  3               ; left:   X>L		X=L	Ok
001163  3               ; right:  R+15>X	X=R	Ok
001163  3               ; top:    Y>T		Y=T	Ok
001163  3               ; bottom: B+15>Y	Y=B	Ok
001163  3               ;----------------------------------------------------
001163  3               
001163  3               chkxy:
001163  3               
001163  3               ; top:    Y>T		Y=T	Ok
001163  3               
001163  3               	ldy #3
001163  3               	lda (z80_ix),y	 	; fetch shrapnel coordinate.
001163  3               	cmp wntopx		; window top.
001163  3               	bcs :+			; compare with top window limit.
001163  3               	jmp kilshr		; out of window, kill shrapnel.
001163  3               :
001163  3               ; left:   X>L		X=L	Ok
001163  3               
001163  3               	ldy #5
001163  3               	lda (z80_ix),y	 	; fetch shrapnel coordinate.
001163  3               	cmp wnlftx		; left edge.
001163  3               	bcs :+			; compare with left window limit.
001163  3               	jmp kilshr		; out of window, kill shrapnel.
001163  3               :
001163  3               ; bottom: B+15>Y	Y=B	Ok
001163  3               
001163  3               	lda wnbotx		; point to bottom.
001163  3               	clc
001163  3               	adc #15
001163  3               	ldy #3
001163  3               	cmp (z80_ix),y	 	; fetch shrapnel coordinate.
001163  3               	bcs :+			; compare with shrapnel x coordinate.
001163  3               	jmp kilshr		; off screen, kill shrapnel..
001163  3               :
001163  3               ; right:  R+15>X	X=R	Ok
001163  3               
001163  3               	lda wnrgtx		; point to right edge.
001163  3               	clc
001163  3               	adc #15
001163  3               	ldy #5
001163  3               	cmp (z80_ix),y	 	; fetch shrapnel coordinate.
001163  3               	bcs :+			; compare with window limit.
001163  3               	jmp kilshr		; off screen, kill shrapnel.
001163  3               :
001163  3               
001163  3               ;----------------------------------------------------
001163  3               ; Drop through.
001163  3               ; Display shrapnel.
001163  3               ;----------------------------------------------------
001163  3               
001163  3               plot:
001163  3               	ldy #3
001163  3               	lda (z80_ix),y		; y integer.
001163  3               	sta dispy	 	; workspace coordinates.
001163  3               	ldy #5
001163  3               	lda (z80_ix),y	 	; x integer.
001163  3               	sta dispx 		; workspace coordinates.
001163  3               
001163  3               	ldy #0
001163  3               	lda (z80_ix),y 		; type.
001163  3               	bne :+			; is it a laser?
001163  3               	jmp plot1 		; yes, draw laser instead.
001163  3               :
001163  3               plot0:
001163  3               	lda dispx		; which pixel within byte do we
001163  3               	and #7			; want to set first?
001163  3               	tay
001163  3               	lda dots,y 		; table of small pixel positions.
001163  3               	sta z80_e 		; get value.
001163  3               
001163  3               	jsr scadd 		; screen address.
001163  3               	ldy #0
001163  3               	lda (scraddr),y		; see what's already there.
001163  3               	eor z80_e
001163  3               	sta (scraddr),y 	; put back on screen.
001163  3               	rts
001163  3               
001163  3               plot1:
001163  3               	jsr scadd 		; screen address.
001163  3               	ldy #0
001163  3               	lda (scraddr),y 	; fetch byte there.
001163  3               	eor #255 		; toggle all bits.
001163  3               	sta (scraddr),y 	; new byte.
001163  3               	rts
001163  3               
001163  3               ;----------------------------------------------------
001163  3               ; Switch off shrapnel
001163  3               ;----------------------------------------------------
001163  3               
001163  3               kilshr:
001163  3               	lda #128
001163  3               	ldy #0
001163  3               	sta (z80_ix),y	; switch off shrapnel.
001163  3               	rts
001163  3               
001163  3               ;----------------------------------------------------
001163  3               ; Sine/cosine table
001163  3               ;----------------------------------------------------
001163  3               
001163  3               shrsin:	.word 0,1024,391,946,724,724,946,391
001163  3               	.word 1024,0,946,65144,724,64811,391,64589
001163  3               	.word 0,64512,65144,64589,64811,64811,64589,65144
001163  3               	.word 64512,0,64589,391,64811,724,65144,946
001163  3               
001163  3               ;----------------------------------------------------
001163  3               ; Create trail
001163  3               ;----------------------------------------------------
001163  3               
001163  3               trail:
001163  3               	ldy #1
001163  3               	lda (z80_ix),y 	; time remaining.
001163  3               	sec
001163  3               	sbc #1
001163  3               	sta (z80_ix),y
001163  3               	bne :+
001163  3               	jmp trailk		; time to switch it off.
001163  3               :
001163  3               	jsr qrand		; get a random number.
001163  3               	lsr a 			; x or y axis?
001163  3               	bcc :+
001163  3               	jmp trailv		; use y.
001163  3               :
001163  3               ; Trail horizontal
001163  3               
001163  3               	lsr a 			; which direction?
001163  3               	bcc :+
001163  3               	jmp traill		; go left.
001163  3               :
001163  3               ; Trail right
001163  3               
001163  3               	ldy #5
001163  3               	lda (z80_ix),y
001163  3               	clc
001163  3               	adc #1	 		; go right.
001163  3               	sta (z80_ix),y
001163  3               	rts
001163  3               
001163  3               ; Trail left
001163  3               
001163  3               traill:
001163  3               	ldy #5
001163  3               	lda (z80_ix),y
001163  3               	sec
001163  3               	sbc #1 			; go left.
001163  3               	sta (z80_ix),y
001163  3               	rts
001163  3               
001163  3               ; Trail vertical
001163  3               
001163  3               trailv:
001163  3               	lsr a		 	; which direction?
001163  3               	bcc :+
001163  3               	jmp trailu		; go up.
001163  3               :
001163  3               ; Trail down
001163  3               
001163  3               	ldy #3
001163  3               	lda (z80_ix),y
001163  3               	clc
001163  3               	adc #1 			; go down.
001163  3               	sta (z80_ix),y
001163  3               	rts
001163  3               
001163  3               ; Trail up
001163  3               
001163  3               trailu:
001163  3               	ldy #3
001163  3               	lda (z80_ix),y
001163  3               	sec
001163  3               	sbc #1 			; go up.
001163  3               	sta (z80_ix),y
001163  3               	rts
001163  3               
001163  3               ; Kill trail
001163  3               
001163  3               trailk:
001163  3               	lda #200		; set off-screen to kill vapour trail.
001163  3               	ldy #3
001163  3               	sta (z80_ix),y
001163  3               	rts
001163  3               
001163  3               ;----------------------------------------------------
001163  3               ; Create laser beam
001163  3               ;----------------------------------------------------
001163  3               
001163  3               laser:
001163  3               	ldy #1
001163  3               	lda (z80_ix),y 		; direction.
001163  3               	ror a 			; left or right?
001163  3               	bcs :+
001163  3               	jmp laserl		; move left.
001163  3               :
001163  3               ; Laser right
001163  3               
001163  3               	lda #8			; distance to travel.
001163  3               	sta z80_b
001163  3               	jmp laserm		; move laser.
001163  3               
001163  3               ; Laser left
001163  3               
001163  3               laserl:
001163  3               	lda #248		; distance to travel.
001163  3               	sta z80_b
001163  3               laserm:
001163  3               	ldy #5
001163  3               	lda (z80_ix),y		; x position.
001163  3               	clc
001163  3               	adc z80_b		; add distance.
001163  3               	sta (z80_ix),y		; set new x coordinate.
001163  3               
001163  3               ; Test new block.
001163  3               
001163  3               	sta dispx 		; set x for block collision detection purposes.
001163  3               	ldy #3
001163  3               	lda (z80_ix),y 		; get y.
001163  3               	sta dispy		; set coordinate for collision test.
001163  3               	jsr tstbl 		; get block type there.
001163  3               	cmp #WALL		; is it solid?
001163  3               	bne :+
001163  3               	jmp trailk		; yes, it cannot pass.
001163  3               :
001163  3                       cmp #FODDER             ; is it fodder?
001163  3                       bne :+
001163  3                       jsr fdchk               ; remove fodder block.
001163  3                       jmp trailk              ; destroy laser.
001163  3               :
001163  3                       rts                     ; no, ignore it.
001163  3               
001163  3               ;----------------------------------------------------
001163  3               ; Dots mask
001163  3               ;----------------------------------------------------
001163  3               
001163  3               dots:	.byte 128,64,32,16,8,4,2,1
001163  3               
001163  3               
001163  3               ;----------------------------------------------------
001163  3               ; Plot, preserving de.
001163  3               ;----------------------------------------------------
001163  3               
001163  3               plotde:
001163  3               	lda z80_d 		; put de on stack.
001163  3               	pha
001163  3               	lda z80_e
001163  3               	pha
001163  3               
001163  3               	jsr plot 		; plot pixel.
001163  3               
001163  3               	pla			; restore de from stack.
001163  3               	sta z80_e
001163  3               	pla
001163  3               	sta z80_d
001163  3               
001163  3               	rts
001163  3               
001163  3               ;----------------------------------------------------
001163  3               ; Shoot a laser.
001163  3               ;----------------------------------------------------
001163  3               
001163  3               shoot:
001163  3               	sta z80_c		; store direction in c register.
001163  3               	ldy #8
001163  3               	lda (z80_ix),y 		; y coordinate.
001163  3               shoot1:
001163  3               	clc
001163  3               	adc #7 			; down 7 pixels.
001163  3               	sta z80_l 		; puty y coordinate in l.
001163  3               
001163  3               	ldy #9
001163  3               	lda (z80_ix),y 		; x coordinate in h.
001163  3               	sta z80_h
001163  3               
001163  3               	lda z80_i		; store pointer to sprite.
001163  3               	pha
001163  3               	lda z80_x
001163  3               	pha
001163  3               
001163  3               	jsr fpslot 		; find particle slot.
001163  3               	bcs :+
001163  3               	jmp vapou2		; failed, restore ix.
001163  3               :
001163  3               	lda #0
001163  3               	ldy #0
001163  3               	sta (z80_ix),y 		; set up a laser.
001163  3               
001163  3               	lda z80_c
001163  3               	ldy #1
001163  3               	sta (z80_ix),y 		; set the direction.
001163  3               
001163  3               	lda z80_l
001163  3               	ldy #3
001163  3               	sta (z80_ix),y		; set y coordinate.
001163  3               
001163  3               	ror z80_c		; check direction we want.
001163  3               	bcc :+
001163  3               	jmp shootr		; shoot right.
001163  3               :
001163  3               	lda z80_h		; X position.
001163  3               shoot0:
001163  3               	and #248		; align on character boundary.
001163  3               	ldy #5
001163  3               	sta (z80_ix),y		; set x coordinate.
001163  3               	jmp vapou0 		; draw first image.
001163  3               shootr:
001163  3               	lda z80_h		; x position.
001163  3               	clc
001163  3               	adc #15			; look right.
001163  3               	jmp shoot0		; align and continue.
001163  3               
001163  3               ;----------------------------------------------------
001163  3               ; Create a bit of vapour trail.
001163  3               ;----------------------------------------------------
001163  3               
001163  3               vapour:
001163  3               	lda z80_i		; store pointer to sprite.
001163  3               	pha
001163  3               	lda z80_x
001163  3               	pha
001163  3               
001163  3               	ldy #8
001163  3               	lda (z80_ix),y 		; y coordinate.
001163  3               	clc
001163  3               	adc #7			; mid-point of sprite.
001163  3               	sta z80_l
001163  3               
001163  3               	ldy #9
001163  3               	lda (z80_ix),y 		; x coordinate.
001163  3               	adc #7
001163  3               	sta z80_h
001163  3               
001163  3               	jsr fpslot 		; find particle slot.
001163  3               	bcc :+
001163  3               	jmp vapou1		; no, we can use it.
001163  3               :
001163  3               vapou2:
001163  3               	pla
001163  3               	sta z80_x
001163  3               	pla
001163  3               	sta z80_i
001163  3               	rts
001163  3               vapou1:
001163  3               	lda z80_l
001163  3               	ldy #3
001163  3               	sta (z80_ix),y		; set up y.
001163  3               
001163  3               	lda z80_h
001163  3               	ldy #5
001163  3               	sta (z80_ix),y 		; set up x coordinate.
001163  3               
001163  3               	jsr qrand		; get quick random number.
001163  3               	and #15			; random time.
001163  3               	clc
001163  3               	adc #15			; minimum time on screen.
001163  3               	ldy #1
001163  3               	sta (z80_ix),y		; set time on screen.
001163  3               
001163  3               	lda #1
001163  3               	ldy #0
001163  3               	sta (z80_ix),y		; define particle as vapour trail.
001163  3               vapou0:
001163  3               	jsr chkxy		; plot first position.
001163  3               	jmp vapou2
001163  3               
001163  3               ;----------------------------------------------------
001163  3               ; Create a user particle.
001163  3               ;----------------------------------------------------
001163  3               
001163  3               ptusr:
001163  3               	sta z80_f		; store timer.
001163  3               
001163  3               	ldy #8
001163  3               	lda (z80_ix),y 		; y coordinate.
001163  3               	clc
001163  3               	adc #7			; mid-point of sprite.
001163  3               	sta z80_l
001163  3               
001163  3               	ldy #9
001163  3               	lda (z80_ix),y 		; x coordinate.
001163  3               	clc
001163  3               	adc #7			; mid-point of sprite.
001163  3               	sta z80_h
001163  3               
001163  3               	jsr fpslot 		; find particle slot.
001163  3               	bcs ptusr1
001163  3               	rts 			; out of slots, can't generate anything.
001163  3               ptusr1:
001163  3               	lda z80_l
001163  3               	ldy #3
001163  3               	sta (z80_ix),y 		; set up y.
001163  3               
001163  3               	lda z80_h
001163  3               	ldy #5
001163  3               	sta (z80_ix),y		; set up x coordinate.
001163  3               
001163  3               	lda z80_f 		; restore timer.
001163  3               	ldy #1
001163  3               	sta (z80_ix),y		; set time on screen.
001163  3               
001163  3               	lda #7
001163  3               	ldy #0
001163  3               	sta (z80_ix),y		; define particle as user particle.
001163  3               
001163  3               	jmp chkxy		; plot first position.
001163  3               
001163  3               ;----------------------------------------------------
001163  3               ; Create a vertical or horizontal star.
001163  3               ;----------------------------------------------------
001163  3               
001163  3               star:
001163  3               	lda z80_i		; store pointer to sprite.
001163  3               	pha
001163  3               	lda z80_x
001163  3               	pha
001163  3               
001163  3               	jsr fpslot 		; find particle slot.
001163  3               	bcs star7		; found one we can use.
001163  3               star0:
001163  3               	pla 			; restore sprite pointer.
001163  3               	sta z80_x
001163  3               	pla
001163  3               	sta z80_i
001163  3               	rts 			; out of slots, can't generate anything.
001163  3               star7:
001163  3               	lda z80_c		; direction.
001163  3               	and #3 			; is it left?
001163  3               	bne :+
001163  3               	jmp star1 		; yes, it's left.
001163  3               :
001163  3               	cmp #1 			; is it right?
001163  3               	bne :+
001163  3               	jmp star2 		; yes, it's right.
001163  3               :
001163  3               	cmp #2 			; is it up?
001163  3               	bne :+
001163  3               	jmp star3 		; yes, it's up.
001163  3               :
001163  3               	ldy wntopx 		; get edge of screen.
001163  3               	iny			; down one pixel.
001163  3               	tya
001163  3               star8:
001163  3               	ldy #3
001163  3               	sta (z80_ix),y 		; set y coord.
001163  3               	jsr qrand 		; get quick random number.
001163  3               star9:
001163  3               	ldy #5
001163  3               	sta (z80_ix),y		; set x position.
001163  3               
001163  3               	lda z80_c		; direction.
001163  3               	and #3			; zero to three.
001163  3               	clc
001163  3               	adc #3			; 3 to 6 for starfield.
001163  3               	ldy #0
001163  3               	sta (z80_ix),y		; define particle as star.
001163  3               	jsr chkxy		; plot first position.
001163  3               	jmp star0
001163  3               star1:
001163  3               	jsr qrand		; get quick random number.
001163  3               	ldy #3
001163  3               	sta (z80_ix),y 		; set y coord.
001163  3               
001163  3               	lda wnrgtx 		; get edge of screen.
001163  3               	clc
001163  3               	adc #15			; add width of sprite minus 1.
001163  3               	jmp star9
001163  3               star2:
001163  3               	jsr qrand 		; get quick random number.
001163  3               	ldy #3
001163  3               	sta (z80_ix),y		; set y coord.
001163  3               
001163  3               	lda wnlftx		; get edge of screen.
001163  3               	jmp star9
001163  3               star3:
001163  3               	lda wnbotx 		; get edge of screen.
001163  3               	clc
001163  3               	adc #15 		; height of sprite minus one pixel.
001163  3               	jmp star8
001163  3               
001163  3               ;----------------------------------------------------
001163  3               ; Find particle slot for lasers or vapour trail.
001163  3               ; can't use alternate accumulator.
001163  3               ;----------------------------------------------------
001163  3               
001163  3               fpslot:
001163  3               	lda #<SHRAPN 		; shrapnel table.
001163  3               	sta z80_x
001163  3               	lda #>SHRAPN
001163  3               	sta z80_i
001163  3               
001163  3               	lda #NUMSHR		; number of pieces in table.
001163  3               	sta z80_b
001163  3               fpslt0:
001163  3               	ldy #0
001163  3               	lda (z80_ix),y		; get type.
001163  3               	asl a  			; is this slot in use?
001163  3               	bcc :+
001163  3               	rts			; no, we can use it.
001163  3               :
001163  3               	clc			; point to more shrapnel.
001163  3               	lda z80_x
001163  3               	adc #SHRSIZ
001163  3               	sta z80_x
001163  3               	bcc :+
001163  3               	inc z80_i
001163  3               :
001163  3               	dec z80_b		; repeat for all shrapnel.
001163  3               	bne fpslt0
001163  3               
001163  3               	clc
001163  3               	rts 			; out of slots, can't generate anything.
001163  3               
001163  3               ;----------------------------------------------------
001163  3               ; Create an explosion at sprite position.
001163  3               ;----------------------------------------------------
001163  3               
001163  3               explod:
001163  3               	sta z80_c 		; particles to create.
001163  3               
001163  3               	lda z80_i 		; store pointer to sprite.
001163  3               	pha
001163  3               	lda z80_x
001163  3               	pha
001163  3               
001163  3               	ldy #8
001163  3               	lda (z80_ix),y 		; y coordinate.
001163  3               	sta z80_l
001163  3               	ldy #9
001163  3               	lda (z80_ix),y		; x coordinate.
001163  3               	sta z80_h
001163  3               
001163  3               	lda #<SHRAPN		; shrapnel table.
001163  3               	sta z80_x
001163  3               	lda #>SHRAPN
001163  3               	sta z80_i
001163  3               
001163  3               	lda #NUMSHR		; number of pieces in table.
001163  3               	sta explcnt
001163  3               expld0:
001163  3               	ldy #0
001163  3               	lda (z80_ix),y		; get type.
001163  3               	asl a 			; is this slot in use?
001163  3               	bcs expld1		; no, we can use it.
001163  3               expld2:
001163  3               	clc
001163  3               	lda z80_x
001163  3               	adc #SHRSIZ
001163  3               	sta z80_x
001163  3               	bcc :+
001163  3               	inc z80_i
001163  3               :
001163  3               	dec explcnt		; repeat for all shrapnel.
001163  3               	bne expld0
001163  3               expld3:
001163  3               	pla			; restore sprite pointer.
001163  3               	sta z80_x
001163  3               	pla
001163  3               	sta z80_i
001163  3               	rts 			; out of slots, can't generate any more.
001163  3               
001163  3               expld1:
001163  3               	lda z80_c		; shrapnel counter.
001163  3               	and #15			; 0 to 15.
001163  3               	clc			; add to x.
001163  3               	adc z80_l
001163  3               	ldy #3
001163  3               	sta (z80_ix),y		; y coord.
001163  3               
001163  3               	lda seed3 		; crap random number.
001163  3               	and #15			; 0 to 15.
001163  3               	clc 			; add to y.
001163  3               	adc z80_h
001163  3               	ldy #5
001163  3               	sta (z80_ix),y		; x coord.
001163  3               
001163  3               	lda #2
001163  3               	ldy #0
001163  3               	sta (z80_ix),y		; switch it on.
001163  3               
001163  3               	jsr chkxy		; plot first position.
001163  3               	jsr qrand		; quick random angle.
001163  3               	and #60 		; keep within range.
001163  3               	ldy #1
001163  3               	sta (z80_ix),y		; angle.
001163  3               
001163  3               	dec z80_c		; one less piece of shrapnel to generate.
001163  3               	bne expld2 		; back to main explosion loop.
001163  3               	jmp expld3 		; restore sprite pointer and exit.
001163  3               
001163  3               ;----------------------------------------------------
001163  3               ; Quick random
001163  3               ;----------------------------------------------------
001163  3               
001163  3               qrand:
001163  3               	jsr random		; r register.
001163  3               	eor seed3		; combine with seed.
001163  3               	sta seed3 		; new seed.
001163  3               	rts
001163  3               
001163  3               ;----------------------------------------------------
001163  3               ; Display all shrapnel.
001163  3               ;----------------------------------------------------
001163  3               
001163  3               dshrp:
001163  3               	lda #<plotde		; display routine.
001163  3               	sta proshx+1
001163  3               	lda #>plotde
001163  3               	sta proshx+2
001163  3               	jsr proshr		; process shrapnel.
001163  3               
001163  3               	lda #<prosh1		; processing routine.
001163  3               	sta proshx+1
001163  3               	lda #>prosh1
001163  3               	sta proshx+2
001163  3               	rts
001163  3               
001163  3               ;------------------------------------------------------
001163  3               ; Particle engine.
001163  3               ;
001163  3               ; Init particle data for 55 particles in SHRAPN table.
001163  3               ; Every particle has 6 bytes.
001163  3               ;
001163  3               ; global:	-
001163  3               ; local:	x,y,hl
001163  3               ; calls:	-
001163  3               ;------------------------------------------------------
001163  3               
001163  3               inishr:
001163  3               	lda #<SHRAPN 		; table.
001163  3               	sta z80_l
001163  3               	lda #>SHRAPN
001163  3               	sta z80_h
001163  3               
001163  3               	ldy #0
001163  3               	ldx #NUMSHR		; shrapnel pieces to process.
001163  3               inish0:
001163  3               	lda #255 		; kill the shrapnel.
001163  3               	sta (z80_hl),y
001163  3               
001163  3               	clc 			; point there.
001163  3               	lda z80_l
001163  3               	adc #SHRSIZ		; distance to next.
001163  3               	sta z80_l
001163  3               	bcc :+
001163  3               	inc z80_h
001163  3               :
001163  3               	dex
001163  3               	bne inish0 		; round again.
001163  3               	rts
001163  3               
001163  3               ;------------------------------------------------------
001163  3               ; Check for collision between laser and sprite.
001163  3               ;------------------------------------------------------
001163  3               
001163  3               lcol:
001163  3               	lda #<SHRAPN		; shrapnel table.
001163  3               	sta z80_l
001163  3               	lda #>SHRAPN
001163  3               	sta z80_h
001163  3               
001163  3               	lda #NUMSHR		; number of pieces in table.
001163  3               	sta z80_b
001163  3               lcol0:
001163  3               	ldy #0
001163  3               	lda (z80_hl),y 		; get type.
001163  3               	beq lcol1		; yes, check collision.
001163  3               lcol3:
001163  3               	clc			; point to more shrapnel.
001163  3               	lda z80_l
001163  3               	adc #SHRSIZ
001163  3               	sta z80_l
001163  3               	bcc :+
001163  3               	inc z80_h
001163  3               :
001163  3               	dec z80_b		; repeat for all shrapnel.
001163  3               	bne lcol0
001163  3               	rts 			; no collision, carry not set.
001163  3               lcol1:
001163  3               	ldy #3
001163  3               	lda (z80_hl),y		; get y.
001163  3               	sec
001163  3               	ldy #8
001163  3               	sbc (z80_ix),y		; subtract sprite y.
001163  3               lcolh:
001163  3               	cmp #16 		; within range?
001163  3               	bcc :+
001163  3               	jmp lcol2		; no, missed.
001163  3               :
001163  3               	ldy #5
001163  3               	lda (z80_hl),y 		; get x.
001163  3               	sec
001163  3               	ldy #9
001163  3               	sbc (z80_ix),y 		; subtract sprite y.
001163  3               	cmp #16			; within range?
001163  3               	bcs :+
001163  3               	jmp lcol4 		; yes, collision occurred.
001163  3               :
001163  3               lcol2:
001163  3               	jmp lcol3
001163  3               lcol4:
001163  3               	sec
001163  3               	rts 			; return with carry set for collision.
001163  3               .endif
001163  3               
001163  3               ;------------------------------------------------------
001163  3               ; Main game engine code starts here.
001163  3               ; After initialisation, mloop is the main loop
001163  3               ;------------------------------------------------------
001163  3               
001163  3               game:
001163  3               
001163  3               ; Set up screen address table.
001163  3               
001163  3               setsat:
001163  3  A9 00        	lda #<ScreenAddr		; start of screen.
001165  3  85 rr        	sta scraddr
001167  3  A9 68        	lda #>ScreenAddr
001169  3  85 rr        	sta scraddr+1
00116B  3               
00116B  3  A0 00        	ldy #0			; vertical lines on screen.
00116D  3               setsa0:
00116D  3  A5 rr        	lda scraddr
00116F  3  99 00 06     	sta SCADTB_lb,y		; write low byte.
001172  3  A5 rr        	lda scraddr+1
001174  3  99 00 07     	sta SCADTB_hb,y		; write high byte.
001177  3  20 13 10     	jsr nline		; next line down.
00117A  3  C8           	iny			; next position in table.
00117B  3  D0 F0        	bne setsa0
00117D  3               
00117D  3               ; Init graphics mode
00117D  3               
00117D  3  20 DE 0E     	jsr screeninit
001180  3               
001180  3               ; Init AtoMMC joystick
001180  3  20 A4 0E     	jsr joyinit		; AtoMMC joystick on PORT B
001183  3               
001183  3               rpblc2:
001183  3               .if pflag
001183  3               	jsr inishr 		; initialise particle engine.
001183  3               .endif
001183  3               evintr:
001183  3  20 FB 46     	jsr evnt12 		; call intro/menu event.
001186  3               
001186  3  A9 02        	lda #WALL 		; write default property.
001188  3  A2 00        	ldx #0
00118A  3               clrmap:
00118A  3  9D 00 03     	sta MAP,x 		; block properties.
00118D  3  9D 00 04     	sta MAP+256,x
001190  3  9D 00 05     	sta MAP+512,x
001193  3  E8           	inx			; next byte.
001194  3  D0 F4        	bne clrmap
001196  3               
001196  3  20 91 10     	jsr iniob 		; initialise objects.
001199  3               
001199  3  A9 00        	lda #0			; put zero in accumulator.
00119B  3  85 rr        	sta gamwon		; reset game won flag.
00119D  3               
00119D  3  20 02 13     	jsr inisc 		; init the score.
0011A0  3               mapst:
0011A0  3  AD AD 22     	lda stmap 		; start position on map.
0011A3  3  8D A2 22     	sta roomtb		; set up position in table, if there is one.
0011A6  3               
0011A6  3               inipbl:
0011A6  3  20 60 1F     	jsr initsc 		; set up first screen.
0011A9  3               
0011A9  3  A9 91        	lda #<ssprit 		; default to spare sprite in table.
0011AB  3  85 rr        	sta z80_x
0011AD  3  A9 22        	lda #>ssprit
0011AF  3  85 rr        	sta z80_i
0011B1  3               evini:
0011B1  3  20 FC 46     	jsr evnt13 		; initialisation.
0011B4  3               
0011B4  3               ; Two restarts.
0011B4  3               ; First restart - clear all sprites and initialise everything.
0011B4  3               
0011B4  3               rstrt:
0011B4  3  20 A2 12     	jsr rsevt 		; restart events.
0011B7  3  20 84 10     	jsr xspr 		; clear sprite table.
0011BA  3  20 C2 20     	jsr sprlst 		; fetch pointer to screen sprites.
0011BD  3  20 4B 21     	jsr ispr 		; initialise sprite table.
0011C0  3               
0011C0  3  4C CF 11     	jmp rstrt0
0011C3  3               
0011C3  3               ; Second restart - clear all but player, and don't initialise him.
0011C3  3               
0011C3  3               rstrtn:
0011C3  3  20 A2 12     	jsr rsevt		; restart events.
0011C6  3  20 EF 20     	jsr nspr 		; clear all non-player sprites.
0011C9  3  20 C2 20     	jsr sprlst 		; fetch pointer to screen sprites.
0011CC  3  20 88 21     	jsr kspr 		; initialise sprite table, no more players.
0011CF  3               
0011CF  3               ; Set up the player and/or enemy sprites.
0011CF  3               
0011CF  3               rstrt0:
0011CF  3  A9 00        	lda #0 			; zero in accumulator.
0011D1  3  85 rr        	sta nexlev 		; reset next level flag.
0011D3  3  85 rr        	sta restfl 		; reset restart flag.
0011D5  3  85 rr        	sta deadf 		; reset dead flag.
0011D7  3  20 71 17     	jsr droom 		; show screen layout.
0011DA  3               rpblc0:
0011DA  3               .if pflag
0011DA  3               	jsr inishr 		; initialise particle engine.
0011DA  3               .endif
0011DA  3  20 52 13     	jsr shwob		; draw objects.
0011DD  3               
0011DD  3  A9 00        	lda #<sprtab 		; address of sprite table, even sprites.
0011DF  3  85 rr        	sta z80_x
0011E1  3  A9 0B        	lda #>sprtab
0011E3  3  85 rr        	sta z80_i
0011E5  3  20 31 1D     	jsr dspr 		; display sprites.
0011E8  3               
0011E8  3  A9 11        	lda #<(sprtab+TABSIZ) 	; address of first odd sprite.
0011EA  3  85 rr        	sta z80_x
0011EC  3  A9 0B        	lda #>(sprtab+TABSIZ)
0011EE  3  85 rr        	sta z80_i
0011F0  3  20 31 1D     	jsr dspr 		; display sprites.
0011F3  3               mloop:
0011F3  3  20 BC 0E     	jsr vsync 		; synchronise with display.
0011F6  3               
0011F6  3  A9 00        	lda #<sprtab 		; address of sprite table, even sprites.
0011F8  3  85 rr        	sta z80_x
0011FA  3  A9 0B        	lda #>sprtab
0011FC  3  85 rr        	sta z80_i
0011FE  3  20 31 1D     	jsr dspr 		; display even sprites.
001201  3               
001201  3  20 51 13     	jsr plsnd 		; play sounds.
001204  3  20 BC 0E     	jsr vsync 		; synchronise with display.
001207  3               
001207  3  A9 11        	lda #<(sprtab+TABSIZ) 	; address of first odd sprite.
001209  3  85 rr        	sta z80_x
00120B  3  A9 0B        	lda #>(sprtab+TABSIZ)
00120D  3  85 rr        	sta z80_i
00120F  3  20 31 1D     	jsr dspr 		; display odd sprites.
001212  3               
001212  3  A9 91        	lda #<(ssprit) 		; point to spare sprite for spawning purposes.
001214  3  85 rr        	sta z80_x
001216  3  A9 22        	lda #>(ssprit)
001218  3  85 rr        	sta z80_i
00121A  3               evlp1:
00121A  3  20 16 46     	jsr evnt10 		; called once per main loop.
00121D  3  20 AF 1C     	jsr pspr 		; process sprites.
001220  3               
001220  3               ; Main loop events.
001220  3               
001220  3  A9 91        	lda #<ssprit 		; point to spare sprite for spawning purposes.
001222  3  85 rr        	sta z80_x
001224  3  A9 22        	lda #>ssprit
001226  3  85 rr        	sta z80_i
001228  3               evlp2:
001228  3  20 FA 46     	jsr evnt11 		; called once per main loop.
00122B  3               bsortx:
00122B  3  20 25 1C     	jsr bsort 		; sort sprites.
00122E  3               
00122E  3  A5 rr        	lda nexlev		; finished level flag.
001230  3  D0 1F        	bne newlev		; is set, go to next level.
001232  3  A5 rr        	lda gamwon		; finished game flag.
001234  3  D0 2A        	bne evwon		; is set, finish the game.
001236  3  A5 rr        	lda restfl 		; finished level flag.
001238  3  C9 01        	cmp #1			; has it been set?
00123A  3  D0 03        	bne :+
00123C  3  4C B4 11     	jmp rstrt		; yes, go to next level.
00123F  3               :
00123F  3  C9 02        	cmp #2			; has it been set?
001241  3  D0 03        	bne :+
001243  3  4C C3 11     	jmp rstrtn		; yes, go to next level.
001246  3               :
001246  3  A5 rr        	lda deadf 		; dead flag.
001248  3  D0 1C        	bne pdead		; yes, player dead.
00124A  3               
00124A  3               ; back to start of main loop.
00124A  3               
00124A  3  E6 rr        	inc frmno
00124C  3  E6 rr        	inc clock
00124E  3  4C F3 11     	jmp mloop		; switched to a jmp mloop during test mode.
001251  3               
001251  3               ;----------------------------------------------------------
001251  3               ; New level
001251  3               ;----------------------------------------------------------
001251  3               
001251  3               newlev:
001251  3  A5 rr        	lda scno 			; current screen.
001253  3  18           	clc
001254  3  69 01        	adc #1				; next screen.
001256  3  CD 1B 70     	cmp numsc			; total number of screens.
001259  3  B0 05        	bcs evwon			; yes, game finished.
00125B  3  85 rr        	sta scno			; set new level number.
00125D  3  4C B4 11     	jmp rstrt			; restart, clearing all aliens.
001260  3               
001260  3               evwon:
001260  3  20 95 4B     	jsr evnt18		 	; game completed.
001263  3  4C 77 12     	jmp tidyup			; tidy up and return to BASIC/calling routine.
001266  3               
001266  3               ;----------------------------------------------------------
001266  3               ; Player dead.
001266  3               ;----------------------------------------------------------
001266  3               
001266  3               pdead:
001266  3  A9 00        	lda #0				; zeroise accumulator.
001268  3  85 rr        	sta deadf			; reset dead flag.
00126A  3               evdie:
00126A  3  20 93 4B     	jsr evnt16 			; death subroutine.
00126D  3  A5 rr        	lda numlif			; number of lives.
00126F  3  F0 03        	beq :+
001271  3  4C B4 11     	jmp rstrt 			; restart game.
001274  3               :
001274  3               evfail:
001274  3  20 94 4B     	jsr evnt17 			; failure event.
001277  3               
001277  3               ;----------------------------------------------------------
001277  3               ; Tidy things up
001277  3               ;----------------------------------------------------------
001277  3               
001277  3               tidyup:
001277  3  A0 00        	ldy #0				; digits to check.
001279  3               tidyu2:
001279  3  B9 1C 15     	lda score,y 			; get score digit.
00127C  3  CD 22 15     	cmp hiscor 			; are we larger than high score digit?
00127F  3  90 07        	bcc tidyu0			; high score is bigger.
001281  3  D0 0E        	bne tidyu1			; score is greater, record new high score.
001283  3  C8           	iny				; next digit of high score.
001284  3  C0 06        	cpy #6
001286  3  D0 F1        	bne tidyu2			; repeat for all digits
001288  3               tidyu0:
001288  3  A9 1C        	lda #<score			; return pointing to score.
00128A  3  85 rr        	sta z80_c
00128C  3  A9 15        	lda #>score
00128E  3  85 rr        	sta z80_b
001290  3  60           	rts
001291  3               tidyu1:
001291  3  A0 05        	ldy #5
001293  3               tidyu3:
001293  3  B9 1C 15     	lda score,y			; score.
001296  3  99 22 15     	sta hiscor,y			; high score.
001299  3  88           	dey
00129A  3  10 F7        	bpl tidyu3 			; copy score to high score.
00129C  3               evnewh:
00129C  3  20 96 4B     	jsr evnt19			; new high score event.
00129F  3  4C 88 12     	jmp tidyu0			; tidy up.
0012A2  3               
0012A2  3               ;--------------------------------------------------
0012A2  3               ; Restart event.
0012A2  3               ;--------------------------------------------------
0012A2  3               
0012A2  3               rsevt:
0012A2  3  A9 91        	lda #<ssprit 			; default to spare element in table.
0012A4  3  85 rr        	sta z80_x
0012A6  3  A9 22        	lda #>ssprit
0012A8  3  85 rr        	sta z80_i
0012AA  3               evrs:
0012AA  3  4C 2B 47     	jmp evnt14	 		; call restart event.
0012AD  3               
0012AD  3               ;------------------------------------------------------------------
0012AD  3               ; Copy number passed in a to string position bc, right-justified.
0012AD  3               ;
0012AD  3               ; Input:
0012AD  3               ;  A  = number
0012AD  3               ;  BC = string address
0012AD  3               ;
0012AD  3               ; Output:
0012AD  3               ;  BC = string with number
0012AD  3               ;-----------------------------------------------------------------
0012AD  3               
0012AD  3               num2ch:
0012AD  3  85 rr        	sta z80_d		; Save number
0012AF  3               
0012AF  3  A9 00        	lda #0
0012B1  3  85 rr        	sta flag
0012B3  3               numdg3:
0012B3  3  A2 64        	ldx #100		; hundreds column.
0012B5  3  86 rr        	stx z80_e
0012B7  3  20 C7 12     	jsr numdg		; show digit.
0012BA  3               numdg2:
0012BA  3  A2 0A        	ldx #10			; tens column.
0012BC  3  86 rr        	stx z80_e
0012BE  3  20 C7 12     	jsr numdg		; show digit.
0012C1  3               
0012C1  3  E6 rr        	inc flag
0012C3  3  A2 01        	ldx #1			; units column.
0012C5  3  86 rr        	stx z80_e
0012C7  3               numdg:
0012C7  3  A9 30        	lda #48			; clear digit.
0012C9  3  85 rr        	sta z80_a
0012CB  3               numdg1:
0012CB  3  A5 rr        	lda z80_d
0012CD  3  C5 rr        	cmp z80_e
0012CF  3  90 0E        	bcc numdg0		; nothing to show.
0012D1  3  38           	sec
0012D2  3  A5 rr        	lda z80_d
0012D4  3  E5 rr        	sbc z80_e		; subtract from column.
0012D6  3  85 rr        	sta z80_d
0012D8  3  E6 rr        	inc z80_a		; increment digit.
0012DA  3  E6 rr        	inc flag
0012DC  3  4C CB 12     	jmp numdg1		; repeat until column is zero.
0012DF  3               numdg0:
0012DF  3  A0 00        	ldy #0
0012E1  3  A5 rr        	lda z80_a
0012E3  3  91 rr        	sta (z80_bc),y		; write digit to buffer.
0012E5  3  A5 rr        	lda flag
0012E7  3  F0 06        	beq :+
0012E9  3  E6 rr        	inc z80_c		; next buffer position.
0012EB  3  D0 02        	bne :+
0012ED  3  E6 rr        	inc z80_b
0012EF  3               :
0012EF  3  60           	rts
0012F0  3               num2dd:
0012F0  3  85 rr        	sta z80_d		; Save number
0012F2  3               
0012F2  3  A9 01        	lda #1
0012F4  3  85 rr        	sta flag
0012F6  3               
0012F6  3  4C BA 12     	jmp numdg2
0012F9  3               num2td:
0012F9  3  85 rr        	sta z80_d		; Save number
0012FB  3               
0012FB  3  A9 01        	lda #1
0012FD  3  85 rr        	sta flag
0012FF  3  4C B3 12     	jmp numdg3
001302  3               
001302  3               ;---------------------------------------------------------
001302  3               ; Reset score to "000000"
001302  3               ;---------------------------------------------------------
001302  3               
001302  3               inisc:
001302  3  A9 30        	lda #'0'
001304  3  A2 05        	ldx #5			; digits to initialise.
001306  3               inisc0:
001306  3  9D 1C 15     	sta score,x 		; write zero digit.
001309  3  CA           	dex			; next column.
00130A  3  10 FA        	bpl inisc0		; repeat for all digits.
00130C  3               
00130C  3  60           	rts
00130D  3               
00130D  3               ;-----------------------------------------------------
00130D  3               ; Multiply h by d and return in hl.
00130D  3               ;
00130D  3               ; Input:
00130D  3               ;  H = first number
00130D  3               ;  D = second number
00130D  3               ;
00130D  3               ; Output:
00130D  3               ;  HL = result H x D
00130D  3               ;-----------------------------------------------------
00130D  3               
00130D  3               imul:
00130D  3  A5 rr        	lda z80_d		; HL = H * D
00130F  3  85 rr        	sta z80_e
001311  3  A5 rr        	lda z80_h
001313  3  85 rr        	sta z80_c		; make c first multiplier.
001315  3               imul0:
001315  3  A9 00        	lda #0			; zeroise total.
001317  3  85 rr        	sta z80_l
001319  3  85 rr        	sta z80_h
00131B  3               
00131B  3  A5 rr        	lda z80_h
00131D  3  85 rr        	sta z80_d		; zeroise high byte.
00131F  3               
00131F  3  A9 08        	lda #8			; repeat 8 times.
001321  3  85 rr        	sta z80_b
001323  3               imul1:
001323  3  46 rr        	lsr z80_c		; rotate rightmost bit into carry.
001325  3  90 0E        	bcc imul2		; wasn't set.
001327  3  18           	clc			; bit was set, so add de.
001328  3  A5 rr        	lda z80_l
00132A  3  65 rr        	adc z80_e
00132C  3  85 rr        	sta z80_l
00132E  3  A5 rr        	lda z80_h
001330  3  65 rr        	adc z80_d
001332  3  85 rr        	sta z80_h
001334  3  18           	clc 			; reset carry.
001335  3               imul2:
001335  3  06 rr        	asl z80_e 		; shift de 1 bit left.
001337  3  26 rr        	rol z80_d
001339  3  C6 rr        	dec z80_b
00133B  3  D0 E6        	bne imul1		; repeat 8 times.
00133D  3               
00133D  3  60           	rts
00133E  3               
00133E  3               ;-----------------------------------------------
00133E  3               ; Divide d by e and return in d, remainder in a.
00133E  3               ;
00133E  3               ; Input:
00133E  3               ;  D = first number
00133E  3               ;  E = second number
00133E  3               ;
00133E  3               ; Output:
00133E  3               ;  D = result D/E
00133E  3               ;  A = remainder
00133E  3               ;-----------------------------------------------
00133E  3               
00133E  3               idiv:
00133E  3  A9 00        	lda #0
001340  3  A0 08        	ldy #8		 	; bits to shift.
001342  3  06 rr        	asl z80_d
001344  3               idiv0:
001344  3  2A           	rol a 			; multiply d by 2.
001345  3  C5 rr        	cmp z80_e 		; test if e is smaller.
001347  3  90 02        	bcc idiv1		; e is greater, no division this time.
001349  3  E5 rr        	sbc z80_e		; subtract it.
00134B  3               idiv1:
00134B  3  26 rr        	rol z80_d		; rotate into d.
00134D  3  88           	dey
00134E  3  D0 F4        	bne idiv0		; repeat
001350  3  60           	rts
001351  3               
001351  3               ;---------------------------------------------------
001351  3               ; Play AY sound effect
001351  3               ;---------------------------------------------------
001351  3               
001351  3               plsnd:
001351  3  60           	rts
001352  3               
001352  3               ;---------------------------------------------------
001352  3               ; Objects handling.
001352  3               ; 32 bytes for image
001352  3               ; 3 for room, y and x
001352  3               ; 3 for starting room, y and x.
001352  3               ; 254 = disabled.
001352  3               ; 255 = object in player"s pockets.
001352  3               ;---------------------------------------------------
001352  3               
001352  3               ;---------------------------------------------------
001352  3               ; Show items present.
001352  3               ;---------------------------------------------------
001352  3               
001352  3               shwob:
001352  3  A9 7F        	lda #<objdta 			; objects table.
001354  3  85 rr        	sta z80_l
001356  3  A9 70        	lda #>objdta
001358  3  85 rr        	sta z80_h
00135A  3               
00135A  3  AD 7D 10     	lda numob 			; number of objects in the game.
00135D  3  85 rr        	sta sprcnt
00135F  3               shwob0:
00135F  3  A0 20        	ldy #32 			; distance to room number.
001361  3  B1 rr        	lda (z80_hl),y 			; same as an item?
001363  3  C5 rr        	cmp scno 			; current location.
001365  3  D0 03        	bne :+
001367  3  20 7C 13     	jsr dobj 			; yes, display object.
00136A  3               :
00136A  3  18           	clc
00136B  3  A5 rr        	lda z80_l
00136D  3  69 26        	adc #38 			; distance to next item.
00136F  3  85 rr        	sta z80_l
001371  3  A5 rr        	lda z80_h
001373  3  69 00        	adc #0
001375  3  85 rr        	sta z80_h	 		; point to it.
001377  3  C6 rr        	dec sprcnt
001379  3  D0 E4        	bne shwob0 			; repeat for others.
00137B  3  60           	rts
00137C  3               
00137C  3               ;---------------------------------------------------
00137C  3               ; Display object.
00137C  3               ; hl must point to object's start address.
00137C  3               ;
00137C  3               ; Input:
00137C  3               ;  HL = object address
00137C  3               ;---------------------------------------------------
00137C  3               
00137C  3               dobj:
00137C  3  A0 21        	ldy #33
00137E  3  B1 rr        	lda (z80_hl),y 			; point to y.
001380  3  85 rr        	sta dispy
001382  3  C8           	iny
001383  3  B1 rr        	lda (z80_hl),y 			; point to x.
001385  3  85 rr        	sta dispx
001387  3               dobj1:
001387  3  4C 1E 0F     	jmp sprite 			; draw this sprite.
00138A  3               
00138A  3               ;--------------------------------------
00138A  3               ; Remove an object.
00138A  3               ;
00138A  3               ; Input:
00138A  3               ;  A = object number
00138A  3               ;--------------------------------------
00138A  3               
00138A  3               remob:
00138A  3  CD 7D 10     	cmp numob			; number of objects in game.
00138D  3  90 01        	bcc :+				; are we checking past the end?
00138F  3  60           	rts				; yes, can't get non-existent item.
001390  3               :
001390  3  48           	pha				; remember object.
001391  3  20 9F 13     	jsr getob			; pick it up if we haven't already got it.
001394  3  68           	pla				; retrieve object number.
001395  3  20 CE 13     	jsr gotob			; get its address.
001398  3  A9 FE        	lda #254
00139A  3  A0 20        	ldy #32
00139C  3  91 rr        	sta (z80_hl),y			; remove it.
00139E  3  60           	rts
00139F  3               
00139F  3               ;---------------------------------------------------
00139F  3               ; Pick up object number held in the accumulator.
00139F  3               ;
00139F  3               ; Input:
00139F  3               ;  A = object number
00139F  3               ;---------------------------------------------------
00139F  3               
00139F  3               getob:
00139F  3  CD 7D 10     	cmp numob 		; number of objects in game.
0013A2  3  90 01        	bcc :+			; are we checking past the end?
0013A4  3  60           	rts			; yes, can't get non-existent item.
0013A5  3               :
0013A5  3  20 CE 13     	jsr gotob 		; check if we already have it.
0013A8  3  C9 FF        	cmp #255
0013AA  3  D0 01        	bne :+
0013AC  3  60           	rts			; we already do.
0013AD  3               :
0013AD  3  A0 20        	ldy #32
0013AF  3  B1 rr        	lda (z80_hl),y		; is it on this screen?
0013B1  3  C5 rr        	cmp scno 		; current screen.
0013B3  3  D0 14        	bne getob0		; not on screen, so nothing to delete.
0013B5  3               
0013B5  3  A9 FF        	lda #255
0013B7  3  91 rr        	sta (z80_hl),y		; pick it up.
0013B9  3  C8           	iny 			; point to y coord.
0013BA  3               getob1:
0013BA  3  A0 21        	ldy #33
0013BC  3  B1 rr        	lda (z80_hl),y		; y coord.
0013BE  3  85 rr        	sta dispy
0013C0  3  A0 22        	ldy #34
0013C2  3  B1 rr        	lda (z80_hl),y 		; x coord.
0013C4  3  85 rr        	sta dispx
0013C6  3  4C 87 13     	jmp dobj1 		; delete object sprite.
0013C9  3               getob0:
0013C9  3  A9 FF        	lda #255
0013CB  3  91 rr        	sta (z80_hl),y 		; pick it up.
0013CD  3  60           	rts
0013CE  3               
0013CE  3               ;-----------------------------------------------------------------
0013CE  3               ; Got object check.
0013CE  3               ; Call with object in accumulator, returns zero set if in pockets.
0013CE  3               ;
0013CE  3               ; Input:
0013CE  3               ;  A = object number
0013CE  3               ;-----------------------------------------------------------------
0013CE  3               
0013CE  3               gotob:
0013CE  3  CD 7D 10     	cmp numob 		; number of objects in game.
0013D1  3  90 03        	bcc :+ 			; are we checking past the end?
0013D3  3  4C DA 13     	jmp gotob0 		; yes, we can't have a non-existent object.
0013D6  3               :
0013D6  3  20 DF 13     	jsr findob		; find the object.
0013D9  3               gotob1:
0013D9  3  60           	rts
0013DA  3               
0013DA  3               gotob0:
0013DA  3  A9 FE        	lda #254 		; missing.
0013DC  3  4C D9 13     	jmp gotob1
0013DF  3               
0013DF  3               findob:
0013DF  3  48           	pha			; save object number
0013E0  3  A9 7F        	lda #<objdta 		; objects.
0013E2  3  85 rr        	sta z80_l
0013E4  3  A9 70        	lda #>objdta
0013E6  3  85 rr        	sta z80_h
0013E8  3  68           	pla			; retreive object number
0013E9  3  F0 0F        	beq fndob1 		; is it zero? yes, skip loop.
0013EB  3  AA           	tax 			; loop counter
0013EC  3               fndob2:
0013EC  3  18           	clc
0013ED  3  A5 rr        	lda z80_l
0013EF  3  69 26        	adc #38 		; size of each object.
0013F1  3  85 rr        	sta z80_l
0013F3  3  90 02        	bcc :+
0013F5  3  E6 rr        	inc z80_h
0013F7  3               :
0013F7  3  CA           	dex 			; repeat until we find address.
0013F8  3  D0 F2        	bne fndob2
0013FA  3               fndob1:
0013FA  3  A0 20        	ldy #32			; distance to room it's in.
0013FC  3  B1 rr        	lda (z80_hl),y		; fetch status.
0013FE  3  60           	rts
0013FF  3               
0013FF  3               ;---------------------------------------------
0013FF  3               ; Drop object number at (dispx, dispy).
0013FF  3               ;
0013FF  3               ; Input:
0013FF  3               ;  A = object number
0013FF  3               ;---------------------------------------------
0013FF  3               
0013FF  3               drpob:
0013FF  3  CD 7D 10     	cmp numob 		; are we checking past the end?
001402  3  90 01        	bcc :+
001404  3  60           	rts			; yes, can't drop non-existent item.
001405  3               :
001405  3  20 CE 13     	jsr gotob		; make sure object is in inventory.
001408  3  C5 rr        	cmp scno		; already on this screen?
00140A  3  D0 01        	bne :+
00140C  3  60           	rts			; yes, nothing to do.
00140D  3               :
00140D  3  A0 20        	ldy #32
00140F  3  A5 rr        	lda scno
001411  3  91 rr        	sta (z80_hl),y		; bring onto screen.
001413  3  A5 rr        	lda dispy		; sprite y coordinate.
001415  3  C8           	iny
001416  3  91 rr        	sta (z80_hl),y		; point to object y.
001418  3  A5 rr        	lda dispx 		; sprite x coordinate.
00141A  3  C8           	iny
00141B  3  91 rr        	sta (z80_hl),y 		; point to object x
00141D  3  4C 7C 13     	jmp dobj		; draw the object sprite.
001420  3               
001420  3               ;-----------------------------------------------
001420  3               ; Seek objects at sprite position.
001420  3               ;
001420  3               ; Output:
001420  3               ;  A = object number, if not found A=255
001420  3               ;-----------------------------------------------
001420  3               
001420  3               skobj:
001420  3  A9 7F        	lda #<objdta 		; pointer to objects.
001422  3  85 rr        	sta z80_l
001424  3  A9 70        	lda #>objdta
001426  3  85 rr        	sta z80_h
001428  3               
001428  3  AD 7D 10     	lda numob 		; number of objects in game.
00142B  3  85 rr        	sta z80_b 		; set up the loop counter.
00142D  3               skobj0:
00142D  3  A5 rr        	lda scno		; current room number.
00142F  3  A0 20        	ldy #32
001431  3  D1 rr        	cmp (z80_hl),y		; is object in here?
001433  3  D0 03        	bne :+
001435  3  20 4A 14     	jsr skobj1		; yes, check coordinates.
001438  3               :
001438  3  18           	clc			; point to next object in table.
001439  3  A5 rr        	lda z80_l
00143B  3  69 26        	adc #38			; size of each object.
00143D  3  85 rr        	sta z80_l
00143F  3  90 02        	bcc :+
001441  3  E6 rr        	inc z80_h
001443  3               :
001443  3  C6 rr        	dec z80_b
001445  3  D0 E6        	bne skobj0		; repeat for all objects.
001447  3               
001447  3  A9 FF        	lda #255		; end of list and nothing found, return 255.
001449  3  60           	rts
00144A  3               
00144A  3               skobj1:
00144A  3  A0 21        	ldy #33			; point to y coordinate.
00144C  3  B1 rr        	lda (z80_hl),y		; point to y coordinate.
00144E  3  38           	sec
00144F  3  A0 08        	ldy #var_newY
001451  3  F1 rr        	sbc (z80_ix),y 		; subtract sprite y.
001453  3  18           	clc
001454  3  69 0F        	adc #15			; add sprite height minus one.
001456  3  C9 1F        	cmp #31			; within range?
001458  3  90 03        	bcc :+
00145A  3  4C 78 14     	jmp skobj2		; no, ignore object.
00145D  3               :
00145D  3  A0 22        	ldy #34			; point to x coordinate now.
00145F  3  B1 rr        	lda (z80_hl),y 		; get coordinate.
001461  3  38           	sec
001462  3  A0 09        	ldy #var_newX
001464  3  F1 rr        	sbc (z80_ix),y 		; subtract the sprite x.
001466  3  18           	clc			; add sprite width minus one.
001467  3  69 0F        	adc #15
001469  3  C9 1F        	cmp #31			; within range?
00146B  3  90 03        	bcc :+
00146D  3  4C 78 14     	jmp skobj2		; no, ignore object.
001470  3               :
001470  3  68           	pla			; remove return address from stack.
001471  3  68           	pla
001472  3               
001472  3  AD 7D 10     	lda numob 		; objects in game.
001475  3  38           	sec
001476  3  E5 rr        	sbc z80_b		; subtract loop counter.
001478  3               skobj2:
001478  3  60           	rts			; accumulator now points to object.
001479  3               
001479  3               
001479  3               ;---------------------------------------------------------------------
001479  3               ; Spawn a new sprite.
001479  3               ;---------------------------------------------------------------------
001479  3               
001479  3               spawn:
001479  3  A9 00        	lda #<sprtab		; sprite table.
00147B  3  85 rr        	sta z80_l
00147D  3  A9 0B        	lda #>sprtab
00147F  3  85 rr        	sta z80_h
001481  3               numsp1:
001481  3  A9 0C        	lda #NUMSPR		; number of sprites.
001483  3  85 rr        	sta spcnt
001485  3               spaw0:
001485  3  A0 00        	ldy #var_Type
001487  3  B1 rr        	lda (z80_hl),y		; get sprite type.
001489  3  C9 FF        	cmp #255		; is it an unused slot?
00148B  3  F0 0F        	beq spaw1 		; yes, we can use this one.
00148D  3               
00148D  3  18           	clc 			; point to next sprite in table.
00148E  3  A5 rr        	lda z80_l
001490  3  69 11        	adc #TABSIZ		; size of each entry.
001492  3  85 rr        	sta z80_l
001494  3  90 02        	bcc :+
001496  3  E6 rr        	inc z80_h
001498  3               :
001498  3  C6 rr        	dec spcnt		; one less iteration.
00149A  3  D0 E9        	bne spaw0		; keep going until we find a slot.
00149C  3               
00149C  3               ; Didn't find one but drop through and set up a dummy sprite instead.
00149C  3               
00149C  3               spaw1:
00149C  3  A5 rr        	lda z80_i		; address of original sprite.
00149E  3  48           	pha
00149F  3  A5 rr        	lda z80_x
0014A1  3  48           	pha
0014A2  3               
0014A2  3  A5 rr        	lda z80_l		; store spawned sprite address.
0014A4  3  85 rr        	sta spptr
0014A6  3  A5 rr        	lda z80_h
0014A8  3  85 rr        	sta spptr+1
0014AA  3               
0014AA  3  A5 rr        	lda z80_c
0014AC  3  A0 00        	ldy #var_Type
0014AE  3  91 rr        	sta (z80_hl),y 		; set the type.
0014B0  3  A0 05        	ldy #var_newType
0014B2  3  91 rr        	sta (z80_hl),y		; copy
0014B4  3               
0014B4  3  A5 rr        	lda z80_b
0014B6  3  A0 01        	ldy #var_Image
0014B8  3  91 rr        	sta (z80_hl),y		; set the image.
0014BA  3  A0 06        	ldy #var_newImage
0014BC  3  91 rr        	sta (z80_hl),y		; copy
0014BE  3               
0014BE  3  A9 00        	lda #0 				; frame zero.
0014C0  3  A0 02        	ldy #var_Frame
0014C2  3  91 rr        	sta (z80_hl),y		; set frame.
0014C4  3  A0 07        	ldy #var_newFrame
0014C6  3  91 rr        	sta (z80_hl),y		; copy
0014C8  3               
0014C8  3  A0 09        	ldy #9
0014CA  3  B1 rr        	lda (z80_ix),y 		; x coordinate.
0014CC  3  A0 04        	ldy #var_X
0014CE  3  91 rr        	sta (z80_hl),y		; set sprite coordinate.
0014D0  3  A0 09        	ldy #var_newX
0014D2  3  91 rr        	sta (z80_hl),y		; copy
0014D4  3               
0014D4  3  A0 08        	ldy #8
0014D6  3  B1 rr        	lda (z80_ix),y 		; y coordinate.
0014D8  3  A0 03        	ldy #var_Y
0014DA  3  91 rr        	sta (z80_hl),y		; set sprite coordinate.
0014DC  3  A0 08        	ldy #var_newY
0014DE  3  91 rr        	sta (z80_hl),y		; copy
0014E0  3               
0014E0  3  A0 0A        	ldy #10				; direction of original.
0014E2  3  B1 rr        	lda (z80_ix),y
0014E4  3  A0 0A        	ldy #var_Direction
0014E6  3  91 rr        	sta (z80_hl),y		; direction
0014E8  3               
0014E8  3  A9 00        	lda #0
0014EA  3  A0 0D        	ldy #var_jumpLo
0014EC  3  91 rr        	sta (z80_hl),y		; reset parameter.
0014EE  3  C8           	iny
0014EF  3  91 rr        	sta (z80_hl),y		; reset parameter.
0014F1  3  C8           	iny
0014F2  3  91 rr        	sta (z80_hl),y		; reset parameter.
0014F4  3  C8           	iny
0014F5  3  91 rr        	sta (z80_hl),y		; reset parameter.
0014F7  3               rtssp:
0014F7  3  A5 rr        	lda spptr			; address of new sprite.
0014F9  3  85 rr        	sta z80_x
0014FB  3  A5 rr        	lda spptr+1
0014FD  3  85 rr        	sta z80_i
0014FF  3               evis1:
0014FF  3  20 61 45     	jsr evnt09 			; call sprite initialisation event.
001502  3               
001502  3  A5 rr        	lda spptr 			; address of new sprite.
001504  3  85 rr        	sta z80_x
001506  3  A5 rr        	lda spptr+1
001508  3  85 rr        	sta z80_i
00150A  3               
00150A  3               	; _BEEB clipping code copied from CPC Engine - MISSING?!
00150A  3  A0 03        	ldy #var_Y
00150C  3  B1 rr        	lda (z80_hl), y		; old x coord
00150E  3  C9 B1        	cmp #SpriteMaxY     ; beyond maximum?
001510  3  B0 03        	bcs :+				; yes, don't draw it.
001512  3               
001512  3  20 8F 0F     	jsr sspria 			; display the new sprite.
001515  3               :
001515  3  68           	pla					; address of original sprite.
001516  3  85 rr        	sta z80_x
001518  3  68           	pla
001519  3  85 rr        	sta z80_i
00151B  3               
00151B  3  60           	rts
00151C  3               
00151C  3  30 30 30 30  score:	.byte "000000"		; player"s score.
001520  3  30 30        
001522  3  30 30 30 30  hiscor:	.byte "000000"		; high score.
001526  3  30 30        
001528  3  30 30 30 30  bonus:	.byte "000000"		; bonus.
00152C  3  30 30        
00152E  3  00 68        grbase:	.word ScreenAddr	; graphics base address.
001530  3               
001530  3               ;----------------------------------------------------
001530  3               ; Check y-pos
001530  3               ;----------------------------------------------------
001530  3               
001530  3               checkx:
001530  3  A5 rr        	lda dispy		; y position.
001532  3  C9 18        	cmp #24			; off screen?
001534  3  B0 01        	bcs :+
001536  3  60           	rts			; no, it's okay.
001537  3               :
001537  3  68           	pla			; remove return address from stack.
001538  3  85 rr        	sta z80_l
00153A  3  68           	pla
00153B  3  85 rr        	sta z80_h
00153D  3  60           	rts
00153E  3               
00153E  3               ;-----------------------------------------------
00153E  3               ; Displays the current high score.
00153E  3               ;-----------------------------------------------
00153E  3               
00153E  3               dhisc:
00153E  3  A9 22        	lda #<hiscor 		; high score text.
001540  3  85 rr        	sta z80_l
001542  3  A9 15        	lda #>hiscor
001544  3  85 rr        	sta z80_h
001546  3  4C 51 15     	jmp dscor1		; check in printable range then show 6 digits.
001549  3               
001549  3               ;------------------------------------------------------
001549  3               ; Displays the current score.
001549  3               ;------------------------------------------------------
001549  3               
001549  3               dscor:
001549  3  A9 1C        	lda #<score		; score text.
00154B  3  85 rr        	sta z80_l
00154D  3  A9 15        	lda #>score
00154F  3  85 rr        	sta z80_h
001551  3               dscor1:
001551  3  20 F9 1B     	jsr preprt		; set up font and print position.
001554  3  20 30 15     	jsr checkx		; make sure we're in a printable range.
001557  3               
001557  3  A9 06        	lda #6			; digits to display.
001559  3  85 rr        	sta z80_b
00155B  3  A5 rr        	lda prtmod		; get print mode.
00155D  3  F0 03        	beq :+			; standard size text?
00155F  3  4C 7E 15     	jmp bscor0		; no, show double-height.
001562  3               :
001562  3               dscor0:
001562  3  A0 00        	ldy #0
001564  3  B1 rr        	lda (z80_hl),y 		; fetch character.
001566  3  20 2C 10     	jsr pchar 		; display character.
001569  3  E6 rr        	inc dispx		; move along x coordinate
00156B  3               
00156B  3  E6 rr        	inc z80_l		; next score column.
00156D  3  D0 02        	bne :+
00156F  3  E6 rr        	inc z80_h
001571  3               :
001571  3  C6 rr        	dec z80_b
001573  3  D0 ED        	bne dscor0 		; repeat for all digits.
001575  3               dscor2:
001575  3  A5 rr        	lda dispx 		; set up display coordinates.
001577  3  85 rr        	sta charx
001579  3  A5 rr        	lda dispy
00157B  3  85 rr        	sta chary
00157D  3  60           	rts
00157E  3               
00157E  3               ;------------------------------------------------------
00157E  3               ; Displays the current score in double-height characters.
00157E  3               ;
00157E  3               ; Input:
00157E  3               ;  B  = digit number
00157E  3               ;  HL = score string
00157E  3               ;------------------------------------------------------
00157E  3               
00157E  3               bscor0:
00157E  3  A0 00        	ldy #0
001580  3               
001580  3  B1 rr        	lda (z80_hl),y 		; fetch character.
001582  3  20 7C 1B     	jsr bchar 		; display big char.
001585  3               
001585  3  E6 rr        	inc z80_l 		; next score column.
001587  3  D0 02        	bne :+
001589  3  E6 rr        	inc z80_h
00158B  3               :
00158B  3  C6 rr        	dec z80_b
00158D  3  F0 03        	beq :+
00158F  3  4C 7E 15     	jmp bscor0 		; repeat for all digits.
001592  3               :
001592  3  4C 75 15     	jmp dscor2 		; tidy up line and column variables.
001595  3               
001595  3               ;-----------------------------------------------------
001595  3               ; Adds number in the hl pair to the score.
001595  3               ;-----------------------------------------------------
001595  3               
001595  3               addsc:
001595  3  A9 1D        	lda #<(score+1) 	; ten thousands column.
001597  3  85 rr        	sta z80_e
001599  3  A9 15        	lda #>(score+1)
00159B  3  85 rr        	sta z80_d
00159D  3  A9 10        	lda #<10000		; amount to add each time.
00159F  3  85 rr        	sta z80_c
0015A1  3  A9 27        	lda #>10000
0015A3  3  85 rr        	sta z80_b
0015A5  3  20 E9 15     	jsr incsc		; add to score.
0015A8  3               
0015A8  3  E6 rr        	inc z80_e		; thousands column.
0015AA  3  D0 02        	bne :+
0015AC  3  E6 rr        	inc z80_d
0015AE  3               :
0015AE  3  A9 E8        	lda #<1000		; amount to add each time.
0015B0  3  85 rr        	sta z80_c
0015B2  3  A9 03        	lda #>1000
0015B4  3  85 rr        	sta z80_b
0015B6  3  20 E9 15     	jsr incsc 		; add to score.
0015B9  3               
0015B9  3  E6 rr        	inc z80_e		; hundreds column.
0015BB  3  D0 02        	bne :+
0015BD  3  E6 rr        	inc z80_d
0015BF  3               :
0015BF  3  A9 64        	lda #<100		; amount to add each time.
0015C1  3  85 rr        	sta z80_c
0015C3  3  A9 00        	lda #>100
0015C5  3  85 rr        	sta z80_b
0015C7  3  20 E9 15     	jsr incsc		; add to score.
0015CA  3               
0015CA  3  E6 rr        	inc z80_e 		; tens column.
0015CC  3  D0 02        	bne :+
0015CE  3  E6 rr        	inc z80_d
0015D0  3               :
0015D0  3  A9 0A        	lda #<10		; amount to add each time.
0015D2  3  85 rr        	sta z80_c
0015D4  3  A9 00        	lda #>10
0015D6  3  85 rr        	sta z80_b
0015D8  3  20 E9 15     	jsr incsc 		; add to score.
0015DB  3               
0015DB  3  E6 rr        	inc z80_e		; units column.
0015DD  3  D0 02        	bne :+
0015DF  3  E6 rr        	inc z80_d
0015E1  3               :
0015E1  3  A9 01        	lda #<1			; units.
0015E3  3  85 rr        	sta z80_c
0015E5  3  A9 00        	lda #>1
0015E7  3  85 rr        	sta z80_b
0015E9  3               incsc:
0015E9  3  A5 rr        	lda z80_h		; store amount to add.
0015EB  3  48           	pha
0015EC  3  A5 rr        	lda z80_l
0015EE  3  48           	pha
0015EF  3               
0015EF  3  38           	sec			; subtract from amount to add.
0015F0  3  A5 rr        	lda z80_l
0015F2  3  E5 rr        	sbc z80_c
0015F4  3  85 rr        	sta z80_l
0015F6  3  A5 rr        	lda z80_h
0015F8  3  E5 rr        	sbc z80_b
0015FA  3  85 rr        	sta z80_h
0015FC  3  90 14        	bcc incsc0		; too much, restore value.
0015FE  3               
0015FE  3  68           	pla			; delete the previous amount from the stack.
0015FF  3  68           	pla
001600  3               
001600  3  A5 rr        	lda z80_d 		; store column position.
001602  3  48           	pha
001603  3  A5 rr        	lda z80_e
001605  3  48           	pha
001606  3  20 19 16     	jsr incsc2		; do the increment.
001609  3               
001609  3  68           	pla			; restore column.
00160A  3  85 rr        	sta z80_e
00160C  3  68           	pla
00160D  3  85 rr        	sta z80_d
00160F  3  4C E9 15     	jmp incsc		; repeat until all added.
001612  3               
001612  3               incsc0:
001612  3  68           	pla			; restore previous value.
001613  3  85 rr        	sta z80_l
001615  3  68           	pla
001616  3  85 rr        	sta z80_h
001618  3  60           	rts
001619  3               incsc2:
001619  3  A0 00        	ldy #0
00161B  3  B1 rr        	lda (z80_de),y 		; get amount.
00161D  3  18           	clc
00161E  3  69 01        	adc #1			; add one to column.
001620  3  91 rr        	sta (z80_de),y		; write new column total.
001622  3  C9 3A        	cmp #'9'+1		; gone beyond range of digits?
001624  3  B0 01        	bcs :+
001626  3  60           	rts			; no, carry on.
001627  3               :
001627  3  A9 30        	lda #'0'		; make it zero.
001629  3  91 rr        	sta (z80_de),y		; write new column total.
00162B  3  C6 rr        	dec z80_e		; back one column.
00162D  3  D0 02        	bne :+
00162F  3  C6 rr        	dec z80_d
001631  3               :
001631  3  4C 19 16     	jmp incsc2
001634  3               
001634  3               ;------------------------------------
001634  3               ; Add bonus to score and reset bonus
001634  3               ;------------------------------------
001634  3               
001634  3               addbo:
001634  3  A2 05        	ldx #5			; last digit.
001636  3  18           	clc			; clear carry.
001637  3               addbo0:
001637  3  BD 1C 15     	lda score,x		; get score.
00163A  3  7D 28 15     	adc bonus,x		; add bonus.
00163D  3  38           	sec			; 0 to 18.
00163E  3  E9 30        	sbc #48
001640  3  48           	pha
001641  3  A9 30        	lda #'0'
001643  3  9D 28 15     	sta bonus,x		; zeroise bonus.
001646  3  68           	pla
001647  3  C9 3A        	cmp #58			; carried?
001649  3  B0 07        	bcs addbo2		; no, do next one.
00164B  3  38           	sec
00164C  3  E9 0A        	sbc #10			; subtract 10.
00164E  3  38           	sec
00164F  3  4C 53 16     	jmp addbo1
001652  3               addbo2:
001652  3  18           	clc
001653  3               addbo1:
001653  3  9D 1C 15     	sta score,x		; write new score.
001656  3  CA           	dex			; next digit.
001657  3  10 DE        	bpl addbo0		; repeat for all 6 digits.
001659  3  60           	rts
00165A  3               
00165A  3               ;------------------------------------
00165A  3               ; Swap score and bonus.
00165A  3               ;------------------------------------
00165A  3               
00165A  3               swpsb:
00165A  3  A2 05        	ldx #5			; digits to add.
00165C  3               swpsb0:
00165C  3  BD 1C 15     	lda score,x 		; get score digits.
00165F  3  48           	pha			; save digit
001660  3  BD 28 15     	lda bonus,x 		; get bonus digits.
001663  3  9D 1C 15     	sta score,x		; switch score-bonus
001666  3  68           	pla
001667  3  9D 28 15     	sta bonus,x
00166A  3  CA           	dex 			; repeat for all 6 digits.
00166B  3  10 EF        	bpl swpsb0
00166D  3  60           	rts
00166E  3               
00166E  3               ;----------------------------------------------------
00166E  3               ; Get print address.
00166E  3               ;----------------------------------------------------
00166E  3               
00166E  3               gprad:
00166E  3  98           	tya
00166F  3  48           	pha
001670  3               
001670  3  A5 rr        	lda dispx 		; x coordinate.
001672  3  85 rr        	sta scraddr
001674  3  A9 00        	lda #0
001676  3  85 rr        	sta scraddr+1
001678  3  06 rr        	asl scraddr  	; multiply char by 8
00167A  3  26 rr        	rol scraddr+1
00167C  3  06 rr        	asl scraddr
00167E  3  26 rr        	rol scraddr+1
001680  3  06 rr        	asl scraddr
001682  3  26 rr        	rol scraddr+1
001684  3               
001684  3  A5 rr        	lda dispy		; y coordinate.
001686  3  0A           	asl a
001687  3  0A           	asl a
001688  3  0A           	asl a			; multiply char by 8
001689  3  A8           	tay
00168A  3               
00168A  3  18           	clc
00168B  3  A5 rr        	lda scraddr
00168D  3  79 00 06     	adc SCADTB_lb,y
001690  3  85 rr        	sta scraddr
001692  3  A5 rr        	lda scraddr+1
001694  3  79 00 07     	adc SCADTB_hb,y
001697  3  85 rr        	sta scraddr+1
001699  3               
001699  3  68           	pla
00169A  3  A8           	tay
00169B  3  60           	rts
00169C  3               
00169C  3               ;--------------------------------------------------------------
00169C  3               ; Get property buffer address of char at (dispx, dispy) in hl.
00169C  3               ;
00169C  3               ; Output:
00169C  3               ;  bufaddr = MAP + dispy*32 + dispx
00169C  3               ;--------------------------------------------------------------
00169C  3               
00169C  3               pradd:
00169C  3  A5 rr        	lda dispy 		; y coordinate.
00169E  3  85 rr        	sta bufaddr
0016A0  3  A9 00        	lda #0
0016A2  3  85 rr        	sta bufaddr+1
0016A4  3  06 rr        	asl bufaddr  		; multiply char by 32
0016A6  3  26 rr        	rol bufaddr+1
0016A8  3  06 rr        	asl bufaddr
0016AA  3  26 rr        	rol bufaddr+1
0016AC  3  06 rr        	asl bufaddr
0016AE  3  26 rr        	rol bufaddr+1
0016B0  3  06 rr        	asl bufaddr
0016B2  3  26 rr        	rol bufaddr+1
0016B4  3  06 rr        	asl bufaddr
0016B6  3  26 rr        	rol bufaddr+1
0016B8  3  18           	clc			; add address of MAP graphics.
0016B9  3  A5 rr        	lda bufaddr
0016BB  3  65 rr        	adc dispx
0016BD  3  69 00        	adc #<MAP
0016BF  3  85 rr        	sta bufaddr
0016C1  3  A5 rr        	lda bufaddr+1
0016C3  3  69 03        	adc #>MAP
0016C5  3  85 rr        	sta bufaddr+1
0016C7  3  60           	rts
0016C8  3               
0016C8  3               ;----------------------------------------------
0016C8  3               ; Print attributes, properties and pixels.
0016C8  3               ;
0016C8  3               ; Input:
0016C8  3               ;  A	= tile number
0016C8  3               ;----------------------------------------------
0016C8  3               
0016C8  3  00           colpatt:	.byte 0
0016C9  3               
0016C9  3               pattr:
0016C9  3  85 rr        	sta z80_b		; store cell in b register for now.
0016CB  3  AA           	tax
0016CC  3  BD 9E 4F     	lda bprop,x 		; block properties.
0016CF  3  85 rr        	sta z80_c
0016D1  3  C9 08        	cmp #COLECT
0016D3  3  D0 05        	bne :+
0016D5  3  A5 rr        	lda z80_b
0016D7  3  8D C8 16     	sta colpatt
0016DA  3               :
0016DA  3  20 9C 16     	jsr pradd 		; get property buffer address.
0016DD  3  A5 rr        	lda z80_c
0016DF  3  A0 00        	ldy #0
0016E1  3  91 rr        	sta (bufaddr),y 	; write property.
0016E3  3  A5 rr        	lda z80_b 		; restore cell.
0016E5  3               
0016E5  3               ; Print attributes, no properties.
0016E5  3               
0016E5  3               panp:
0016E5  3  85 rr        	sta z80_e		; displacement in e.
0016E7  3  A9 00        	lda #0
0016E9  3  85 rr        	sta z80_d		; no high byte.
0016EB  3  06 rr        	asl z80_e  		; multiply char by 8.
0016ED  3  26 rr        	rol z80_d
0016EF  3  06 rr        	asl z80_e
0016F1  3  26 rr        	rol z80_d
0016F3  3  06 rr        	asl z80_e
0016F5  3  26 rr        	rol z80_d
0016F7  3  18           	clc
0016F8  3  A5 rr        	lda z80_e
0016FA  3  69 CE        	adc #<chgfx 		; address of graphics.
0016FC  3  85 rr        	sta tileaddr
0016FE  3  A5 rr        	lda z80_d
001700  3  69 4C        	adc #>chgfx
001702  3  85 rr        	sta tileaddr+1
001704  3  20 6E 16     	jsr gprad 		; get screen address.
001707  3  A2 07        	ldx #7			; number of pixel rows to write.
001709  3               panp0:
001709  3  A0 00        	ldy #0
00170B  3  B1 rr        	lda (tileaddr),y 	; get image byte.
00170D  3  49 00        	eor #TxtInvert		; Invert
00170F  3  BC 65 10     	ldy scrtab,x
001712  3  91 rr        	sta (scraddr),y 	; copy to screen.
001714  3  E6 rr        	inc tileaddr 		; next image byte.
001716  3  D0 02        	bne :+
001718  3  E6 rr        	inc tileaddr+1
00171A  3               :
00171A  3  CA           	dex	 		; repeat for 8 pixel rows.
00171B  3  10 EC        	bpl panp0
00171D  3  E6 rr        	inc dispx 		; move along one.
00171F  3  E6 rr        	inc charx
001721  3  60           	rts
001722  3               
001722  3               ;----------------------------------------------
001722  3               ; Print character pixels, no more.
001722  3               ;
001722  3               ; Input:
001722  3               ;  A	= character to print
001722  3               ;----------------------------------------------
001722  3               
001722  3               pchr:
001722  3  20 2C 10     	jsr pchar 		; show character in accumulator.
001725  3  E6 rr        	inc dispx		; move along one.
001727  3  60           	rts
001728  3               
001728  3               ;----------------------------------------------------
001728  3               ; Shifter sprite routine for objects.
001728  3               ;----------------------------------------------------
001728  3               
001728  3               sprit7:
001728  3  A5 rr        	lda z80_b
00172A  3  F0 0F        	beq sprit0
00172C  3  85 rr        	sta z80_a
00172E  3               sprit3:
00172E  3  4E 78 0F     	lsr spr			; shift into position.
001731  3  6E 79 0F     	ror spr+1
001734  3  6E 7A 0F     	ror spr+2
001737  3  C6 rr        	dec z80_a		; one less iteration.
001739  3  D0 F3        	bne sprit3
00173B  3               sprit0:
00173B  3  60           	rts 			; now apply to screen.
00173C  3               
00173C  3               ;-----------------------------------------------------------
00173C  3               ; Get room address.
00173C  3               ;-----------------------------------------------------------
00173C  3               
00173C  3               groom:
00173C  3  A6 rr        	ldx scno 		; screen number.
00173E  3  A0 00        	ldy #0
001740  3               groomx:
001740  3  A9 A2        	lda #<scdat 		; pointer to screens.
001742  3  85 rr        	sta z80_l
001744  3  A9 6B        	lda #>scdat
001746  3  85 rr        	sta z80_h
001748  3               groom1:
001748  3  E0 00        	cpx #0			; is it the first one?
00174A  3  F0 15        	beq groom0 		; no more screens to skip.
00174C  3               
00174C  3  18           	clc
00174D  3  A5 rr        	lda z80_l
00174F  3  79 A2 6B     	adc scdat,y 		; low byte of screen size.
001752  3  85 rr        	sta z80_l
001754  3  C8           	iny			; point to high byte.
001755  3  A5 rr        	lda z80_h
001757  3  79 A2 6B     	adc scdat,y 		; high byte of screen size.
00175A  3  85 rr        	sta z80_h
00175C  3  C8           	iny			; next address.
00175D  3               
00175D  3  CA           	dex 			; one less iteration.
00175E  3  4C 48 17     	jmp groom1 		; loop until we reach the end.
001761  3               groom0:
001761  3  AD 1B 70     	lda numsc 		; add displacement.
001764  3  0A           	asl a
001765  3  18           	clc			; add double displacement to address.
001766  3  65 rr        	adc z80_l
001768  3  85 rr        	sta z80_l
00176A  3  A5 rr        	lda z80_h
00176C  3  69 00        	adc #0
00176E  3  85 rr        	sta z80_h
001770  3  60           	rts
001771  3               
001771  3               ;-----------------------------------------------------------
001771  3               ; Draw present room.
001771  3               ;-----------------------------------------------------------
001771  3               
001771  3               droom:
001771  3  AD 79 10     	lda wintop 		; window top.
001774  3  85 rr        	sta dispy		; set cursor y position.
001776  3               droom2:
001776  3  20 3C 17     	jsr groom 		; get address of current room.
001779  3  A9 00        	lda #0	 		; zero in accumulator.
00177B  3  85 rr        	sta comcnt 		; reset compression counter.
00177D  3  AD 7B 10     	lda winhgt 		; height of window.
001780  3  85 rr        	sta rrow		; set row counter
001782  3               droom0:
001782  3  AD 7A 10     	lda winlft 		; window left edge.
001785  3  85 rr        	sta dispx 		; set cursor x position.
001787  3  AD 7C 10     	lda winwid 		; width of window.
00178A  3  85 rr        	sta rcol		; set column counter
00178C  3               droom1:
00178C  3  20 9D 17     	jsr flbyt 		; decompress next byte on the fly.
00178F  3  20 C9 16     	jsr pattr 		; show attributes and block.
001792  3  C6 rr        	dec rcol		; one less column.
001794  3  D0 F6        	bne droom1 		; repeat for entire line.
001796  3  E6 rr        	inc dispy		; move down one line.
001798  3  C6 rr        	dec rrow 		; one less row.
00179A  3  D0 E6        	bne droom0 		; repeat for all rows.
00179C  3  60           	rts
00179D  3               
00179D  3               ;----------------------------------------------
00179D  3               ; Decompress bytes on-the-fly.
00179D  3               ;----------------------------------------------
00179D  3               
00179D  3               flbyt:
00179D  3  A5 rr        	lda comcnt 		; compression counter.
00179F  3  D0 21        	bne flbyt1		; any more to decompress?  yes.
0017A1  3               
0017A1  3  A0 00        	ldy #0
0017A3  3  B1 rr        	lda (z80_hl),y 		; fetch next byte.
0017A5  3  E6 rr        	inc z80_l 		; point to next cell.
0017A7  3  D0 02        	bne :+
0017A9  3  E6 rr        	inc z80_h
0017AB  3               :
0017AB  3  C9 FF        	cmp #255 		; is this byte a control code?
0017AD  3  F0 01        	beq :+
0017AF  3  60           	rts 			; no, this byte is uncompressed.
0017B0  3               :
0017B0  3  B1 rr        	lda (z80_hl),y 		; fetch byte type.
0017B2  3  85 rr        	sta combyt 		; set up the type.
0017B4  3  E6 rr        	inc z80_l 		; point to quantity.
0017B6  3  D0 02        	bne :+
0017B8  3  E6 rr        	inc z80_h
0017BA  3               :
0017BA  3  B1 rr        	lda (z80_hl),y 		; get quantity.
0017BC  3  E6 rr        	inc z80_l 		; point to next byte.
0017BE  3  D0 02        	bne :+
0017C0  3  E6 rr        	inc z80_h
0017C2  3               :
0017C2  3               flbyt1:
0017C2  3  85 rr        	sta comcnt 		; store new quantity.
0017C4  3  C6 rr        	dec comcnt		; one less.
0017C6  3  A5 rr        	lda combyt 		; byte to expand.
0017C8  3  60           	rts
0017C9  3               
0017C9  3               ;------------------------------------------
0017C9  3               ; Ladder down check.
0017C9  3               ;
0017C9  3               ; Input:
0017C9  3               ;  IX = sprite pointer
0017C9  3               ;------------------------------------------
0017C9  3               
0017C9  3               laddd:
0017C9  3  A0 09        	ldy #9
0017CB  3  B1 rr        	lda (z80_ix),y		; x coordinate.
0017CD  3  85 rr        	sta dispx
0017CF  3               
0017CF  3  A0 08        	ldy #8
0017D1  3  B1 rr        	lda (z80_ix),y		; y coordinate.
0017D3  3  29 FE        	and #254		; make it even.
0017D5  3  91 rr        	sta (z80_ix),y 		; reset it.
0017D7  3               numsp5:
0017D7  3  18           	clc 			; look down 16 pixels.
0017D8  3  69 10        	adc #16
0017DA  3  85 rr        	sta dispy		; coords in dispx,dispy.
0017DC  3  4C F2 17     	jmp laddv
0017DF  3               
0017DF  3               ;------------------------------------------
0017DF  3               ; Ladder up check.
0017DF  3               ;
0017DF  3               ; Input:
0017DF  3               ;  IX = sprite pointer
0017DF  3               ;
0017DF  3               ; Output:
0017DF  3               ;  A  = 0 is ok, A <>0 is not ok
0017DF  3               ;------------------------------------------
0017DF  3               
0017DF  3               laddu:
0017DF  3  A0 09        	ldy #9
0017E1  3  B1 rr        	lda (z80_ix),y		; x coordinate.
0017E3  3  85 rr        	sta dispx
0017E5  3               
0017E5  3  A0 08        	ldy #8
0017E7  3  B1 rr        	lda (z80_ix),y		; y coordinate.
0017E9  3  29 FE        	and #254 		; make it even.
0017EB  3  91 rr        	sta (z80_ix),y		; reset it.
0017ED  3               numsp6:
0017ED  3  18           	clc 			; look 2 pixels above feet.
0017EE  3  69 0E        	adc #14
0017F0  3  85 rr        	sta dispy		; coords in dispx,dispy.
0017F2  3               laddv:
0017F2  3  20 40 1A     	jsr tstbl 		; get map address.
0017F5  3  20 FF 18     	jsr ldchk 		; standard ladder check.
0017F8  3  F0 01        	beq :+
0017FA  3  60           	rts 			; no way through.
0017FB  3               :
0017FB  3  E6 rr        	inc bufaddr 		; look right one cell.
0017FD  3  D0 02        	bne :+
0017FF  3  E6 rr        	inc bufaddr+1
001801  3               :
001801  3  20 FF 18     	jsr ldchk 		; do the check.
001804  3  F0 01        	beq :+
001806  3  60           	rts 			; impassable.
001807  3               :
001807  3  A5 rr        	lda dispx 		; y coordinate.
001809  3  29 07        	and #7 			; position straddling block cells.
00180B  3  D0 01        	bne :+
00180D  3  60           	rts 			; no more checks needed.
00180E  3               :
00180E  3  E6 rr        	inc bufaddr 		; look to third cell.
001810  3  D0 02        	bne :+
001812  3  E6 rr        	inc bufaddr+1
001814  3               :
001814  3  20 FF 18     	jsr ldchk 		; do the check.
001817  3  60           	rts  			; return with zero flag set accordingly.
001818  3               
001818  3               ;---------------------------------------------------------
001818  3               ; Can go up check.
001818  3               ;
001818  3               ; Input:
001818  3               ;  IX = sprite pointer
001818  3               ;
001818  3               ; Output:
001818  3               ;  A  = 0 is ok, A <>0 is not ok
001818  3               ;---------------------------------------------------------
001818  3               
001818  3               cangu:
001818  3  A0 09        	ldy #9
00181A  3  B1 rr        	lda (z80_ix),y		; x coordinate.
00181C  3  85 rr        	sta dispx
00181E  3  A0 08        	ldy #8
001820  3  B1 rr        	lda (z80_ix),y 		; y coordinate.
001822  3  38           	sec
001823  3  E9 02        	sbc #2
001825  3  85 rr        	sta dispy		; coords in dispx,dispy.
001827  3  20 40 1A     	jsr tstbl 		; get map address.
00182A  3  20 CA 18     	jsr lrchk 		; standard left/right check.
00182D  3  F0 01        	beq :+
00182F  3  60           	rts			; no way through.
001830  3               :
001830  3  E6 rr        	inc bufaddr		; look right one cell.
001832  3  D0 02        	bne :+
001834  3  E6 rr        	inc bufaddr+1
001836  3               :
001836  3  20 CA 18     	jsr lrchk 		; do the check.
001839  3  F0 01        	beq :+
00183B  3  60           	rts			; impassable.
00183C  3               :
00183C  3  A5 rr        	lda dispx		; x coordinate.
00183E  3  29 07        	and #7			; position straddling block cells.
001840  3  D0 01        	bne :+
001842  3  60           	rts			; no more checks needed.
001843  3               :
001843  3  E6 rr        	inc bufaddr		; look to third cell.
001845  3  D0 02        	bne :+
001847  3  E6 rr        	inc bufaddr+1
001849  3               :
001849  3  20 CA 18     	jsr lrchk		; do the check.
00184C  3  60           	rts 			; return with zero flag set accordingly.
00184D  3               
00184D  3               ;---------------------------------------------------------
00184D  3               ; Can go down check.
00184D  3               ;
00184D  3               ; Input:
00184D  3               ;  IX = sprite pointer
00184D  3               ;
00184D  3               ; Output:
00184D  3               ;  A  = 0 is ok, A <>0 is not ok
00184D  3               ;---------------------------------------------------------
00184D  3               
00184D  3               cangd:
00184D  3  A0 09        	ldy #9
00184F  3  B1 rr        	lda (z80_ix),y 		; x coordinate.
001851  3  85 rr        	sta dispx
001853  3  A0 08        	ldy #8
001855  3  B1 rr        	lda (z80_ix),y		; y coordinate.
001857  3               numsp3:
001857  3  18           	clc
001858  3  69 10        	adc #16 		; look down 16 pixels.
00185A  3  85 rr        	sta dispy		; coords in dispx,dispy.
00185C  3  20 40 1A     	jsr tstbl 		; get map address.
00185F  3  20 DF 18     	jsr plchk 		; block, platform check.
001862  3  F0 01        	beq :+
001864  3  60           	rts			; no way through.
001865  3               :
001865  3  E6 rr        	inc bufaddr		; look right one cell.
001867  3  D0 02        	bne :+
001869  3  E6 rr        	inc bufaddr+1
00186B  3               :
00186B  3  20 DF 18     	jsr plchk		; block, platform check.
00186E  3  F0 01        	beq :+
001870  3  60           	rts			; impassable.
001871  3               :
001871  3  A5 rr        	lda dispx		; x coordinate.
001873  3  29 07        	and #7			; position straddling block cells.
001875  3  D0 01        	bne :+
001877  3  60           	rts			; no more checks needed.
001878  3               :
001878  3  E6 rr        	inc bufaddr		; look to third cell.
00187A  3  D0 02        	bne :+
00187C  3  E6 rr        	inc bufaddr+1
00187E  3               :
00187E  3  20 DF 18     	jsr plchk		; block, platform check.
001881  3  60           	rts			; return with zero flag set accordingly.
001882  3               
001882  3               ;---------------------------------------------------------
001882  3               ; Can go left check.
001882  3               ;
001882  3               ; Input:
001882  3               ;  IX = sprite pointer
001882  3               ;
001882  3               ; Output:
001882  3               ;  A  = 0 is ok, A <>0 is not ok
001882  3               ;---------------------------------------------------------
001882  3               
001882  3               cangl:
001882  3  A0 08        	ldy #8
001884  3  B1 rr        	lda (z80_ix),y 		; y coordinate.
001886  3  85 rr        	sta dispy
001888  3  A0 09        	ldy #9
00188A  3  B1 rr        	lda (z80_ix),y 		; x coordinate.
00188C  3  38           	sec
00188D  3  E9 02        	sbc #2			; look left 2 pixels.
00188F  3  85 rr        	sta dispx		; coords in dispx,dispy.
001891  3  4C A3 18     	jmp cangh		; test if we can go there.
001894  3               
001894  3               ;---------------------------------------------------------
001894  3               ; Can go right check.
001894  3               ;
001894  3               ; Input:
001894  3               ;  IX = sprite pointer
001894  3               ;
001894  3               ; Output:
001894  3               ;  A  = 0 is ok, A <>0 is not ok
001894  3               ;---------------------------------------------------------
001894  3               
001894  3               cangr:
001894  3  A0 08        	ldy #8
001896  3  B1 rr        	lda (z80_ix),y		; y coordinate.
001898  3  85 rr        	sta dispy
00189A  3  A0 09        	ldy #9
00189C  3  B1 rr        	lda (z80_ix),y		; x coordinate.
00189E  3  18           	clc
00189F  3  69 10        	adc #16			; look right 16 pixels.
0018A1  3  85 rr        	sta dispx		; coords in dispx,dispy.
0018A3  3               cangh:
0018A3  3               cangh2:
0018A3  3  A9 03        	lda #3			; default rows to write.
0018A5  3  85 rr        	sta z80_b
0018A7  3  A5 rr        	lda dispy		; y position.
0018A9  3  29 07        	and #7			; does x straddle cells?
0018AB  3  D0 02        	bne cangh0		; yes, loop counter is good.
0018AD  3  C6 rr        	dec z80_b		; one less row to write.
0018AF  3               cangh0:
0018AF  3  20 40 1A     	jsr tstbl		; get map address.
0018B2  3               cangh1:
0018B2  3  20 CA 18     	jsr lrchk		; standard left/right check.
0018B5  3  F0 01        	beq :+
0018B7  3  60           	rts			; no way through.
0018B8  3               :
0018B8  3  48           	pha
0018B9  3  18           	clc
0018BA  3  A5 rr        	lda bufaddr
0018BC  3  69 20        	adc #32			; look down.
0018BE  3  85 rr        	sta bufaddr
0018C0  3  90 02        	bcc :+
0018C2  3  E6 rr        	inc bufaddr+1
0018C4  3               :
0018C4  3  68           	pla
0018C5  3               
0018C5  3  C6 rr        	dec z80_b
0018C7  3  D0 E9        	bne cangh1
0018C9  3  60           	rts
0018CA  3               
0018CA  3               ;-------------------------------------
0018CA  3               ; Check left/right movement is okay.
0018CA  3               ;
0018CA  3               ; Input:
0018CA  3               ;  bufaddr = MAP + x/8 + y/8*32
0018CA  3               ;
0018CA  3               ; Output:
0018CA  3               ;  A  = 0 is ok, A <>0 is not ok
0018CA  3               ;-------------------------------------
0018CA  3               
0018CA  3               lrchk:
0018CA  3  A0 00        	ldy #0
0018CC  3  B1 rr        	lda (bufaddr),y		; fetch map cell.
0018CE  3  C9 02        	cmp #WALL 		; is it passable?
0018D0  3  F0 0A        	beq lrchkx		; no.
0018D2  3               
0018D2  3  C9 04        	cmp #FODDER		; fodder has to be dug.
0018D4  3  F0 06        	beq lrchkx		; not passable.
0018D6  3  A9 00        	lda #0
0018D8  3  60           	rts
0018D9  3               
0018D9  3               ;--------------------------------------------------------------
0018D9  3               ; Called by mmenu
0018D9  3               ;--------------------------------------------------------------
0018D9  3               
0018D9  3               always:
0018D9  3  A9 FF        	lda #255		; report it as okay.
0018DB  3  60           	rts
0018DC  3               
0018DC  3               lrchkx:
0018DC  3  A9 01        	lda #1 			; reset all bits.
0018DE  3  60           	rts
0018DF  3               
0018DF  3               
0018DF  3               ;--------------------------------------------------------------
0018DF  3               ; Check platform or solid item is not in way.
0018DF  3               ;
0018DF  3               ; Input:
0018DF  3               ;  bufaddr = MAP + x/8 + y/8*32
0018DF  3               ;
0018DF  3               ; Output:
0018DF  3               ;  A  = 0 is ok, A <>0 is not ok
0018DF  3               ;--------------------------------------------------------------
0018DF  3               
0018DF  3               plchk:
0018DF  3  A0 00        	ldy #0
0018E1  3  B1 rr        	lda (bufaddr),y 	; fetch map cell.
0018E3  3  C9 02        	cmp #WALL 		; is it passable?
0018E5  3  F0 F5        	beq lrchkx		; no.
0018E7  3               
0018E7  3  C9 04        	cmp #FODDER		; fodder has to be dug.
0018E9  3  F0 F1        	beq lrchkx		; not passable.
0018EB  3               
0018EB  3  C9 01        	cmp #PLATFM		; platform is solid.
0018ED  3  F0 07        	beq plchkx		; not passable.
0018EF  3               
0018EF  3  C9 03        	cmp #LADDER		; is it a ladder?
0018F1  3  F0 E9        	beq lrchkx		; on ladder, deny movement.
0018F3  3               plchk0:
0018F3  3  A9 00        	lda #0			; report as ok
0018F5  3  60           	rts
0018F6  3               plchkx:
0018F6  3  A5 rr        	lda dispy		; x coordinate.
0018F8  3  29 07        	and #7			; position straddling blocks.
0018FA  3  F0 E0        	beq lrchkx		; on platform, deny movement.
0018FC  3  4C F3 18     	jmp plchk0
0018FF  3               
0018FF  3               ;--------------------------------------------------------------
0018FF  3               ; Check ladder is available.
0018FF  3               ;
0018FF  3               ; Input:
0018FF  3               ;  bufaddr = MAP + x/8 + y/8*32
0018FF  3               ;
0018FF  3               ; Output:
0018FF  3               ;  A  = 0 is ok, A <>0 is not ok
0018FF  3               ;--------------------------------------------------------------
0018FF  3               
0018FF  3               ldchk:
0018FF  3  A0 00        	ldy #0
001901  3  B1 rr        	lda (bufaddr),y 	; fetch cell.
001903  3  C9 03        	cmp #LADDER 		; is it a ladder?
001905  3  F0 03        	beq :+
001907  3  A9 01        	lda #1
001909  3  60           	rts  			; return with zero flag set accordingly.
00190A  3               :
00190A  3  A9 00        	lda #0
00190C  3  60           	rts
00190D  3               
00190D  3               ;--------------------------------------------------------------
00190D  3               ; Get collectables.
00190D  3               ;--------------------------------------------------------------
00190D  3               
00190D  3               getcol:
00190D  3  A9 08            lda #COLECT             ; collectable blocks.
00190F  3  85 rr            sta z80_b
001911  3  20 85 19         jsr tded                ; test for collectable blocks.
001914  3  C5 rr            cmp z80_b               ; did we find one?
001916  3  F0 01            beq :+
001918  3  60               rts                     ; none were found, job done.
001919  3               :
001919  3  20 22 19         jsr gtblk               ; get block.
00191C  3               
00191C  3  20 97 4B         jsr evnt20              ; collected block event.
00191F  3  4C 0D 19         jmp getcol              ; repeat until none left.
001922  3               
001922  3               ; Get collectable block.
001922  3               
001922  3               gtblk:
001922  3  A0 00        	ldy #0
001924  3  B1 rr        	lda (bufaddr),y
001926  3  85 rr        	sta z80_a
001928  3  A9 00                lda #0
00192A  3  91 rr                sta (bufaddr),y		; make it empty now.
00192C  3               
00192C  3  A5 rr        	lda bufaddr		; set dispx
00192E  3  29 1F        	and #31
001930  3  85 rr        	sta dispx
001932  3               
001932  3  A5 rr        	lda bufaddr+1		; Set dispy
001934  3  38           	sec
001935  3  E9 03        	sbc #>MAP
001937  3  85 rr        	sta bufaddr+1
001939  3  06 rr        	asl bufaddr
00193B  3  26 rr        	rol bufaddr+1
00193D  3  06 rr        	asl bufaddr
00193F  3  26 rr        	rol bufaddr+1
001941  3  06 rr        	asl bufaddr
001943  3  26 rr        	rol bufaddr+1
001945  3  A5 rr        	lda bufaddr+1
001947  3  85 rr        	sta dispy
001949  3               
001949  3  AD C8 16     	lda colpatt		; get blocknr
00194C  3  85 rr        	sta z80_e		; displacement in e.
00194E  3  A9 00        	lda #0
001950  3  85 rr        	sta z80_d		; no high byte.
001952  3  06 rr        	asl z80_e  		; multiply char by 8.
001954  3  26 rr        	rol z80_d
001956  3  06 rr        	asl z80_e
001958  3  26 rr        	rol z80_d
00195A  3  06 rr        	asl z80_e
00195C  3  26 rr        	rol z80_d
00195E  3  18           	clc
00195F  3  A5 rr        	lda z80_e
001961  3  69 CE        	adc #<chgfx 		; address of graphics.
001963  3  85 rr        	sta tileaddr
001965  3  A5 rr        	lda z80_d
001967  3  69 4C        	adc #>chgfx
001969  3  85 rr        	sta tileaddr+1
00196B  3  20 6E 16     	jsr gprad 		; get screen address.
00196E  3  A2 07        	ldx #7			; number of pixel rows to write.
001970  3               gtblk0:
001970  3  A0 00        	ldy #0
001972  3  B1 rr        	lda (tileaddr),y 	; get image byte.
001974  3  BC 65 10     	ldy scrtab,x
001977  3  51 rr        	eor (scraddr),y 	; XOR tile on screen
001979  3  91 rr        	sta (scraddr),y 	; copy to screen.
00197B  3  E6 rr        	inc tileaddr 		; next image byte.
00197D  3  D0 02        	bne :+
00197F  3  E6 rr        	inc tileaddr+1
001981  3               :
001981  3  CA           	dex	 		; repeat for 8 pixel rows.
001982  3  10 EC        	bpl gtblk0
001984  3  60           	rts
001985  3               
001985  3               ;--------------------------------------------------------------
001985  3               ; Touched deadly block check.
001985  3               ; returns with DEADLY (must be non-zero) in accumulator if true.
001985  3               ;
001985  3               ; Input:
001985  3               ;  IX = sprite address
001985  3               ;
001985  3               ; Output:
001985  3               ;  A  = 0 is ok, A=5 is not ok
001985  3               ;--------------------------------------------------------------
001985  3               
001985  3               tded:
001985  3  A0 08        	ldy #8
001987  3  B1 rr        	lda (z80_ix),y 		; y coordinate.
001989  3  85 rr        	sta dispy
00198B  3  C8           	iny
00198C  3  B1 rr        	lda (z80_ix),y 		; x coordinate.
00198E  3  85 rr        	sta dispx		; coords in dispx,dispy.
001990  3  20 40 1A     	jsr tstbl		; get map address.
001993  3  48           	pha
001994  3  A9 1F        	lda #31			; default distance to next line down.
001996  3  85 rr        	sta z80_e
001998  3  68           	pla
001999  3  C5 rr        	cmp z80_b		; is this the required block?
00199B  3  D0 01        	bne :+
00199D  3  60           	rts			; yes.
00199E  3               :
00199E  3  E6 rr        	inc bufaddr 		; next cell.
0019A0  3  D0 02        	bne :+
0019A2  3  E6 rr        	inc bufaddr+1
0019A4  3               :
0019A4  3  A0 00        	ldy #0
0019A6  3  B1 rr        	lda (bufaddr),y		; fetch type.
0019A8  3  C5 rr        	cmp z80_b 		; is this deadly/custom?
0019AA  3  D0 01        	bne :+
0019AC  3  60           	rts			; yes.
0019AD  3               :
0019AD  3  A5 rr        	lda dispx		; horizontal position.
0019AF  3  85 rr        	sta z80_c 		; store column in c register.
0019B1  3  29 07        	and #7			; is it straddling cells?
0019B3  3  D0 03        	bne :+
0019B5  3  4C C9 19     	jmp tded0		; no.
0019B8  3               :
0019B8  3  E6 rr        	inc bufaddr 		; last cell.
0019BA  3  D0 02        	bne :+
0019BC  3  E6 rr        	inc bufaddr+1
0019BE  3               :
0019BE  3  A0 00        	ldy #0
0019C0  3  B1 rr        	lda (bufaddr),y 	; fetch type.
0019C2  3  C5 rr        	cmp z80_b		; is this the block?
0019C4  3  D0 01        	bne :+
0019C6  3  60           	rts			; yes.
0019C7  3               :
0019C7  3  C6 rr        	dec z80_e		; one less cell to next row down.
0019C9  3               tded0:
0019C9  3  18           	clc 			; point to next row.
0019CA  3  A5 rr        	lda bufaddr
0019CC  3  65 rr        	adc z80_e
0019CE  3  85 rr        	sta bufaddr
0019D0  3  90 02        	bcc :+
0019D2  3  E6 rr        	inc bufaddr+1
0019D4  3               :
0019D4  3  A0 00        	ldy #0
0019D6  3  B1 rr        	lda (bufaddr),y		; fetch left cell block.
0019D8  3  C5 rr        	cmp z80_b		; is this fatal?
0019DA  3  D0 01        	bne :+
0019DC  3  60           	rts			; yes.
0019DD  3               :
0019DD  3  E6 rr        	inc bufaddr 		; next cell.
0019DF  3  D0 02        	bne :+
0019E1  3  E6 rr        	inc bufaddr+1
0019E3  3               :
0019E3  3  A0 00        	ldy #0
0019E5  3  B1 rr        	lda (bufaddr),y 	; fetch type.
0019E7  3  C5 rr        	cmp z80_b		; is this fatal?
0019E9  3  D0 01        	bne :+
0019EB  3  60           	rts			; yes.
0019EC  3               :
0019EC  3  A5 rr        	lda z80_c		; horizontal position.
0019EE  3  29 07        	and #7			; is it straddling cells?
0019F0  3  D0 03        	bne :+
0019F2  3  4C 04 1A     	jmp tded1 		; no.
0019F5  3               :
0019F5  3  E6 rr        	inc bufaddr		; last cell.
0019F7  3  D0 02        	bne :+
0019F9  3  E6 rr        	inc bufaddr+1
0019FB  3               :
0019FB  3  A0 00        	ldy #0
0019FD  3  B1 rr        	lda (bufaddr),y		; fetch type.
0019FF  3  C5 rr        	cmp z80_b		; is this fatal?
001A01  3  D0 01        	bne :+
001A03  3  60           	rts			; yes.
001A04  3               :
001A04  3               tded1:
001A04  3  A5 rr        	lda dispy		; vertical position.
001A06  3  29 07        	and #7 			; is it straddling cells?
001A08  3  D0 01        	bne :+
001A0A  3  60           	rts			; no, job done.
001A0B  3               :
001A0B  3  18           	clc			; point to next row.
001A0C  3  A5 rr        	lda bufaddr
001A0E  3  65 rr        	adc z80_e
001A10  3  85 rr        	sta bufaddr
001A12  3  90 02        	bcc :+
001A14  3  E6 rr        	inc bufaddr+1
001A16  3               :
001A16  3  A0 00        	ldy #0
001A18  3  B1 rr        	lda (bufaddr),y 	; fetch left cell block.
001A1A  3  C5 rr        	cmp z80_b		; is this fatal?
001A1C  3  D0 01        	bne :+
001A1E  3  60           	rts			; yes.
001A1F  3               :
001A1F  3  E6 rr        	inc bufaddr		; next cell.
001A21  3  D0 02        	bne :+
001A23  3  E6 rr        	inc bufaddr+1
001A25  3               :
001A25  3  A0 00        	ldy #0
001A27  3  B1 rr        	lda (bufaddr),y 	; fetch type.
001A29  3  C5 rr        	cmp z80_b		; is this fatal?
001A2B  3  D0 01        	bne :+
001A2D  3  60           	rts			; yes.
001A2E  3               :
001A2E  3  A5 rr        	lda z80_c		; horizontal position.
001A30  3  29 07        	and #7			; is it straddling cells?
001A32  3  D0 01        	bne :+
001A34  3  60           	rts			; no.
001A35  3               :
001A35  3  E6 rr        	inc bufaddr		; last cell.
001A37  3  D0 02        	bne :+
001A39  3  E6 rr        	inc bufaddr+1
001A3B  3               :
001A3B  3  A0 00        	ldy #0
001A3D  3  B1 rr        	lda (bufaddr),y		; fetch final type.
001A3F  3  60           	rts 			; return with final type in accumulator.
001A40  3               
001A40  3               ;---------------------------------------------------
001A40  3               ; Fetch block type at (dispx, dispy).
001A40  3               ;
001A40  3               ; Output:
001A40  3               ;  A = block type
001A40  3               ;---------------------------------------------------
001A40  3               
001A40  3               tstbl:
001A40  3  A5 rr        	lda dispy 		; fetch y coord.
001A42  3  4A           	lsr a			; bufaddr = y/8
001A43  3  4A           	lsr a
001A44  3  4A           	lsr a
001A45  3  85 rr        	sta bufaddr
001A47  3  A9 00        	lda #0
001A49  3  85 rr        	sta bufaddr+1
001A4B  3               
001A4B  3  06 rr        	asl bufaddr  		; bufaddr = y/8 * 32
001A4D  3  26 rr        	rol bufaddr+1
001A4F  3  06 rr        	asl bufaddr
001A51  3  26 rr        	rol bufaddr+1
001A53  3  06 rr        	asl bufaddr
001A55  3  26 rr        	rol bufaddr+1
001A57  3  06 rr        	asl bufaddr
001A59  3  26 rr        	rol bufaddr+1
001A5B  3  06 rr        	asl bufaddr
001A5D  3  26 rr        	rol bufaddr+1
001A5F  3               
001A5F  3  A5 rr        	lda dispx		; x/8
001A61  3  4A           	lsr a
001A62  3  4A           	lsr a
001A63  3  4A           	lsr a
001A64  3               
001A64  3  18           	clc			; bufaddr = MAP + x/8 + y/8*32
001A65  3  65 rr        	adc bufaddr
001A67  3  69 00        	adc #<MAP
001A69  3  85 rr        	sta bufaddr
001A6B  3  A5 rr        	lda bufaddr+1
001A6D  3  69 03        	adc #>MAP
001A6F  3  85 rr        	sta bufaddr+1
001A71  3               
001A71  3  A0 00        	ldy #0
001A73  3  B1 rr        	lda (bufaddr),y 	; fetch byte there.
001A75  3  60           	rts
001A76  3               
001A76  3               ;-------------------------------------------------------------------
001A76  3               ; Jump - if we can.
001A76  3               ; Requires initial speed to be set up in accumulator prior to call.
001A76  3               ;
001A76  3               ; Input:
001A76  3               ;  IX = sprite address
001A76  3               ;-------------------------------------------------------------------
001A76  3               
001A76  3               jump:
001A76  3  A0 0D        	ldy #var_jumpLo
001A78  3  B1 rr        	lda (z80_ix),y		; jump table low.
001A7A  3  A0 0E        	ldy #var_jumpHi
001A7C  3  11 rr        	ora (z80_ix),y		; jump table high.
001A7E  3  F0 01        	beq :+
001A80  3  60           	rts			; already in the air.
001A81  3               :
001A81  3  A9 1A        	lda #>jtab
001A83  3  A0 0E        	ldy #var_jumpHi
001A85  3  91 rr        	sta (z80_ix),y		; set jump high.
001A87  3  A9 8E        	lda #<jtab		; jump table start.
001A89  3  A0 0D        	ldy #var_jumpLo
001A8B  3  91 rr        	sta (z80_ix),y		; set jump low.
001A8D  3  60           	rts
001A8E  3               
001A8E  3               ; Jump table.
001A8E  3               
001A8E  3               jtab:
001A8E  3  F8 FA FC     	.byte 248,250,252
001A91  3  FE FE FF     	.byte 254,254,255
001A94  3  FF FF 00 00  	.byte 255,255,0,0
001A98  3  00 01 01 01  	.byte 0,1,1,1,2,2
001A9C  3  02 02        
001A9E  3  04 06 08 08  	.byte 4,6,8,8,8,99
001AA2  3  08 63        
001AA4  3               
001AA4  3               ;------------------------------------------------
001AA4  3               ; Random numbers code.
001AA4  3               ; Pseudo-random number generator, 8-bit.
001AA4  3               ;
001AA4  3               ; Output:
001AA4  3               ;  RND = random number
001AA4  3               ;------------------------------------------------
001AA4  3               
001AA4  3               random:
001AA4  3  A5 rr        	lda seed		; get last random number.
001AA6  3  0A           	asl a
001AA7  3  0A           	asl a
001AA8  3  18           	clc
001AA9  3  65 rr        	adc seed
001AAB  3  18           	clc
001AAC  3  69 45        	adc #$45
001AAE  3  85 rr        	sta seed		; store new seed.
001AB0  3  85 rr        	sta varrnd		; return number in variable.
001AB2  3  60           	rts
001AB3  3               
001AB3  3               ;-------------------------------------------------------
001AB3  3               ; Joystick and keyboard reading routines.
001AB3  3               ;
001AB3  3               ; contrl = 0, Keyboard
001AB3  3               ;          1, JoyKeyb
001AB3  3               ;          2, JoyMMC
001AB3  3               ;-------------------------------------------------------
001AB3  3               
001AB3  3               joykey:
001AB3  3  A5 rr        	lda contrl 		; control flag.
001AB5  3  C9 01        	cmp #1
001AB7  3  D0 03        	bne :+
001AB9  3  4C D7 1A     	jmp joyjoy 		; read keyboard joystick
001ABC  3               :
001ABC  3  C9 02        	cmp #2
001ABE  3  D0 03        	bne :+
001AC0  3  4C A4 0E     	jmp joysin 		; read MMC joystick.
001AC3  3               :
001AC3  3               ; Keyboard controls.
001AC3  3               
001AC3  3  A9 00        	lda #0		 	; zero reading.
001AC5  3  85 rr        	sta z80_e
001AC7  3               
001AC7  3  A0 06        	ldy #6	 		; address of last key.
001AC9  3               joyke0:
001AC9  3  B9 D5 74     	lda keys,y 		; get key from table.
001ACC  3  20 7A 0E     	jsr ktest		; being pressed?
001ACF  3  26 rr        	rol z80_e 		; rotate into reading.
001AD1  3               
001AD1  3  88           	dey		 	; next key.
001AD2  3  10 F5        	bpl joyke0 		; repeat for all keys.
001AD4  3  4C E8 1A     	jmp joyjo1 		; store the value.
001AD7  3               
001AD7  3               ; Keyboard joystick controls.
001AD7  3               
001AD7  3               joyjoy:
001AD7  3  A9 00        	lda #0		 	; zero reading.
001AD9  3  85 rr        	sta z80_e
001ADB  3               
001ADB  3  A0 06        	ldy #6	 		; address of last key.
001ADD  3               joyjo3:
001ADD  3  B9 5C 0E     	lda jkeys,y 		; get key from table.
001AE0  3  20 7A 0E     	jsr ktest		; being pressed?
001AE3  3  26 rr        	rol z80_e 		; rotate into reading.
001AE5  3               
001AE5  3  88           	dey		 	; next key.
001AE6  3  10 F5        	bpl joyjo3 		; repeat for all keys.
001AE8  3               joyjo1:
001AE8  3  A5 rr        	lda z80_e 		; copy e register to accumulator.
001AEA  3               joyjo2:
001AEA  3  85 rr        	sta joyval		; remember value.
001AEC  3  60           	rts
001AED  3               
001AED  3               ;---------------------------------------------------------------
001AED  3               ; Display message.
001AED  3               ;
001AED  3               ; Input:
001AED  3               ;  A = message number
001AED  3               ;---------------------------------------------------------------
001AED  3               
001AED  3               dmsg:
001AED  3  AA           	tax
001AEE  3  A9 99        	lda #<msgdat		; pointer to messages.
001AF0  3  85 rr        	sta z80_l
001AF2  3  A9 4B        	lda #>msgdat
001AF4  3  85 rr        	sta z80_h
001AF6  3  20 0C 1C     	jsr getwrd		; get message number.
001AF9  3               dmsg3:
001AF9  3  20 F9 1B     	jsr preprt		; pre-printing stuff.
001AFC  3  20 30 15     	jsr checkx		; make sure we"re in a printable range.
001AFF  3  A5 rr        	lda prtmod		; print mode.
001B01  3  D0 47        	bne bmsg1		; no, double-height text.
001B03  3               dmsg0:
001B03  3  A5 rr        	lda z80_h		; store string pointer.
001B05  3  48           	pha
001B06  3  A5 rr        	lda z80_l
001B08  3  48           	pha
001B09  3               
001B09  3  A0 00        	ldy #0
001B0B  3  B1 rr        	lda (z80_hl),y		; fetch byte to display.
001B0D  3  29 7F        	and #127		; remove any end marker.
001B0F  3  C9 0D        	cmp #ASCII_NEWLINE
001B11  3  F0 24        	beq dmsg1
001B13  3  20 2C 10     	jsr pchar		; display character.
001B16  3  20 E4 1B     	jsr nexpos 		; display position.
001B19  3  D0 03        	bne dmsg2		; not on a new line.
001B1B  3  20 EB 1B     	jsr nexlin		; next line down.
001B1E  3               dmsg2:
001B1E  3  68           	pla			; retrieve string pointer
001B1F  3  85 rr        	sta z80_l
001B21  3  68           	pla
001B22  3  85 rr        	sta z80_h
001B24  3               
001B24  3  A0 00        	ldy #0
001B26  3  B1 rr        	lda (z80_hl),y		; fetch last character.
001B28  3  0A           	asl a  			; was it the end?
001B29  3  90 03        	bcc :+
001B2B  3  4C 75 15     	jmp dscor2		; yes, job done.
001B2E  3               :
001B2E  3  E6 rr        	inc z80_l		; next character to display.
001B30  3  D0 02        	bne :+
001B32  3  E6 rr        	inc z80_h
001B34  3               :
001B34  3  4C 03 1B     	jmp dmsg0
001B37  3               dmsg1:
001B37  3  E6 rr        	inc dispy
001B39  3  A5 rr        	lda dispy
001B3B  3  C9 18        	cmp #24
001B3D  3  90 04        	bcc dmsg4
001B3F  3  A9 00        	lda #0
001B41  3  85 rr        	sta dispy
001B43  3               dmsg4:
001B43  3  A9 00        	lda #0
001B45  3  85 rr        	sta dispx
001B47  3  4C 1E 1B     	jmp dmsg2
001B4A  3               
001B4A  3               ;----------------------------------------------------------
001B4A  3               ; Display message in big text.
001B4A  3               ;
001B4A  3               ; Input:
001B4A  3               ;  HL = string pointer
001B4A  3               ;----------------------------------------------------------
001B4A  3               
001B4A  3               bmsg1:
001B4A  3  A0 00        	ldy #0
001B4C  3  B1 rr        	lda (z80_hl),y 		; get character to display.
001B4E  3  29 7F        	and #127		; only want 7 bits.
001B50  3  C9 0D        	cmp #ASCII_NEWLINE
001B52  3  F0 13        	beq bmsg2
001B54  3  20 7C 1B     	jsr bchar 		; display big char.
001B57  3               bmsg3:
001B57  3  A0 00        	ldy #0
001B59  3  B1 rr        	lda (z80_hl),y 		; look at last character.
001B5B  3  48           	pha
001B5C  3  E6 rr        	inc z80_l 		; next character in list.
001B5E  3  D0 02        	bne :+
001B60  3  E6 rr        	inc z80_h
001B62  3               :
001B62  3  68           	pla
001B63  3  0A           	asl a  			; was terminator flag set?
001B64  3  90 E4        	bcc bmsg1		; no, keep going.
001B66  3               :
001B66  3  60           	rts
001B67  3               bmsg2:
001B67  3  A9 00        	lda #0
001B69  3  85 rr        	sta dispx
001B6B  3  E6 rr        	inc dispy
001B6D  3  E6 rr        	inc dispy
001B6F  3  A5 rr        	lda dispy
001B71  3  C9 17        	cmp #23
001B73  3  90 E2        	bcc bmsg3
001B75  3  A9 00        	lda #0
001B77  3  85 rr        	sta dispy
001B79  3  4C 57 1B     	jmp bmsg3
001B7C  3               
001B7C  3               ;----------------------------------------------------------
001B7C  3               ; Big character display.
001B7C  3               ;
001B7C  3               ; Input:
001B7C  3               ;  A = character
001B7C  3               ;----------------------------------------------------------
001B7C  3               
001B7C  3               bchar:
001B7C  3  85 rr        	sta z80_e		; save char in lb
001B7E  3  A9 00        	lda #0
001B80  3  85 rr        	sta z80_d		; reset hb
001B82  3               
001B82  3  06 rr        	asl z80_e 		; multiply char by 8.
001B84  3  26 rr        	rol z80_d
001B86  3  06 rr        	asl z80_e
001B88  3  26 rr        	rol z80_d
001B8A  3  06 rr        	asl z80_e
001B8C  3  26 rr        	rol z80_d		; de = a*8
001B8E  3               
001B8E  3  18           	clc			; de = FontPtr + a*8
001B8F  3  A5 rr        	lda z80_e
001B91  3  65 rr        	adc FontPtr 		; address of font.
001B93  3  85 rr        	sta z80_e
001B95  3  A5 rr        	lda z80_d
001B97  3  65 rr        	adc FontPtr+1
001B99  3  85 rr        	sta z80_d
001B9B  3               
001B9B  3  20 6E 16     	jsr gprad 		; get screen address.
001B9E  3               
001B9E  3  A2 00        	ldx #0			; height of character in font.
001BA0  3               bchar0:
001BA0  3  A0 00        	ldy #0
001BA2  3  B1 rr        	lda (z80_de),y 		; get a bit of the font.
001BA4  3               
001BA4  3  49 00        	eor #TxtInvert		; Invert
001BA6  3               
001BA6  3  91 rr        	sta (scraddr),y
001BA8  3  48           	pha
001BA9  3  20 13 10     	jsr nline 		; next line down.
001BAC  3  68           	pla
001BAD  3  91 rr        	sta (scraddr),y
001BAF  3  20 13 10     	jsr nline 		; next line down.
001BB2  3               
001BB2  3  18           	clc
001BB3  3  E6 rr        	inc z80_e 		; next line of font.
001BB5  3  D0 02        	bne :+
001BB7  3  E6 rr        	inc z80_d
001BB9  3               :
001BB9  3  E8           	inx
001BBA  3  E0 08        	cpx #8
001BBC  3  D0 E2        	bne bchar0
001BBE  3               
001BBE  3  20 E4 1B     	jsr nexpos		; display position.
001BC1  3  D0 05        	bne bchar2 		; not on a new line.
001BC3  3               bchar3:
001BC3  3  E6 rr        	inc dispy
001BC5  3  20 EB 1B     	jsr nexlin 		; next line check.
001BC8  3               bchar2:
001BC8  3  4C 75 15     	jmp dscor2		; tidy up line and column variables.
001BCB  3               
001BCB  3               
001BCB  3               ;-------------------------------------------------
001BCB  3               ; Display a character.
001BCB  3               ;
001BCB  3               ; Input:
001BCB  3               ;  A = character
001BCB  3               ;-------------------------------------------------
001BCB  3               
001BCB  3               achar:
001BCB  3  85 rr        	sta z80_b 		; copy to b.
001BCD  3  20 F9 1B     	jsr preprt 		; get ready to print.
001BD0  3  A5 rr        	lda z80_b		; character in accumulator.
001BD2  3  A6 rr        	ldx prtmod 		; print mode.
001BD4  3  F0 03        	beq :+
001BD6  3  4C 7C 1B     	jmp bchar 		; no, double-height text.
001BD9  3               :
001BD9  3  20 2C 10     	jsr pchar 		; display character.
001BDC  3  20 E4 1B     	jsr nexpos 		; display position.
001BDF  3  F0 E2        	beq bchar3		; next line down.
001BE1  3  4C C8 1B     	jmp bchar2 		; tidy up.
001BE4  3               
001BE4  3               
001BE4  3               ;-------------------------------------------------
001BE4  3               ; Get next print column position.
001BE4  3               ;-------------------------------------------------
001BE4  3               
001BE4  3               nexpos:
001BE4  3  E6 rr        	inc dispx		; move along one position.
001BE6  3  A5 rr        	lda dispx 		; get coordinate.
001BE8  3  29 1F        	and #31
001BEA  3  60           	rts 			; return with status in zero flag.
001BEB  3               
001BEB  3               ;-------------------------------------------------
001BEB  3               ; Get next print line position.
001BEB  3               ;-------------------------------------------------
001BEB  3               
001BEB  3               nexlin:
001BEB  3  E6 rr        	inc dispy 		; newline.
001BED  3  A5 rr        	lda dispy		; vertical position.
001BEF  3  C9 18        	cmp #24			; past screen edge?
001BF1  3  B0 01        	bcs :+
001BF3  3  60           	rts			; no, still okay.
001BF4  3               :
001BF4  3  A9 00        	lda #0			; restart at top.
001BF6  3  85 rr        	sta dispy
001BF8  3  60           	rts
001BF9  3               
001BF9  3               ;--------------------------------------------------------
001BF9  3               ; Pre-print preliminaries.
001BF9  3               ;--------------------------------------------------------
001BF9  3               
001BF9  3               preprt:
001BF9  3  A5 rr        	lda FontPtr		; font pointer.
001BFB  3  8D 2E 15     	sta grbase		; set up graphics base.
001BFE  3  A5 rr        	lda FontPtr+1
001C00  3  8D 2F 15     	sta grbase+1
001C03  3               prescr:
001C03  3  A5 rr        	lda charx 		; display coordinates.
001C05  3  85 rr        	sta dispx		; set up general coordinates.
001C07  3  A5 rr        	lda chary
001C09  3  85 rr        	sta dispy
001C0B  3  60           	rts
001C0C  3               
001C0C  3               ;--------------------------------------------------------------
001C0C  3               ; Get messagenr x in hl
001C0C  3               ;
001C0C  3               ; Input:
001C0C  3               ;  HL = pointer to message list
001C0C  3               ;  X  = message number.
001C0C  3               ;--------------------------------------------------------------
001C0C  3               
001C0C  3               getwrd:
001C0C  3  E0 00        	cpx #0
001C0E  3  D0 01        	bne:+ 			; first word in list?
001C10  3  60           	rts 			; yep, don't search.
001C11  3               :
001C11  3  A0 00        	ldy #0
001C13  3               getwd0:
001C13  3  B1 rr        	lda (z80_hl),y
001C15  3  48           	pha
001C16  3  E6 rr        	inc z80_l
001C18  3  D0 02        	bne :+
001C1A  3  E6 rr        	inc z80_h
001C1C  3               :
001C1C  3  68           	pla
001C1D  3  C9 80        	cmp #128		; found end?
001C1F  3  30 F2        	bmi getwd0		; no, carry on.
001C21  3  CA           	dex			; until we have right number.
001C22  3  D0 EF        	bne getwd0
001C24  3  60           	rts
001C25  3               
001C25  3               ;-----------------------------------------------------------
001C25  3               ; Bubble sort.
001C25  3               ;-----------------------------------------------------------
001C25  3               
001C25  3               bsort:
001C25  3  A9 0B        	lda #NUMSPR - 1		; sprites to swap.
001C27  3  85 rr        	sta qscnt
001C29  3               
001C29  3  A9 00        	lda #<sprtab 		; sprite table.
001C2B  3  85 rr        	sta z80_x
001C2D  3  A9 0B        	lda #>sprtab
001C2F  3  85 rr        	sta z80_i
001C31  3               bsort0:
001C31  3  A0 00        	ldy #0
001C33  3  B1 rr        	lda (z80_ix),y 		; first sprite type.
001C35  3  C9 FF        	cmp #255 		; is it switched off?
001C37  3  F0 30        	beq swemp		; yes, may need to switch another in here.
001C39  3               
001C39  3  A0 11        	ldy #TABSIZ
001C3B  3  B1 rr        	lda (z80_ix),y 		; check next slot exists.
001C3D  3  C9 FF        	cmp #255 		; is it enabled?
001C3F  3  F0 0A        	beq bsort2 		; no, nothing to swap.
001C41  3               
001C41  3  A0 14        	ldy #TABSIZ+3
001C43  3  B1 rr        	lda (z80_ix),y 		; fetch next sprite's coordinate.
001C45  3  A0 03        	ldy #3
001C47  3  D1 rr        	cmp (z80_ix),y 		; compare with this x coordinate.
001C49  3  90 10        	bcc bsort1		; next sprite is higher - may need to switch.
001C4B  3               bsort2:
001C4B  3  18           	clc
001C4C  3  A5 rr        	lda z80_x
001C4E  3  69 11        	adc #TABSIZ 		; distance to next odd/even entry.
001C50  3  85 rr        	sta z80_x
001C52  3  90 02        	bcc :+
001C54  3  E6 rr        	inc z80_i
001C56  3               :
001C56  3  C6 rr        	dec qscnt
001C58  3  D0 D7        	bne bsort0		; repeat for remaining sprites.
001C5A  3  60           	rts
001C5B  3               
001C5B  3               bsort1:
001C5B  3  A0 11        	ldy #TABSIZ
001C5D  3  B1 rr        	lda (z80_ix),y		; sprite on/off flag.
001C5F  3  C9 FF        	cmp #255		; is it enabled?
001C61  3  F0 E8        	beq bsort2		; no, nothing to swap.
001C63  3  20 77 1C     	jsr swspr		; swap positions.
001C66  3  4C 4B 1C     	jmp bsort2
001C69  3               swemp:
001C69  3  A0 11        	ldy #TABSIZ
001C6B  3  B1 rr        	lda (z80_ix),y		; next table entry.
001C6D  3  C9 FF        	cmp #255		; is that one on?
001C6F  3  F0 DA        	beq bsort2		; no, nothing to swap.
001C71  3  20 77 1C     	jsr swspr		; swap positions.
001C74  3  4C 4B 1C     	jmp bsort2
001C77  3               
001C77  3               ; Swap sprites.
001C77  3               
001C77  3               swspr:
001C77  3  A5 rr        	lda z80_x		; table address
001C79  3  85 rr        	sta z80_e		; copy to de pair.
001C7B  3  85 rr        	sta z80_l		; copy to hl pair.
001C7D  3  A5 rr        	lda z80_i
001C7F  3  85 rr        	sta z80_h
001C81  3  85 rr        	sta z80_d
001C83  3               
001C83  3  18           	clc
001C84  3  A5 rr        	lda z80_l
001C86  3  69 11        	adc #TABSIZ		; distance to second entry.
001C88  3  85 rr        	sta z80_l
001C8A  3  90 02        	bcc :+
001C8C  3  E6 rr        	inc z80_h
001C8E  3               :
001C8E  3  A9 11        	lda #TABSIZ		; bytes to swap.
001C90  3  85 rr        	sta z80_b
001C92  3  A0 00        	ldy #0
001C94  3               swspr0:
001C94  3  B1 rr        	lda (z80_hl),y		; fetch second byte.
001C96  3  48           	pha
001C97  3  B1 rr        	lda (z80_de),y 		; fetch first byte.
001C99  3  91 rr        	sta (z80_hl),y 		; copy to second.
001C9B  3  68           	pla
001C9C  3  91 rr        	sta (z80_de),y 		; copy to first sprite entry.
001C9E  3               
001C9E  3  E6 rr        	inc z80_e 		; next byte.
001CA0  3  D0 02        	bne :+
001CA2  3  E6 rr        	inc z80_d
001CA4  3               :
001CA4  3  E6 rr        	inc z80_l 		; next byte.
001CA6  3  D0 02        	bne :+
001CA8  3  E6 rr        	inc z80_h
001CAA  3               :
001CAA  3  C6 rr        	dec z80_b
001CAC  3  D0 E6        	bne swspr0 		; swap all bytes in table entry.
001CAE  3  60           	rts
001CAF  3               
001CAF  3               ;----------------------------------------------------
001CAF  3               ; Process sprites.
001CAF  3               ;----------------------------------------------------
001CAF  3               
001CAF  3               pspr:
001CAF  3  A9 0C        	lda #NUMSPR		; sprites to process.
001CB1  3  85 rr        	sta sprptr
001CB3  3               
001CB3  3  A9 00        	lda #<sprtab 		; sprite table.
001CB5  3  85 rr        	sta z80_x
001CB7  3  A9 0B        	lda #>sprtab
001CB9  3  85 rr        	sta z80_i
001CBB  3               pspr1:
001CBB  3  A0 00        	ldy #0
001CBD  3  B1 rr        	lda (z80_ix),y		; fetch sprite type.
001CBF  3  C9 09        	cmp #9 			; within range of sprite types?
001CC1  3  B0 03        	bcs :+
001CC3  3  20 D6 1C     	jsr pspr2 		; yes, process this one.
001CC6  3               :
001CC6  3  18           	clc
001CC7  3  A5 rr        	lda z80_x
001CC9  3  69 11        	adc #TABSIZ 		; distance to next odd/even entry.
001CCB  3  85 rr        	sta z80_x
001CCD  3  90 02        	bcc :+
001CCF  3  E6 rr        	inc z80_i		; next sprite.
001CD1  3               :
001CD1  3  C6 rr        	dec sprptr 		; repeat for remaining sprites.
001CD3  3  D0 E6        	bne pspr1
001CD5  3  60           	rts
001CD6  3               
001CD6  3               pspr2:
001CD6  3  A5 rr        	lda z80_x 		; store original sprite pointer.
001CD8  3  85 rr        	sta ogptr
001CDA  3  A5 rr        	lda z80_i
001CDC  3  85 rr        	sta ogptr+1
001CDE  3  20 EA 1C     	jsr pspr3		; do the routine.
001CE1  3               rtorg:
001CE1  3  A5 rr        	lda ogptr 		; restore original pointer to sprite.
001CE3  3  85 rr        	sta z80_x
001CE5  3  A5 rr        	lda ogptr+1
001CE7  3  85 rr        	sta z80_i
001CE9  3               rtorg0:
001CE9  3  60           	rts
001CEA  3               
001CEA  3               pspr3:
001CEA  3  A9 1F        	lda #<evtyp0		; sprite type events list.
001CEC  3  85 rr        	sta z80_l
001CEE  3  A9 1D        	lda #>evtyp0
001CF0  3  85 rr        	sta z80_h
001CF2  3               pspr4:
001CF2  3  B1 rr        	lda (z80_ix),y
001CF4  3  0A           	asl a			; double accumulator.
001CF5  3  18           	clc
001CF6  3  65 rr        	adc z80_l
001CF8  3  85 rr        	sta z80_l
001CFA  3  90 02        	bcc :+
001CFC  3  E6 rr        	inc z80_h
001CFE  3               :
001CFE  3  B1 rr        	lda (z80_hl),y
001D00  3  85 rr        	sta z80_e 		; copy to de.
001D02  3  48           	pha
001D03  3               
001D03  3  E6 rr        	inc z80_l 		; next byte of address.
001D05  3  D0 02        	bne :+
001D07  3  E6 rr        	inc z80_h
001D09  3               :
001D09  3  B1 rr        	lda (z80_hl),y 		; address high.
001D0B  3  85 rr        	sta z80_d
001D0D  3               
001D0D  3  48           	pha	 		; swap address into hl.
001D0E  3  A5 rr        	lda z80_h
001D10  3  85 rr        	sta z80_d
001D12  3  68           	pla
001D13  3  85 rr        	sta z80_h
001D15  3  68           	pla
001D16  3  85 rr        	sta z80_l
001D18  3  A5 rr        	lda z80_l
001D1A  3  85 rr        	sta z80_e
001D1C  3               
001D1C  3  6C rr rr     	jmp (z80_hl) 		; go there.
001D1F  3               
001D1F  3               ; Address of each sprite type's routine.
001D1F  3               
001D1F  3  AE 22        evtyp0:	.word evnt00
001D21  3  E6 2C        evtyp1:	.word evnt01
001D23  3  69 35        evtyp2:	.word evnt02
001D25  3  FB 36        evtyp3:	.word evnt03
001D27  3  68 3A        evtyp4:	.word evnt04
001D29  3  B0 3B        evtyp5:	.word evnt05
001D2B  3  EF 3E        evtyp6:	.word evnt06
001D2D  3  39 41        evtyp7:	.word evnt07
001D2F  3  12 44        evtyp8:	.word evnt08
001D31  3               
001D31  3               ;--------------------------------------------------------------
001D31  3               ; Display sprites.
001D31  3               ;
001D31  3               ; Input:
001D31  3               ;  IX = sprite table
001D31  3               ;--------------------------------------------------------------
001D31  3               
001D31  3               dspr:
001D31  3  A9 06        	lda #(NUMSPR/2)		; number of sprites to display.
001D33  3  85 rr        	sta sprcnt
001D35  3               
001D35  3               dspr0:
001D35  3  A0 00        	ldy #var_Type
001D37  3  B1 rr        	lda (z80_ix),y 		; get sprite type.
001D39  3  C9 FF        	cmp #255 			; is it enabled?
001D3B  3  D0 45        	bne dspr1 			; yes, it needs deleting.
001D3D  3               
001D3D  3               dspr5:
001D3D  3  A0 05        	ldy #var_newType
001D3F  3  B1 rr        	lda (z80_ix),y 		; new type.
001D41  3  C9 FF        	cmp #255			; is it enabled?
001D43  3  F0 03        	beq dspr2			; no, skip
001D45  3  4C D1 1D     	jmp dspr3 			; yes, it needs drawing.
001D48  3               
001D48  3               dspr2:
001D48  3  A0 05        	ldy #var_newType
001D4A  3  B1 rr        	lda (z80_ix),y 		; copy new type.
001D4C  3  A0 00        	ldy #var_Type
001D4E  3  91 rr        	sta (z80_ix),y
001D50  3  A0 06        	ldy #var_newImage
001D52  3  B1 rr        	lda (z80_ix),y 		; copy new image number.
001D54  3  A0 01        	ldy #var_Image
001D56  3  91 rr        	sta (z80_ix),y
001D58  3  A0 07        	ldy #var_newFrame
001D5A  3  B1 rr        	lda (z80_ix),y 		; copy new frame.
001D5C  3  A0 02        	ldy #var_Frame
001D5E  3  91 rr        	sta (z80_ix),y
001D60  3  A0 08        	ldy #var_newY
001D62  3  B1 rr        	lda (z80_ix),y 		; copy new y.
001D64  3  A0 03        	ldy #var_Y
001D66  3  91 rr        	sta (z80_ix),y
001D68  3  A0 09        	ldy #var_newX
001D6A  3  B1 rr        	lda (z80_ix),y 		; copy new x.
001D6C  3  A0 04        	ldy #var_X
001D6E  3  91 rr        	sta (z80_ix),y
001D70  3               
001D70  3  18           	clc
001D71  3  A5 rr        	lda z80_x
001D73  3  69 22        	adc #(TABSIZ*2)		; distance to next odd/even entry.
001D75  3  85 rr        	sta z80_x
001D77  3  A5 rr        	lda z80_i
001D79  3  69 00        	adc #0
001D7B  3  85 rr        	sta z80_i 			; next sprite.
001D7D  3  C6 rr        	dec sprcnt
001D7F  3  D0 B4        	bne dspr0			; repeat for remaining sprites.
001D81  3  60           	rts
001D82  3               
001D82  3               dspr1:
001D82  3               	; _BEEB clipping code copied from CPC Engine
001D82  3  A0 03        	ldy #var_Y
001D84  3  B1 rr        	lda (z80_ix), y		; old x coord
001D86  3  C9 B1        	cmp #SpriteMaxY     ; beyond maximum?
001D88  3  B0 B3        	bcs dspr5			; yes, don't delete it.
001D8A  3               
001D8A  3  A0 05        	ldy #var_newType
001D8C  3  B1 rr        	lda (z80_ix),y 		; type of new sprite.
001D8E  3  C9 FF        	cmp #255			; is this enabled?
001D90  3  D0 06        	bne dspr4 			; yes, display both.
001D92  3               
001D92  3               dspr6:
001D92  3  20 8F 0F     	jsr sspria 			; show single sprite.
001D95  3  4C 48 1D     	jmp dspr2
001D98  3               
001D98  3               ; Displaying two sprites.  Don't bother redrawing if nothing has changed.
001D98  3               
001D98  3               dspr4:
001D98  3               	; _BEEB clipping code copied from CPC Engine
001D98  3  A0 08        	ldy #var_newY
001D9A  3  B1 rr        	lda (z80_ix), y		; old x coord
001D9C  3  C9 B1        	cmp #SpriteMaxY     ; beyond maximum?
001D9E  3  B0 F2        	bcs dspr6			; yes, don't display it.
001DA0  3               
001DA0  3  A0 04        	ldy #var_X
001DA2  3  B1 rr        	lda (z80_ix),y		; old x.
001DA4  3  A0 09        	ldy #var_newX
001DA6  3  D1 rr        	cmp (z80_ix),y 		; compare with new value.
001DA8  3  D0 21        	bne dspr7 			; they differ, need to redraw.
001DAA  3               
001DAA  3  A0 03        	ldy #var_Y
001DAC  3  B1 rr        	lda (z80_ix),y		; old y.
001DAE  3  A0 08        	ldy #var_newY
001DB0  3  D1 rr        	cmp (z80_ix),y 		; compare against new value.
001DB2  3  D0 17        	bne dspr7			; they differ, need to redraw.
001DB4  3               
001DB4  3  A0 02        	ldy #var_Frame
001DB6  3  B1 rr        	lda (z80_ix),y 		; old frame.
001DB8  3  A0 07        	ldy #var_newFrame
001DBA  3  D1 rr        	cmp (z80_ix),y 		; compare against new value.
001DBC  3  D0 0D        	bne dspr7 			; they differ, need to redraw.
001DBE  3               
001DBE  3  A0 01        	ldy #var_Image
001DC0  3  B1 rr        	lda (z80_ix),y 		; old image.
001DC2  3  A0 06        	ldy #var_newImage
001DC4  3  D1 rr        	cmp (z80_ix),y 		; compare against new value.
001DC6  3  D0 03        	bne dspr7 			; they differ, need to redraw.
001DC8  3  4C 48 1D     	jmp dspr2			; everything is the same, don't redraw.
001DCB  3               
001DCB  3               dspr7:
001DCB  3  20 A7 0F     	jsr sspric 			; delete old sprite, draw new one simultaneously.
001DCE  3  4C 48 1D     	jmp dspr2
001DD1  3               
001DD1  3               dspr3:
001DD1  3               	; _BEEB clipping code copied from CPC Engine
001DD1  3  A0 08        	ldy #var_newY
001DD3  3  B1 rr        	lda (z80_ix), y		; old x coord
001DD5  3  C9 B1        	cmp #SpriteMaxY     ; beyond maximum?
001DD7  3  90 03        	bcc :+				; no, continue
001DD9  3  4C 48 1D     	jmp dspr2			; yes, don't display it.
001DDC  3               :
001DDC  3  20 A1 0F     	jsr ssprib 			; show single sprite.
001DDF  3  4C 48 1D     	jmp dspr2
001DE2  3               
001DE2  3               ;-----------------------------------------
001DE2  3               ; Get sprite address calculations.
001DE2  3               ; gspran = new sprite, gsprad = old sprite.
001DE2  3               ;
001DE2  3               ; Input:
001DE2  3               ;  IX = sprite address
001DE2  3               ;-----------------------------------------
001DE2  3               
001DE2  3               gspran:
001DE2  3  A0 08        	ldy #var_newY
001DE4  3  B1 rr        	lda (z80_ix),y 		; new y coordinate.
001DE6  3  85 rr        	sta dispy
001DE8  3  A0 09        	ldy #var_newX
001DEA  3  B1 rr        	lda (z80_ix),y 		; new x coordinate.
001DEC  3  85 rr        	sta dispx
001DEE  3  A0 06        	ldy #var_newImage
001DF0  3  B1 rr        	lda (z80_ix),y 		; new sprite image.
001DF2  3  20 B3 20     	jsr gfrm		; fetch start frame for this sprite.
001DF5  3               
001DF5  3  A0 00        	ldy #0
001DF7  3  B1 rr        	lda (z80_hl),y 		; frame in accumulator.
001DF9  3  A0 07        	ldy #var_newFrame
001DFB  3  18           	clc
001DFC  3  71 rr        	adc (z80_ix),y 		; new add frame number.
001DFE  3  4C 1D 1E     	jmp gspra0
001E01  3               
001E01  3               ;-----------------------------------------
001E01  3               ; Calculate old sprite address
001E01  3               ;
001E01  3               ; Input:
001E01  3               ;  IX = sprite address
001E01  3               ;
001E01  3               ; Output:
001E01  3               ;  B  = right byte mask
001E01  3               ;  C  = left byte mask
001E01  3               ;  DE = spriteframe address
001E01  3               ;  scraddr = screenaddress(dispx,dispy)
001E01  3               ;-----------------------------------------
001E01  3               
001E01  3               gsprad:
001E01  3  A0 03        	ldy #var_Y
001E03  3  B1 rr        	lda (z80_ix),y		; y coordinate.
001E05  3  85 rr        	sta dispy
001E07  3  A0 04        	ldy #var_X
001E09  3  B1 rr        	lda (z80_ix),y		; x coordinate.
001E0B  3  85 rr        	sta dispx
001E0D  3  A0 01        	ldy #var_Image
001E0F  3  B1 rr        	lda (z80_ix),y 		; sprite image.
001E11  3  20 B3 20     	jsr gfrm 		; fetch start frame for this sprite.
001E14  3               
001E14  3  A0 00        	ldy #0
001E16  3  B1 rr        	lda (z80_hl),y 		; frame in accumulator.
001E18  3  A0 02        	ldy #var_Frame
001E1A  3  18           	clc
001E1B  3  71 rr        	adc (z80_ix),y 		; add frame number.
001E1D  3               
001E1D  3               gspra0:
001E1D  3  4A           	lsr a	  		; multiply by 128.
001E1E  3  85 rr        	sta z80_d 		; store in d.
001E20  3  A9 00        	lda #0
001E22  3  6A           	ror a
001E23  3  85 rr        	sta z80_e 		; got low byte.
001E25  3               
001E25  3  18           	clc 			; address of play sprites.
001E26  3  A5 rr        	lda z80_e
001E28  3  69 F8        	adc #<sprgfx
001E2A  3  85 rr        	sta z80_e
001E2C  3  A5 rr        	lda z80_d
001E2E  3  69 4F        	adc #>sprgfx
001E30  3  85 rr        	sta z80_d
001E32  3               
001E32  3  A5 rr        	lda dispx 		; y coordinate.
001E34  3  29 06        	and #6 			; position within byte boundary.
001E36  3  AA           	tax	 		; low byte of table displacement.
001E37  3               
001E37  3  0A           	asl a	  		; multiply by 32.
001E38  3  0A           	asl a  			; already a multiple
001E39  3  0A           	asl a  			; of 2, so just 4
001E3A  3  0A           	asl a  			; shifts needed.
001E3B  3               
001E3B  3  18           	clc 			; add to sprite address.
001E3C  3  65 rr        	adc z80_e
001E3E  3  85 rr        	sta z80_e
001E40  3  90 02        	bcc :+
001E42  3  E6 rr        	inc z80_d
001E44  3               :
001E44  3  BD 51 1E     	lda spmask,x		 ; pointer to mask table.
001E47  3  85 rr        	sta z80_c 		; left mask.
001E49  3  BD 52 1E     	lda spmask+1,x
001E4C  3  85 rr        	sta z80_b 		; right mask.
001E4E  3               ; Drop into screen address routine.
001E4E  3  4C 7B 0F     	jmp scadd
001E51  3               
001E51  3  FF 00 3F C0  spmask:	.byte 255,0,63,192,15,240,3,252
001E55  3  0F F0 03 FC  
001E59  3               
001E59  3               
001E59  3               ;-----------------------------------------------------------
001E59  3               ; Animates a sprite.
001E59  3               ;
001E59  3               ; Input:
001E59  3               ;  IX = sprite address
001E59  3               ;  HL = last sprite address
001E59  3               ;-----------------------------------------------------------
001E59  3               
001E59  3               animsp:
001E59  3  25 rr        	and frmno
001E5B  3  F0 01        	beq :+
001E5D  3  60           	rts
001E5E  3               :
001E5E  3  A0 06        	ldy #var_newImage
001E60  3  B1 rr        	lda (z80_ix),y		; sprite image
001E62  3  20 B3 20     	jsr gfrm		; get frame data.
001E65  3               
001E65  3  E6 rr        	inc z80_l		; point to frames.
001E67  3  D0 02        	bne :+
001E69  3  E6 rr        	inc z80_h
001E6B  3               :
001E6B  3  A0 07        	ldy #var_newFrame
001E6D  3  B1 rr        	lda (z80_ix),y		; sprite frame.
001E6F  3  18           	clc
001E70  3  69 01        	adc #1			; next one along.
001E72  3  A0 00        	ldy #0
001E74  3  D1 rr        	cmp (z80_hl),y		; reached the last frame?
001E76  3  90 02        	bcc anims0		; no, not yet.
001E78  3  A9 00        	lda #0			; start at first frame.
001E7A  3               anims0:
001E7A  3  A0 07        	ldy #var_newFrame
001E7C  3  91 rr        	sta (z80_ix),y		; new frame.
001E7E  3  60           	rts
001E7F  3               
001E7F  3               ;--------------------------------------------------------------
001E7F  3               ; Animate back
001E7F  3               ;
001E7F  3               ; Input:
001E7F  3               ;  IX = sprite address
001E7F  3               ;  HL = last sprite address
001E7F  3               ;--------------------------------------------------------------
001E7F  3               
001E7F  3               animbk:
001E7F  3  25 rr        	and frmno
001E81  3  F0 01        	beq :+
001E83  3  60           	rts
001E84  3               :
001E84  3  A0 06        	ldy #var_newImage
001E86  3  B1 rr        	lda (z80_ix),y		; sprite image.
001E88  3  20 B3 20     	jsr gfrm		; get frame data.
001E8B  3               
001E8B  3  E6 rr        	inc z80_l 		; point to frames.
001E8D  3  D0 02        	bne :+
001E8F  3  E6 rr        	inc z80_h
001E91  3               :
001E91  3  A0 07        	ldy #var_newFrame
001E93  3  B1 rr        	lda (z80_ix),y 		; sprite frame.
001E95  3  F0 03        	beq :+
001E97  3  4C 9E 1E     	jmp rtanb0 		; yes, start at end.
001E9A  3               :
001E9A  3  A0 00        	ldy #0
001E9C  3  B1 rr        	lda (z80_hl),y 		; last sprite.
001E9E  3               rtanb0:
001E9E  3  38           	sec
001E9F  3  E9 01        	sbc #1			; next one along.
001EA1  3  4C 7A 1E     	jmp anims0		; set new frame.
001EA4  3               
001EA4  3               ;--------------------------------------------------------------
001EA4  3               ; Check for collision with other sprite, strict enforcement.
001EA4  3               ;
001EA4  3               ; Input:
001EA4  3               ;  b		= sprite to test for
001EA4  3               ;  ix		= current sprite pointer
001EA4  3               ;
001EA4  3               ; global:	b
001EA4  3               ; local:	x,y,hl,de,skptr
001EA4  3               ; calls:	-
001EA4  3               ;--------------------------------------------------------------
001EA4  3               
001EA4  3               sktyp:
001EA4  3  A9 00        	lda #<sprtab				; sprite table.
001EA6  3  85 rr        	sta z80_l
001EA8  3  A9 0B        	lda #>sprtab
001EAA  3  85 rr        	sta z80_h
001EAC  3               numsp2:
001EAC  3  A9 0C        	lda #NUMSPR				; number of sprites.
001EAE  3  85 rr        	sta sktptr
001EB0  3               sktyp0:
001EB0  3  A5 rr        	lda z80_l 				; store pointer to sprite.
001EB2  3  85 rr        	sta skptr
001EB4  3  A5 rr        	lda z80_h
001EB6  3  85 rr        	sta skptr+1
001EB8  3               
001EB8  3  A0 00        	ldy #0
001EBA  3  B1 rr        	lda (z80_hl),y 				; get sprite type.
001EBC  3  C5 rr        	cmp z80_b				; is it the type we seek?
001EBE  3  F0 1D        	beq coltyp				; yes, we can use this one.
001EC0  3               :
001EC0  3               sktyp1:
001EC0  3  18           	clc
001EC1  3  A5 rr        	lda skptr				; retrieve sprite pointer.
001EC3  3  69 11        	adc #TABSIZ				; size of each entry.
001EC5  3  85 rr        	sta z80_l
001EC7  3  A5 rr        	lda skptr+1
001EC9  3  69 00        	adc #0
001ECB  3  85 rr        	sta z80_h
001ECD  3  C6 rr        	dec sktptr					; one less iteration.
001ECF  3  D0 DF        	bne sktyp0				; keep going until we find a slot.
001ED1  3               :
001ED1  3  A9 00        	lda #0					; default to ROM address - no sprite.
001ED3  3  85 rr        	sta z80_l
001ED5  3  85 rr        	sta z80_h
001ED7  3  85 rr        	sta skptr				; store pointer to sprite.
001ED9  3  85 rr        	sta skptr+1
001EDB  3               
001EDB  3  18           	clc					; don't return with zero flag set.
001EDC  3  60           	rts 					; didn't find one.
001EDD  3               
001EDD  3               coltyp:
001EDD  3  A0 00        	ldy #0
001EDF  3  B1 rr        	lda (z80_ix),y				; current sprite type.
001EE1  3  C5 rr        	cmp z80_b				; seeking sprite of same type?
001EE3  3  F0 3D        	beq colty1				; yes, need to check we're not detecting ourselves.
001EE5  3               colty0:
001EE5  3  A0 09        	ldy #9					; distance to x position in table.
001EE7  3  B1 rr        	lda (z80_hl),y				; fetch x coordinate.
001EE9  3  85 rr        	sta z80_e
001EEB  3  88           	dey
001EEC  3  B1 rr        	lda (z80_hl),y				; fetch y coordinate.
001EEE  3  85 rr        	sta z80_d
001EF0  3               
001EF0  3               ; Drop into collision detection.
001EF0  3               
001EF0  3               colc16:
001EF0  3  A0 09        	ldy #9
001EF2  3  B1 rr        	lda (z80_ix),y			 	; x coord.
001EF4  3  38           	sec					; subtract x.
001EF5  3  E5 rr        	sbc z80_e
001EF7  3  B0 05        	bcs  colc1a 				; result is positive.
001EF9  3  49 FF        	eor #$ff				; make negative positive.
001EFB  3  18           	clc
001EFC  3  69 01        	adc #1
001EFE  3               colc1a:
001EFE  3  C9 10        	cmp #16 				; within x range?
001F00  3  B0 BE        	bcs sktyp1				; no - they"ve missed.
001F02  3  85 rr        	sta z80_c				; store difference.
001F04  3               
001F04  3  A0 08        	ldy #8
001F06  3  B1 rr        	lda (z80_ix),y				; y coord.
001F08  3  38           	sec
001F09  3  E5 rr        	sbc z80_d				; subtract y.
001F0B  3  B0 05        	bcs colc1b				; result is positive.
001F0D  3  49 FF        	eor #$ff				; make negative positive.
001F0F  3  18           	clc
001F10  3  69 01        	adc #1
001F12  3               colc1b:
001F12  3  C9 10        	cmp #16					; within y range?
001F14  3  B0 AA        	bcs sktyp1 				; no - they've missed.
001F16  3  18           	clc					; add x difference.
001F17  3  65 rr        	adc z80_c
001F19  3  C9 1A        	cmp #26					; only 5 corner pixels touching?
001F1B  3  B0 02        	bcs :+
001F1D  3  38           	sec
001F1E  3  60           	rts 					; carry set if there's a collision.
001F1F  3               :
001F1F  3  4C C0 1E     	jmp sktyp1				; try next sprite in table.
001F22  3               colty1:
001F22  3  A5 rr        	lda z80_x  				; compare the two.
001F24  3  C5 rr        	cmp z80_l
001F26  3  D0 09        	bne end_col
001F28  3  A5 rr        	lda z80_i
001F2A  3  C5 rr        	cmp z80_h
001F2C  3  D0 03        	bne end_col
001F2E  3  4C C0 1E     	jmp sktyp1 				; addresses are identical.
001F31  3               end_col:
001F31  3  4C E5 1E     	jmp colty0
001F34  3               
001F34  3               ;-----------------------------------------------------------
001F34  3               ; Display number, left aligned
001F34  3               ;
001F34  3               ; Input:
001F34  3               ;  a		= number
001F34  3               ;
001F34  3               ; global:	-
001F34  3               ; local:	a,y,bc,hl,displ0
001F34  3               ; calls:	num2ch,dmsg3
001F34  3               ;-----------------------------------------------------------
001F34  3               
001F34  3               disply:
001F34  3  85 rr        	sta z80_a
001F36  3  A9 5C        	lda #<displ0				; display workspace.
001F38  3  85 rr        	sta z80_c
001F3A  3  A9 1F        	lda #>displ0
001F3C  3  85 rr        	sta z80_b
001F3E  3  A5 rr        	lda z80_a
001F40  3  20 AD 12     	jsr num2ch				; convert accumulator to string.
001F43  3               displ1:
001F43  3  C6 rr        	dec z80_c				; back one character.
001F45  3  D0 02        	bne :+
001F47  3  C6 rr        	dec z80_b
001F49  3               :
001F49  3  A0 00        	ldy #0
001F4B  3  B1 rr        	lda (z80_bc),y				; fetch digit.
001F4D  3  09 80        	ora #128				; insert end marker.
001F4F  3  91 rr        	sta (z80_bc),y				; new value.
001F51  3               
001F51  3  A9 5C        	lda #<displ0				; display space.
001F53  3  85 rr        	sta z80_l
001F55  3  A9 1F        	lda #>displ0
001F57  3  85 rr        	sta z80_h
001F59  3  4C F9 1A     	jmp dmsg3				; display the string.
001F5C  3               
001F5C  3  00 00 00 8D  displ0:	.byte 0,0,0,13+128
001F60  3               
001F60  3               ;----------------------------------------------------------------
001F60  3               ; Initialise screen.
001F60  3               ;
001F60  3               ; global:	roomtb,scno
001F60  3               ; local:	-
001F60  3               ; calls:	tstcs
001F60  3               ;----------------------------------------------------------------
001F60  3               
001F60  3               initsc:
001F60  3  AD A2 22     	lda roomtb 			; whereabouts in the map are we?
001F63  3  20 6D 1F     	jsr tstsc 			; find displacement.
001F66  3  C9 FF        	cmp #255 			; is it valid?
001F68  3  F0 02        	beq init_end 			; no, it's rubbish.
001F6A  3  85 rr        	sta scno			; store new room number.
001F6C  3               init_end:
001F6C  3  60           	rts
001F6D  3               
001F6D  3               ;----------------------------------------------------------------
001F6D  3               ; Test screen.
001F6D  3               ;
001F6D  3               ; global:	-
001F6D  3               ; local:	x
001F6D  3               ; calls:	-
001F6D  3               ;----------------------------------------------------------------
001F6D  3               
001F6D  3               tstsc:
001F6D  3  85 rr        	sta tmproom
001F6F  3  18           	clc
001F70  3  69 03        	adc #MAPWID 			; add width in case we"re negative.
001F72  3  AA           	tax 				; add displacement to map data.
001F73  3  BD A4 22     	lda mapdat-MAPWID,x 		; find room number there.
001F76  3  60           	rts
001F77  3               
001F77  3               ;--------------------------
001F77  3               ; Screen left.
001F77  3               ;--------------------------
001F77  3               
001F77  3               scrl:
001F77  3  AD A2 22     	lda roomtb 			; present room table pointer.
001F7A  3  38           	sec
001F7B  3  E9 01        	sbc #1				; room left.
001F7D  3               scrl0:
001F7D  3  20 6D 1F     	jsr tstsc			; test screen.
001F80  3  C9 FF        	cmp #255			; is there a screen this way?
001F82  3  D0 01        	bne :+
001F84  3  60           	rts				; no, return to loop.
001F85  3               :
001F85  3  A5 rr        	lda tmproom			; restore room displacement.
001F87  3  8D A2 22     	sta roomtb			; new room table position.
001F8A  3               scrl1:
001F8A  3  20 60 1F     	jsr initsc 			; set new screen.
001F8D  3  A9 02        	lda #2
001F8F  3  85 rr        	sta restfl 			; set it.
001F91  3  60           	rts
001F92  3               scrr:
001F92  3  AD A2 22     	lda roomtb 			; room table pointer.
001F95  3  18           	clc
001F96  3  69 01        	adc #1				; room right.
001F98  3  4C 7D 1F     	jmp scrl0
001F9B  3               scru:
001F9B  3  AD A2 22     	lda roomtb 			; room table pointer.
001F9E  3  38           	sec
001F9F  3  E9 03        	sbc #MAPWID 			; room up.
001FA1  3  4C 7D 1F     	jmp scrl0
001FA4  3               scrd:
001FA4  3  AD A2 22     	lda roomtb 			; room table pointer.
001FA7  3  18           	clc
001FA8  3  69 03        	adc #MAPWID 			; room down.
001FAA  3  4C 7D 1F     	jmp scrl0
001FAD  3               
001FAD  3               ;-----------------------------------------
001FAD  3               ; Jump to new screen.
001FAD  3               ;-----------------------------------------
001FAD  3               
001FAD  3               nwscr:
001FAD  3  A2 00        	ldx #0				; start of map data.
001FAF  3               nwscr0:
001FAF  3  DD A7 22     	cmp mapdat,x
001FB2  3  F0 06        	beq nwscr1			; have we found a match for screen?
001FB4  3  E8           	inx 				; next room.
001FB5  3  E0 50        	cpx #80				; zero room count, 80 to search.
001FB7  3  D0 F6        	bne nwscr0			; keep looking.
001FB9  3  60           	rts
001FBA  3               nwscr1:
001FBA  3  8E A2 22     	stx roomtb			; set the map position.
001FBD  3  4C 8A 1F     	jmp scrl1			; draw new room.
001FC0  3               
001FC0  3               
001FC0  3               ;----------------------------------------------------------
001FC0  3               ; Gravity processing.
001FC0  3               ;----------------------------------------------------------
001FC0  3               
001FC0  3               grav:
001FC0  3  A0 0D        	ldy #var_jumpLo
001FC2  3  B1 rr        	lda (z80_ix),y			; jump pointer low.
001FC4  3  85 rr        	sta z80_l
001FC6  3  A0 0E        	ldy #var_jumpHi
001FC8  3  B1 rr        	lda (z80_ix),y			; jump pointer high.
001FCA  3  85 rr        	sta z80_h
001FCC  3  05 rr        	ora z80_l			; merge in low byte.
001FCE  3  D0 01        	bne :+
001FD0  3  60           	rts				; if neither is set, we're not in the air.
001FD1  3               :
001FD1  3  A0 00        	ldy #0
001FD3  3  B1 rr        	lda (z80_hl),y			; pixels to move.
001FD5  3  85 rr        	sta z80_a
001FD7  3  C9 63        	cmp #99				; reached the end?
001FD9  3  D0 06        	bne grav0			; no, continue.
001FDB  3               grav2:
001FDB  3  C6 rr        	dec z80_l			; go back to previous value.
001FDD  3               	; 6502 WARNING - not updating 16-bit pointer properly!
001FDD  3  B1 rr        	lda (z80_hl),y			; fetch that from table.
001FDF  3  85 rr        	sta z80_a
001FE1  3               grav0:
001FE1  3  E6 rr        	inc z80_l			; point to next table entry.
001FE3  3               	; 6502 WARNING - not updating 16-bit pointer properly!
001FE3  3  A5 rr        	lda z80_l
001FE5  3  A0 0D        	ldy #var_jumpLo
001FE7  3  91 rr        	sta (z80_ix),y			; store new pointer low.
001FE9  3  A5 rr        	lda z80_h
001FEB  3  A0 0E        	ldy #var_jumpHi
001FED  3  91 rr        	sta (z80_ix),y			; store new pointer high.
001FEF  3               grav1:
001FEF  3  A5 rr        	lda z80_a
001FF1  3  D0 01        	bne :+				; any movement required?
001FF3  3  60           	rts				; no, not this time.
001FF4  3               :
001FF4  3  A5 rr        	lda z80_a
001FF6  3  C9 80        	cmp #128			; is it up or down?
001FF8  3  B0 15        	bcs gravu			; it's up.
001FFA  3               gravd:
001FFA  3  85 rr        	sta z80_b			; set pixels to move.
001FFC  3               gravd0:
001FFC  3  20 4D 18     	jsr cangd			; can we go down?
001FFF  3  D0 28        	bne gravst			; can't move down, so stop.
002001  3  A0 08        	ldy #8
002003  3  B1 rr        	lda (z80_ix),y			; adjust new x coord.
002005  3  18           	clc
002006  3  69 01        	adc #1
002008  3  91 rr        	sta (z80_ix),y
00200A  3  C6 rr        	dec z80_b
00200C  3  D0 EE        	bne gravd0
00200E  3  60           	rts
00200F  3               gravu:
00200F  3  49 FF        	eor #$ff			; flip the sign so it's positive.
002011  3  18           	clc
002012  3  69 01        	adc #1
002014  3  85 rr        	sta z80_b			; set pixels to move.
002016  3               gravu0:
002016  3  20 18 18     	jsr cangu			; can we go up?
002019  3  D0 6E        	bne ifalls			; can't move up, go down next.
00201B  3  A0 08        	ldy #8
00201D  3  B1 rr        	lda (z80_ix),y
00201F  3  38           	sec
002020  3  E9 01        	sbc #1
002022  3  91 rr        	sta (z80_ix),y			; adjust new x coord.
002024  3  C6 rr        	dec z80_b
002026  3  D0 EE        	bne gravu0
002028  3  60           	rts
002029  3               gravst:
002029  3  A0 0D        	ldy #var_jumpLo
00202B  3  B1 rr        	lda (z80_ix),y			; jump pointer low.
00202D  3  85 rr        	sta z80_l
00202F  3  A0 0E        	ldy #var_jumpHi
002031  3  B1 rr        	lda (z80_ix),y			; jump pointer high.
002033  3  85 rr        	sta z80_h
002035  3               
002035  3  A9 00        	lda #0				; null value in pointer.
002037  3  A0 0D        	ldy #var_jumpLo
002039  3  91 rr        	sta (z80_ix),y			; store new pointer low.
00203B  3  C8           	iny
00203C  3  91 rr        	sta (z80_ix),y			; store new pointer high.
00203E  3               
00203E  3  A0 00        	ldy #0
002040  3  B1 rr        	lda (z80_hl),y			; fetch byte from table.
002042  3  C9 63        	cmp #99				; is it the end marker?
002044  3               evftf:
002044  3  F0 01        	beq :+				; yes, fallen too far.
002046  3  60           	rts
002047  3               :
002047  3  4C 92 4B     	jmp evnt15			; EVENT FELLTOOFAR
00204A  3               
00204A  3               ;------------------------------------------------
00204A  3               ; Initiate fall check.
00204A  3               ;------------------------------------------------
00204A  3               
00204A  3               ifall:
00204A  3  A0 0D        	ldy #var_jumpLo
00204C  3  B1 rr        	lda (z80_ix),y 			; jump pointer low.
00204E  3  85 rr        	sta z80_l
002050  3  A0 0E        	ldy #var_jumpHi
002052  3  B1 rr        	lda (z80_ix),y 			; jump pointer high.
002054  3  85 rr        	sta z80_h			; high byte in accumulator.
002056  3  05 rr        	ora z80_l			; merge in low byte.
002058  3  F0 01        	beq :+
00205A  3  60           	rts				; if either is set, we're already in the air.
00205B  3               :
00205B  3  A0 09        	ldy #9
00205D  3  B1 rr        	lda (z80_ix),y			; y coordinate.
00205F  3  85 rr        	sta dispx
002061  3               numsp7:
002061  3  A0 08        	ldy #8
002063  3  B1 rr        	lda (z80_ix),y			; look x coordinate.
002065  3  18           	clc
002066  3  69 10        	adc #16				; add 16 pixels.
002068  3  85 rr        	sta dispy			; set up test coordinates.
00206A  3  20 40 1A     	jsr tstbl			; get map address.
00206D  3  20 DF 18     	jsr plchk			; block, platform check.
002070  3  F0 01        	beq :+
002072  3  60           	rts				; it's solid, don't fall.
002073  3               :
002073  3  E6 rr        	inc bufaddr			; look right one cell.
002075  3  20 DF 18     	jsr plchk			; block, platform check.
002078  3  F0 01        	beq :+
00207A  3  60           	rts				; it's solid, don't fall.
00207B  3               :
00207B  3  A5 rr        	lda dispx			; y coordinate.
00207D  3  29 07        	and #7				; position straddling block cells.
00207F  3  F0 08        	beq ifalls			; no more checks needed.
002081  3  E6 rr        	inc bufaddr			; look to third cell.
002083  3  20 DF 18     	jsr plchk			; block, platform check.
002086  3  F0 01        	beq :+
002088  3  60           	rts				; it's solid, don't fall.
002089  3               :
002089  3               ifalls:
002089  3  A9 8E        	lda #<jtab			; jump table start.
00208B  3  85 rr        	sta z80_l
00208D  3  A9 1A        	lda #>jtab
00208F  3  85 rr        	sta z80_h
002091  3               ifal0:
002091  3  E6 rr        	inc z80_l			; point to next value.
002093  3  D0 02        	bne :+
002095  3  E6 rr        	inc z80_h
002097  3               :
002097  3  A0 00        	ldy #0
002099  3  B1 rr        	lda (z80_hl),y			; fetch value.
00209B  3  F0 F4        	beq ifal0			; no, get next value.
00209D  3  C9 63        	cmp #99				; reached end of table?
00209F  3  D0 01        	bne :+
0020A1  3  60           	rts				; yes, don't fall.
0020A2  3               :
0020A2  3  C9 80        	cmp #128			; is it going up?
0020A4  3  B0 EB        	bcs ifal0			; yes, looking for first movement down.
0020A6  3               
0020A6  3  A0 0D        	ldy #var_jumpLo
0020A8  3  A5 rr        	lda z80_l
0020AA  3  91 rr        	sta (z80_ix),y 			; set jump low.
0020AC  3  A0 0E        	ldy #var_jumpHi
0020AE  3  A5 rr        	lda z80_h
0020B0  3  91 rr        	sta (z80_ix),y 			; set jump high.
0020B2  3  60           	rts
0020B3  3               
0020B3  3               
0020B3  3               ;----------------------------------------------------
0020B3  3               ; Get frame data for a particular sprite.
0020B3  3               ; Input:
0020B3  3               ;  a		= framenumer
0020B3  3               ; Output:
0020B3  3               ;  hl		= frame address
0020B3  3               ;
0020B3  3               ; global:	hl,frmptr
0020B3  3               ; local:	-
0020B3  3               ; calls:	-
0020B3  3               ;----------------------------------------------------
0020B3  3               
0020B3  3               gfrm:
0020B3  3  0A           	asl a	 		 	; multiple of 2.
0020B4  3  18           	clc
0020B5  3  6D 82 10     	adc frmptr 			; frames used by game.
0020B8  3  85 rr        	sta z80_l
0020BA  3  AD 83 10     	lda frmptr+1
0020BD  3  69 00        	adc #0
0020BF  3  85 rr        	sta z80_h 			; point to frame start.
0020C1  3  60           	rts
0020C2  3               
0020C2  3               ;----------------------------------------------------
0020C2  3               ; Find sprite list for current room.
0020C2  3               ;
0020C2  3               ; global:	hl
0020C2  3               ; local:	x,y
0020C2  3               ; calls:	-
0020C2  3               ;----------------------------------------------------
0020C2  3               
0020C2  3               sprlst:
0020C2  3  A9 1C        	lda #<nmedat 			; list of enemy sprites.
0020C4  3  85 rr        	sta z80_l
0020C6  3  A9 70        	lda #>nmedat
0020C8  3  85 rr        	sta z80_h
0020CA  3  A6 rr        	ldx scno 			; screen number.
0020CC  3  D0 01        	bne sprls2 			; is it the first screen?
0020CE  3  60           	rts 				; yes, don't need to search data.
0020CF  3               sprls2:
0020CF  3  A0 00        	ldy #0
0020D1  3               sprls1:
0020D1  3  B1 rr        	lda (z80_hl),y 			; fetch type of sprite.
0020D3  3  C9 FF        	cmp #255			; is it an end marker?
0020D5  3  F0 0E        	beq sprls0 			; yes, end of this room.
0020D7  3               
0020D7  3  18           	clc 				; point to next sprite in list.
0020D8  3  A5 rr        	lda z80_l
0020DA  3  69 04        	adc #NMESIZ
0020DC  3  85 rr        	sta z80_l
0020DE  3  90 02        	bcc :+
0020E0  3  E6 rr        	inc z80_h
0020E2  3               :
0020E2  3  4C D1 20     	jmp sprls1 			; continue until end of room.
0020E5  3               sprls0:
0020E5  3  E6 rr        	inc z80_l 			; point to start of next screen.s
0020E7  3  D0 02        	bne :+
0020E9  3  E6 rr        	inc z80_h
0020EB  3               :
0020EB  3  CA           	dex
0020EC  3  D0 E3        	bne sprls1 			; continue until room found.
0020EE  3  60           	rts
0020EF  3               
0020EF  3               
0020EF  3               ;----------------------------------------------------
0020EF  3               ; Clear all but a single player sprite.
0020EF  3               ;
0020EF  3               ; global:	-
0020EF  3               ; local:	x,y,ix
0020EF  3               ; calls:	-
0020EF  3               ;----------------------------------------------------
0020EF  3               
0020EF  3               nspr:
0020EF  3  A9 0C        	lda #NUMSPR			; sprite slots in table.
0020F1  3  85 rr        	sta sprcnt
0020F3  3  A9 00        	lda #<sprtab 			; sprite table.
0020F5  3  85 rr        	sta z80_x
0020F7  3  A9 0B        	lda #>sprtab
0020F9  3  85 rr        	sta z80_i
0020FB  3               nspr0:
0020FB  3  A0 00        	ldy #0 				; fetch sprite type.
0020FD  3  B1 rr        	lda (z80_ix),y 			; is it a player?
0020FF  3  F0 1A        	beq nspr1 			; yes, keep this one.
002101  3               
002101  3  A9 FF        	lda #255
002103  3  A0 00        	ldy #0 				; fetch sprite type.
002105  3  91 rr        	sta (z80_ix),y 			; delete sprite.
002107  3  A0 05        	ldy #5
002109  3  91 rr        	sta (z80_ix),y 			; remove next type.
00210B  3               
00210B  3  18           	clc	 			; next sprite.
00210C  3  A5 rr        	lda z80_x
00210E  3  69 11        	adc #TABSIZ 			; distance to next odd/even entry.
002110  3  85 rr        	sta z80_x
002112  3  90 02        	bcc :+
002114  3  E6 rr        	inc z80_i
002116  3               :
002116  3  C6 rr        	dec sprcnt	 			; one less space in the table.
002118  3  D0 E1        	bne nspr0
00211A  3  60           	rts
00211B  3               nspr1:
00211B  3  A9 FF        	lda #255
00211D  3  A0 00        	ldy #0
00211F  3  91 rr        	sta (z80_ix),y 			; delete sprite.
002121  3               
002121  3  18           	clc	 			; point to next sprite.
002122  3  A5 rr        	lda z80_x
002124  3  69 11        	adc #TABSIZ 			; distance to next odd/even entry.
002126  3  85 rr        	sta z80_x
002128  3  90 02        	bcc :+
00212A  3  E6 rr        	inc z80_i
00212C  3               :
00212C  3  C6 rr        	dec sprcnt	 			; one less to do.
00212E  3  D0 01        	bne nspr2
002130  3  60           	rts
002131  3               nspr2:
002131  3  A9 FF        	lda #255
002133  3  A0 00        	ldy #0
002135  3  91 rr        	sta (z80_ix),y 			; delete sprite.
002137  3  A0 05        	ldy #5
002139  3  91 rr        	sta (z80_ix),y 			; remove next type.
00213B  3               
00213B  3  18           	clc	 			; next sprite.
00213C  3  A5 rr        	lda z80_x
00213E  3  69 11        	adc #TABSIZ 			; distance to next odd/even entry.
002140  3  85 rr        	sta z80_x
002142  3  90 02        	bcc :+
002144  3  E6 rr        	inc z80_i
002146  3               :
002146  3  C6 rr        	dec sprcnt	 			; one less space in table.
002148  3  D0 E7        	bne nspr2
00214A  3  60           	rts
00214B  3               
00214B  3               ;----------------------------------------------------------
00214B  3               ; Two initialisation routines.
00214B  3               ; Initialise sprites - copy everything from list to table.
00214B  3               ;
00214B  3               ; global:	-
00214B  3               ; local:	x,y,ix
00214B  3               ; calls:	cpsp
00214B  3               ;----------------------------------------------------------
00214B  3               
00214B  3               ispr:
00214B  3  A9 0C        	lda #NUMSPR			; sprite slots in table.
00214D  3  85 rr        	sta sprcnt
00214F  3  A9 00        	lda #<sprtab			; sprite table.
002151  3  85 rr        	sta z80_x
002153  3  A9 0B        	lda #>sprtab
002155  3  85 rr        	sta z80_i
002157  3               ispr2:
002157  3  A0 00        	ldy #0
002159  3  B1 rr        	lda (z80_hl),y 			; fetch byte.
00215B  3  C9 FF        	cmp #255 			; is it an end marker?
00215D  3  D0 01        	bne :+
00215F  3  60           	rts 				; yes, no more to do.
002160  3               :
002160  3               ispr1:
002160  3  A0 00        	ldy #0
002162  3  B1 rr        	lda (z80_ix),y 			; fetch sprite type.
002164  3  C9 FF        	cmp #255 			; is it enabled yet?
002166  3  D0 08        	bne ispr4			; yes, try another slot.
002168  3               
002168  3  A0 05        	ldy #5
00216A  3  B1 rr        	lda (z80_ix),y		 	; next type.
00216C  3  C9 FF        	cmp #255 			; is it enabled yet?
00216E  3  F0 10        	beq ispr3 			; no, process this one.
002170  3               ispr4:
002170  3  18           	clc 				; next sprite.
002171  3  A5 rr        	lda z80_x
002173  3  69 11        	adc #TABSIZ		 	; distance to next odd/even entry.
002175  3  85 rr        	sta z80_x
002177  3  90 02        	bcc :+
002179  3  E6 rr        	inc z80_i
00217B  3               :
00217B  3  C6 rr        	dec sprcnt
00217D  3  D0 E1        	bne ispr1 			; repeat for remaining sprites.
00217F  3  60           	rts  				; no more room in table.
002180  3               ispr3:
002180  3  20 D3 21     	jsr cpsp			; initialise a sprite.
002183  3  C6 rr        	dec sprcnt			; one less space in the table.
002185  3  D0 D0        	bne ispr2
002187  3  60           	rts
002188  3               
002188  3               
002188  3               ;-----------------------------------------------------------------------
002188  3               ; Initialise sprites - but not player, we're keeping the old one.
002188  3               ;
002188  3               ; global:	-
002188  3               ; local:	x,y,ix
002188  3               ; calls:	cpsp
002188  3               ;-----------------------------------------------------------------------
002188  3               
002188  3               kspr:
002188  3  A2 0C        	ldx #NUMSPR			; sprite slots in table.
00218A  3  A9 00        	lda #<sprtab 			; sprite table.
00218C  3  85 rr        	sta z80_x
00218E  3  A9 0B        	lda #>sprtab
002190  3  85 rr        	sta z80_i
002192  3               kspr2:
002192  3  A0 00        	ldy #0
002194  3  B1 rr        	lda (z80_hl),y 			; fetch byte.
002196  3  C9 FF        	cmp #255 			; is it an end marker?
002198  3  D0 01        	bne :+
00219A  3  60           	rts 				; yes, no more to do.
00219B  3               :
00219B  3  C9 00        	cmp #0
00219D  3  D0 0E        	bne kspr1 			; no, add to table as normal.
00219F  3               
00219F  3  18           	clc 				; next sprite.
0021A0  3  A5 rr        	lda z80_l
0021A2  3  69 04        	adc #NMESIZ		 	; distance to next odd/even entry.
0021A4  3  85 rr        	sta z80_l
0021A6  3  90 02        	bcc :+
0021A8  3  E6 rr        	inc z80_h
0021AA  3               :
0021AA  3  4C 92 21     	jmp kspr2
0021AD  3               kspr1:
0021AD  3  A0 00        	ldy #0 				; fetch sprite type.
0021AF  3  B1 rr        	lda (z80_ix),y
0021B1  3  C9 FF        	cmp #255 			; is it enabled yet?
0021B3  3  D0 08        	bne kspr4 			; yes, try another slot.
0021B5  3               
0021B5  3  A0 05        	ldy #5 				; next type.
0021B7  3  B1 rr        	lda (z80_ix),y
0021B9  3  C9 FF        	cmp #255 			; is it enabled yet?
0021BB  3  F0 0F        	beq kspr3 			; no, process this one.
0021BD  3               kspr4:
0021BD  3  18           	clc 				; next sprite.
0021BE  3  A5 rr        	lda z80_x
0021C0  3  69 11        	adc #TABSIZ		 	; distance to next odd/even entry.
0021C2  3  85 rr        	sta z80_x
0021C4  3  90 02        	bcc :+
0021C6  3  E6 rr        	inc z80_i
0021C8  3               :
0021C8  3  CA           	dex	 			; repeat for remaining sprites.
0021C9  3  D0 E2        	bne kspr1
0021CB  3  60           	rts  				; no more room in table.
0021CC  3               kspr3:
0021CC  3  20 D3 21     	jsr cpsp 			; copy sprite to table.
0021CF  3  CA           	dex	 			; one less space in the table.
0021D0  3  D0 C0        	bne kspr2
0021D2  3  60           	rts
0021D3  3               
0021D3  3               ;----------------------------------------------
0021D3  3               ; Copy sprite from list to table.
0021D3  3               ;
0021D3  3               ; global:	hl,ix
0021D3  3               ; local:	y
0021D3  3               ; calls:	evnt09
0021D3  3               ;----------------------------------------------
0021D3  3               
0021D3  3               cpsp:
0021D3  3  A0 00        	ldy #0					; fetch byte from table.
0021D5  3  B1 rr        	lda (z80_hl),y
0021D7  3               	; y=var_Type
0021D7  3  91 rr        	sta (z80_ix),y			; set up type.
0021D9  3  A0 05        	ldy #var_newType
0021DB  3  91 rr        	sta (z80_ix),y 			; set up type.
0021DD  3               
0021DD  3  E6 rr        	inc z80_l 				; move to next byte.
0021DF  3  D0 02        	bne :+
0021E1  3  E6 rr        	inc z80_h
0021E3  3               :
0021E3  3  A0 00        	ldy #0 					; fetch byte from table.
0021E5  3  B1 rr        	lda (z80_hl),y
0021E7  3  A0 06        	ldy #var_newImage
0021E9  3  91 rr        	sta (z80_ix),y			; set up image.
0021EB  3               
0021EB  3  E6 rr        	inc z80_l 				; move to next byte.
0021ED  3  D0 02        	bne :+
0021EF  3  E6 rr        	inc z80_h
0021F1  3               :
0021F1  3  A0 00        	ldy #0
0021F3  3  B1 rr        	lda (z80_hl),y 			; fetch byte from table.
0021F5  3  A0 08        	ldy #var_newY
0021F7  3  91 rr        	sta (z80_ix),y 			; set up coordinate.
0021F9  3               
0021F9  3  A9 C8        	lda #200 				; set initial coordinate off screen.
0021FB  3  A0 03        	ldy #var_Y
0021FD  3  91 rr        	sta (z80_ix),y
0021FF  3               
0021FF  3  E6 rr        	inc z80_l 				; move to next byte.
002201  3  D0 02        	bne :+
002203  3  E6 rr        	inc z80_h
002205  3               :
002205  3  A0 00        	ldy #0 					; fetch byte from table.
002207  3  B1 rr        	lda (z80_hl),y
002209  3  A0 09        	ldy #var_newX
00220B  3  91 rr        	sta (z80_ix),y 			; set up coordinate.
00220D  3               
00220D  3  E6 rr        	inc z80_l 				; move to next byte.
00220F  3  D0 02        	bne :+
002211  3  E6 rr        	inc z80_h
002213  3               :
002213  3  A9 00        	lda #0					; zeroes in accumulator.
002215  3  A0 07        	ldy #var_newFrame 		; reset frame number.
002217  3  91 rr        	sta (z80_ix),y
002219  3  A0 0A        	ldy #var_Direction 		; reset direction.
00221B  3  91 rr        	sta (z80_ix),y
00221D  3  A0 0D        	ldy #var_jumpLo			; reset jump pointer low.
00221F  3  91 rr        	sta (z80_ix),y
002221  3  A0 0E        	ldy #var_jumpHi	 		; reset jump pointer high.
002223  3  91 rr        	sta (z80_ix),y
002225  3               
002225  3  A9 FF        	lda #255 				; reset data pointer to auto-restore.
002227  3  A0 10        	ldy #var_dataHi
002229  3  91 rr        	sta (z80_ix),y
00222B  3               evis0:
00222B  3  A5 rr        	lda z80_i
00222D  3  48           	pha
00222E  3  A5 rr        	lda z80_x
002230  3  48           	pha
002231  3  A5 rr        	lda z80_h
002233  3  48           	pha
002234  3  A5 rr        	lda z80_l
002236  3  48           	pha
002237  3               
002237  3  20 61 45     	jsr evnt09 				; perform event.
00223A  3               
00223A  3  68           	pla
00223B  3  85 rr        	sta z80_l
00223D  3  68           	pla
00223E  3  85 rr        	sta z80_h
002240  3  68           	pla
002241  3  85 rr        	sta z80_x
002243  3  68           	pla
002244  3  85 rr        	sta z80_i
002246  3               
002246  3  18           	clc
002247  3  A5 rr        	lda z80_x 			; distance to next odd/even entry.
002249  3  69 11        	adc #TABSIZ		 	; next sprite.
00224B  3  85 rr        	sta z80_x
00224D  3  90 02        	bcc :+
00224F  3  E6 rr        	inc z80_i
002251  3               :
002251  3  60           	rts
002252  3               
002252  3               
002252  3               ;-------------------------------------
002252  3               ; Clear the play area window.
002252  3               ;-------------------------------------
002252  3               
002252  3               clw:
002252  3  AD 79 10     	lda wintop			; get coordinates of window.
002255  3  85 rr        	sta dispy			; put into dispx for calculation.
002257  3  AD 7A 10     	lda winlft
00225A  3  85 rr        	sta dispx
00225C  3               
00225C  3  AD 7B 10     	lda winhgt			; height of window.
00225F  3  85 rr        	sta rrow			; copy to b register.
002261  3               clw3:
002261  3  AD 7C 10     	lda winwid 			; width of window.
002264  3  85 rr        	sta rcol
002266  3               clw2:
002266  3  20 6E 16     	jsr gprad 			; get print address.
002269  3  A9 00        	lda #0				; zero byte to write.
00226B  3  A2 07        	ldx #7				; pixel height of each cell.
00226D  3               clw1:
00226D  3  BC 65 10     	ldy scrtab,x
002270  3  91 rr        	sta (scraddr),y 			; copy to screen.
002272  3  CA           	dex				; next screen row down.
002273  3  10 F8        	bpl clw1
002275  3               
002275  3  E6 rr        	inc dispx			; next column.
002277  3  C6 rr        	dec rcol			; one less to do.
002279  3  D0 EB        	bne clw2			; repeat for remaining columns.
00227B  3               
00227B  3  AD 7A 10     	lda winlft			; get left edge.
00227E  3  85 rr        	sta dispx 			; reset x.
002280  3  E6 rr        	inc dispy 			; next line down.
002282  3               
002282  3  C6 rr        	dec rrow
002284  3  D0 DB        	bne clw3			; repeat down the screen.
002286  3               
002286  3  AD 79 10     	lda wintop			; get coordinates of window.
002289  3  85 rr        	sta chary			; put into display position.
00228B  3  AD 7A 10     	lda winlft
00228E  3  85 rr        	sta charx
002290  3  60           	rts
002291  3               
002291  3               
002291  3               ;----------------------------------------------------------
002291  3               ; Effects code.
002291  3               ; Ticker routine is called 25 times per second.
002291  3               ;
002291  3               ; HL = txtscr = left text screen address
002291  3               ; DE = txtscr+txtwid-1 = right text screen address
002291  3               ; BC = txtpos = text scroller position
002291  3               ;
002291  3               ;----------------------------------------------------------
002291  3               
002291  3               .if sflag
002291  3               scrly:
002291  3               	rts
002291  3               	.word txtscr         	; get left screen address.
002291  3               	sta scr_l
002291  3               	lda txtscr+1
002291  3               	sta scr_l+1
002291  3               	sta scr_r+1
002291  3               
002291  3               	stx xtmp
002291  3               
002291  3               	clc         		; get right screen address.
002291  3               	lda scr_l
002291  3               	adc txtwid
002291  3               	sta scr_r
002291  3               	dec scr_r
002291  3               scrly1:
002291  3               	ldy txtwid		; set txtwide
002291  3               	dey
002291  3               	clc
002291  3               scrly0:
002291  3               	lda (scr_l),y		; scroll 1 line
002291  3               	rol a
002291  3               	sta (scr_l),y
002291  3               	dey
002291  3               	bpl scrly0
002291  3               
002291  3               	clc			; point to next line
002291  3               	lda scr_l
002291  3               	adc #32
002291  3               	sta scr_l
002291  3               	bcc scrly1		; repeat 8 times
002291  3               
002291  3               	lda txtpos 		; get text pointer.
002291  3               	sta scr_txt
002291  3               	lda txtpos+1
002291  3               	sta scr_txt+1
002291  3               
002291  3               	ldy #0
002291  3               	lda (scr_txt),y 		; find character we're displaying.
002291  3               	and #127 		; remove end marker bit if applicable.
002291  3               	cmp #ASCII_NEWLINE			; is it newline?
002291  3               	bne scrly5 		; no, it's okay.
002291  3               	lda #32			; convert to a space instead.
002291  3               scrly5:
002291  3               	sta fntaddr		; calculate char address
002291  3               	lda #0
002291  3               	sta fntaddr+1
002291  3               	asl fntaddr  		; multiply char by 8.
002291  3               	rol fntaddr+1
002291  3               	asl fntaddr
002291  3               	rol fntaddr+1
002291  3               	asl fntaddr
002291  3               	rol fntaddr+1
002291  3               	lda fntaddr
002291  3               	clc
002291  3               	adc FontPtr
002291  3               	sta scrly3+1		; that's the low byte.
002291  3               	lda fntaddr+1
002291  3               	adc FontPtr+1
002291  3               	sta scrly3+2		; add displacement.
002291  3               
002291  3               	ldx #0
002291  3               scrly3:
002291  3               	lda $3333,x		; get image of char line.
002291  3               	and txtbit
002291  3               	beq scrly2		; don't plot pixel
002291  3               	ldy scrline,x
002291  3               	lda (scr_r),y
002291  3               	clc
002291  3               	ora #1
002291  3               	sta (scr_r),y		; plot pixel
002291  3               scrly2:
002291  3               	inx			; next line of char.
002291  3               	cpx #8
002291  3               	bne scrly3
002291  3               
002291  3               	lsr txtbit		; bit of text to display.
002291  3               	bcs :+
002291  3               	rts
002291  3               :
002291  3               	ldy #0
002291  3               	lda (scr_txt),y 	; what was the character?
002291  3               	asl a	  		; end of message?
002291  3               	bcs scrly4
002291  3               	inc txtpos
002291  3               	bne :+
002291  3               	inc txtpos+1
002291  3               :
002291  3               	jmp scrly6 		; not yet - continue.
002291  3               scrly4:
002291  3               	lda txtini 		; start of scrolling message.
002291  3               	sta txtpos
002291  3               	lda txtini+1
002291  3               	sta txtpos+1
002291  3               scrly6:
002291  3               	lda #128
002291  3               	sta txtbit
002291  3               	ldx xtmp
002291  3               	rts
002291  3               
002291  3               scrline:	.byte $00,$20,$40,$60,$80,$a0,$c0,$e0
002291  3               
002291  3               ;-------------------------------------------------------
002291  3               ; Entry TICKER command
002291  3               ;
002291  3               ; Entry:
002291  3               ;  z80_b = message nr
002291  3               ;  z80_c = width
002291  3               ;-------------------------------------------------------
002291  3               
002291  3               iscrly:
002291  3               	jsr prescr 		; set up display position.
002291  3               
002291  3               	lda #<msgdat 		; text messages.
002291  3               	sta z80_l
002291  3               	lda #>msgdat
002291  3               	sta z80_h
002291  3               
002291  3               	lda z80_c 		; width.
002291  3               	sec
002291  3               	sbc #1			; subtract one.
002291  3               	cmp #32 		; is it between 1 and 32?
002291  3               	bcc :+
002291  3               	lda #$60
002291  3               	jmp iscrl0		; no, disable messages.
002291  3               :
002291  3               	ldx z80_b		; message number.
002291  3               	jsr getwrd 		; find message start.
002291  3               
002291  3               	lda z80_l		; set initial text position.
002291  3               	sta txtini
002291  3               	lda z80_h
002291  3               	sta txtini+1
002291  3               
002291  3               	lda #$ad		; code for lda adrr
002291  3               iscrl0:
002291  3               	sta scrly		; enable/disable scrolling routine.
002291  3               
002291  3               	jsr prescr 		; set up display position.
002291  3               	jsr gprad 		; get print address.
002291  3               
002291  3               	lda scraddr 		; set text screen address.
002291  3               	sta txtscr
002291  3               	lda scraddr+1
002291  3               	sta txtscr+1
002291  3               
002291  3               	lda z80_c		; width.
002291  3               	sta txtwid		; set width in working storage.
002291  3               
002291  3               	lda #128 		; start with leftmost bit.
002291  3               	sta txtbit
002291  3               
002291  3               	jmp scrly4
002291  3               .endif
002291  3               
002291  3               ;------------------------------------------------------------------
002291  3               ; Sprite table
002291  3               ;------------------------------------------------------------------
002291  3               
002291  3               
002291  3               ; ix+0  = type.
002291  3               ; ix+1  = sprite image number.
002291  3               ; ix+2  = frame.
002291  3               ; ix+3  = y coord.
002291  3               ; ix+4  = x coord.
002291  3               
002291  3               ; ix+5  = new type.
002291  3               ; ix+6  = new image number.
002291  3               ; ix+7  = new frame.
002291  3               ; ix+8  = new y coord.
002291  3               ; ix+9  = new x coord.
002291  3               
002291  3               ; ix+10 = direction.
002291  3               ; ix+11 = parameter 1.
002291  3               ; ix+12 = parameter 2.
002291  3               ; ix+13 = jump pointer low.
002291  3               ; ix+14 = jump pointer high.
002291  3               ; ix+15 = data pointer low.
002291  3               ; ix+16 = data pointer high.
002291  3               
002291  3               ; block NUMSPR * TABSIZ,255
002291  3               ; sprtab NUMSPR*TABSIZ,255
002291  3               
002291  3  FF FF FF FF  ssprit:	.byte 255,255,255,255,255,255,255,0,192,120,0,0,0,255,255,255,255
002295  3  FF FF FF 00  
002299  3  C0 78 00 00  
0022A2  3  07           roomtb:	.byte 7                      ; start room map offset.
0022A3  3               
0022A3  3               ; User routine.  Put your own code in here to be called with USER instruction.
0022A3  3               ; if USER has an argument it will be passed in the accumulator.
0022A3  3               
0022A3  3               user:
0022A3  3  60           	rts
0022A4  3               
0022A4  3               ; Everything below here will be generated by the editors.
0022A4  3               
0022A4  3               script_start:
0022A4  3               
0022A4  3               WINDOWTOP = 0
0022A4  3               WINDOWLFT = 0
0022A4  3               WINDOWHGT = 23
0022A4  3               WINDOWWID = 26 ;
0022A4  3               MAPWID = 3
0022A4  3  FF FF FF             .byte 255,255,255
0022A7  3               mapdat:
0022A7  3  FF 00 FF             .byte 255,0,255
0022AA  3  FF FF FF             .byte 255,255,255
0022AD  3  01           stmap:  .byte 1
0022AE  3               
0022AE  3               evnt00:
0022AE  3  A9 04                lda #4
0022B0  3  C5 rr                cmp varg
0022B2  3  F0 03                beq *+5
0022B4  3  4C D0 22             jmp a00095
0022B7  3  A9 00                lda #0
0022B9  3                       ; ldy #6
0022B9  3  A0 06                ldy #6
0022BB  3  91 rr                sta (z80_ix),y
0022BD  3  A9 00                lda #0
0022BF  3                       ; ldy #7
0022BF  3  C8                   iny
0022C0  3  91 rr                sta (z80_ix),y
0022C2  3  A9 B0                lda #176
0022C4  3                       ; ldy #8
0022C4  3  C8                   iny
0022C5  3  91 rr                sta (z80_ix),y
0022C7  3  A9 00                lda #0
0022C9  3                       ; ldy #9
0022C9  3  C8                   iny
0022CA  3  91 rr                sta (z80_ix),y
0022CC  3  A9 00                lda #0
0022CE  3  85 rr                sta varg
0022D0  3  A9 03        a00095: lda #3
0022D2  3  C5 rr                cmp varg
0022D4  3  F0 03                beq *+5
0022D6  3  4C E4 22             jmp a00146
0022D9  3  A9 13                lda #19
0022DB  3                       ; ldy #6
0022DB  3  A0 06                ldy #6
0022DD  3  91 rr                sta (z80_ix),y
0022DF  3  A9 01                lda #1
0022E1  3                       ; ldy #7
0022E1  3  C8                   iny
0022E2  3  91 rr                sta (z80_ix),y
0022E4  3               a00146: ; ldy #8
0022E4  3  A0 08                ldy #8
0022E6  3  B1 rr                lda (z80_ix),y
0022E8  3  85 rr                sta vara
0022EA  3                       ; ldy #9
0022EA  3  C8                   iny
0022EB  3  B1 rr                lda (z80_ix),y
0022ED  3  85 rr                sta varb
0022EF  3  A9 01                lda #1
0022F1  3  C5 rr                cmp varl
0022F3  3  F0 03                beq *+5
0022F5  3  4C 21 23             jmp a00298
0022F8  3  A9 08                lda #8
0022FA  3  85 rr                sta z80_c
0022FC  3  A9 09                lda #9
0022FE  3  85 rr                sta z80_b
002300  3  20 79 14             jsr spawn
002303  3  A5 rr                lda spptr
002305  3  85 rr                sta z80_x
002307  3  A5 rr                lda spptr+1
002309  3  85 rr                sta z80_i
00230B  3  A9 28                lda #40
00230D  3                       ; ldy #8
00230D  3  88                   dey
00230E  3  91 rr                sta (z80_ix),y
002310  3  A9 60                lda #96
002312  3                       ; ldy #9
002312  3  C8                   iny
002313  3  91 rr                sta (z80_ix),y
002315  3  A9 63                lda #99
002317  3  85 rr                sta varl
002319  3  A5 rr                lda ogptr
00231B  3  85 rr                sta z80_x
00231D  3  A5 rr                lda ogptr+1
00231F  3  85 rr                sta z80_i
002321  3  A5 rr        a00298: lda varg
002323  3  C9 02                cmp #2
002325  3  90 03                bcc *+5
002327  3  4C 94 24             jmp a01164
00232A  3  20 20 14             jsr skobj
00232D  3  85 rr                sta varobj
00232F  3  A9 08                lda #8
002331  3  C5 rr                cmp varobj
002333  3  F0 03                beq *+5
002335  3  4C 78 23             jmp a00468
002338  3  A5 rr                lda varobj
00233A  3  20 9F 13             jsr getob
00233D  3  A9 03                lda #3
00233F  3  85 rr                sta z80_c
002341  3  A5 rr                lda vark
002343  3  18                   clc
002344  3  65 rr                adc z80_c
002346  3  85 rr                sta vark
002348  3  A9 07                lda #7
00234A  3  85 rr                sta chary
00234C  3  A9 1D                lda #29
00234E  3  85 rr                sta charx
002350  3  A9 18                lda #24
002352  3  20 ED 1A             jsr dmsg
002355  3  A9 07                lda #7
002357  3  85 rr                sta chary
002359  3  A9 1D                lda #29
00235B  3  85 rr                sta charx
00235D  3  A5 rr                lda vark
00235F  3  20 34 1F             jsr disply
002362  3  A9 32                lda #50
002364  3  0A                   asl a
002365  3  8D DD 0E             sta sndtyp
002368  3  A9 0F                lda #15
00236A  3  C5 rr                cmp vark
00236C  3  90 03                bcc *+5
00236E  3  4C 75 23             jmp a00463
002371  3  A9 0F                lda #15
002373  3  85 rr                sta vark
002375  3  4C 9C 23     a00463: jmp a00564
002378  3  A9 58        a00468: lda #88
00237A  3                       ; ldy #8
00237A  3  A0 08                ldy #8
00237C  3  91 rr                sta (z80_ix),y
00237E  3  A9 60                lda #96
002380  3                       ; ldy #9
002380  3  C8                   iny
002381  3  91 rr                sta (z80_ix),y
002383  3  20 20 14             jsr skobj
002386  3  85 rr                sta varobj
002388  3  A9 08                lda #8
00238A  3  C5 rr                cmp varobj
00238C  3  F0 03                beq *+5
00238E  3  4C 91 23             jmp a00529
002391  3  A5 rr        a00529: lda vara
002393  3                       ; ldy #8
002393  3  A0 08                ldy #8
002395  3  91 rr                sta (z80_ix),y
002397  3  A5 rr                lda varb
002399  3                       ; ldy #9
002399  3  C8                   iny
00239A  3  91 rr                sta (z80_ix),y
00239C  3  A9 01        a00564: lda #1
00239E  3  85 rr                sta z80_b
0023A0  3  20 A4 1E             jsr sktyp
0023A3  3  B0 03                bcs :+
0023A5  3  4C 94 24             jmp a01164
0023A8  3               :
0023A8  3  A5 rr                lda skptr
0023AA  3  85 rr                sta z80_x
0023AC  3  A5 rr                lda skptr+1
0023AE  3  85 rr                sta z80_i
0023B0  3                       ; ldy #8
0023B0  3  A0 08                ldy #8
0023B2  3  B1 rr                lda (z80_ix),y
0023B4  3  85 rr                sta varo
0023B6  3                       ; ldy #9
0023B6  3  C8                   iny
0023B7  3  B1 rr                lda (z80_ix),y
0023B9  3  85 rr                sta varp
0023BB  3  A5 rr                lda ogptr
0023BD  3  85 rr                sta z80_x
0023BF  3  A5 rr                lda ogptr+1
0023C1  3  85 rr                sta z80_i
0023C3  3  A5 rr                lda varo
0023C5  3  85 rr                sta varq
0023C7  3                       ; ldy #8
0023C7  3  88                   dey
0023C8  3  B1 rr                lda (z80_ix),y
0023CA  3  C5 rr                cmp varq
0023CC  3  90 03                bcc *+5
0023CE  3  4C DF 23             jmp a00728
0023D1  3                       ; ldy #8
0023D1  3  B1 rr                lda (z80_ix),y
0023D3  3  85 rr                sta z80_c
0023D5  3  A5 rr                lda varq
0023D7  3  38                   sec
0023D8  3  E5 rr                sbc z80_c
0023DA  3  85 rr                sta varq
0023DC  3  4C F0 23             jmp a00771
0023DF  3               a00728: ; ldy #8
0023DF  3  A0 08                ldy #8
0023E1  3  B1 rr                lda (z80_ix),y
0023E3  3  85 rr                sta varq
0023E5  3  A5 rr                lda varo
0023E7  3  85 rr                sta z80_c
0023E9  3  A5 rr                lda varq
0023EB  3  38                   sec
0023EC  3  E5 rr                sbc z80_c
0023EE  3  85 rr                sta varq
0023F0  3  A5 rr        a00771: lda varq
0023F2  3  C9 0C                cmp #12
0023F4  3  90 03                bcc *+5
0023F6  3  4C 27 24             jmp a00901
0023F9  3  A5 rr                lda varp
0023FB  3  85 rr                sta varq
0023FD  3                       ; ldy #9
0023FD  3  A0 09                ldy #9
0023FF  3  B1 rr                lda (z80_ix),y
002401  3  C5 rr                cmp varq
002403  3  90 03                bcc *+5
002405  3  4C 16 24             jmp a00858
002408  3                       ; ldy #9
002408  3  B1 rr                lda (z80_ix),y
00240A  3  85 rr                sta z80_c
00240C  3  A5 rr                lda varq
00240E  3  38                   sec
00240F  3  E5 rr                sbc z80_c
002411  3  85 rr                sta varq
002413  3  4C 27 24             jmp a00901
002416  3               a00858: ; ldy #9
002416  3  A0 09                ldy #9
002418  3  B1 rr                lda (z80_ix),y
00241A  3  85 rr                sta varq
00241C  3  A5 rr                lda varp
00241E  3  85 rr                sta z80_c
002420  3  A5 rr                lda varq
002422  3  38                   sec
002423  3  E5 rr                sbc z80_c
002425  3  85 rr                sta varq
002427  3  A5 rr        a00901: lda varq
002429  3  C9 0C                cmp #12
00242B  3  90 03                bcc *+5
00242D  3  4C 94 24             jmp a01164
002430  3  A9 13                lda #19
002432  3                       ; ldy #6
002432  3  A0 06                ldy #6
002434  3  91 rr                sta (z80_ix),y
002436  3  A9 00                lda #0
002438  3  C5 rr                cmp varg
00243A  3  F0 03                beq *+5
00243C  3  4C 43 24             jmp a00961
00243F  3  A9 03                lda #3
002441  3  85 rr                sta varg
002443  3  A9 01        a00961: lda #1
002445  3  C5 rr                cmp varg
002447  3  F0 03                beq *+5
002449  3  4C 50 24             jmp a00985
00244C  3  A9 06                lda #6
00244E  3  85 rr                sta varg
002450  3  A9 06        a00985: lda #6
002452  3  85 rr                sta z80_c
002454  3  A9 00                lda #0
002456  3  85 rr                sta z80_b
002458  3  20 79 14             jsr spawn
00245B  3  A5 rr                lda spptr
00245D  3  85 rr                sta z80_x
00245F  3  A5 rr                lda spptr+1
002461  3  85 rr                sta z80_i
002463  3  A9 C8                lda #200
002465  3                       ; ldy #12
002465  3  A0 0C                ldy #12
002467  3  91 rr                sta (z80_ix),y
002469  3  A9 00                lda #0
00246B  3                       ; ldy #6
00246B  3  A0 06                ldy #6
00246D  3  91 rr                sta (z80_ix),y
00246F  3  A5 rr                lda ogptr
002471  3  85 rr                sta z80_x
002473  3  A5 rr                lda ogptr+1
002475  3  85 rr                sta z80_i
002477  3  A9 13                lda #19
002479  3                       ; ldy #6
002479  3  91 rr                sta (z80_ix),y
00247B  3  A9 01                lda #1
00247D  3                       ; ldy #7
00247D  3  C8                   iny
00247E  3  91 rr                sta (z80_ix),y
002480  3  A9 00                lda #0
002482  3                       ; ldy #8
002482  3  C8                   iny
002483  3  91 rr                sta (z80_ix),y
002485  3  A9 F0                lda #240
002487  3                       ; ldy #9
002487  3  C8                   iny
002488  3  91 rr                sta (z80_ix),y
00248A  3  A9 03                lda #3
00248C  3  C5 rr                cmp varg
00248E  3  F0 03                beq *+5
002490  3  4C 94 24             jmp a01164
002493  3  60                   rts
002494  3  A5 rr        a01164: lda varh
002496  3  85 rr                sta vars
002498  3  A5 rr                lda varh
00249A  3  85 rr                sta vart
00249C  3  A5 rr                lda vars
00249E  3  4A                   lsr a
00249F  3  4A                   lsr a
0024A0  3  4A                   lsr a
0024A1  3  4A                   lsr a
0024A2  3  85 rr                sta vars
0024A4  3  A5 rr                lda vars
0024A6  3  85 rr                sta varq
0024A8  3  A5 rr                lda varq
0024AA  3  0A                   asl a
0024AB  3  0A                   asl a
0024AC  3  0A                   asl a
0024AD  3  0A                   asl a
0024AE  3  85 rr                sta varq
0024B0  3  A5 rr                lda varq
0024B2  3  85 rr                sta z80_c
0024B4  3  A5 rr                lda vart
0024B6  3  38                   sec
0024B7  3  E5 rr                sbc z80_c
0024B9  3  85 rr                sta vart
0024BB  3  A9 03                lda #3
0024BD  3  C5 rr                cmp scno
0024BF  3  F0 03                beq *+5
0024C1  3  4C C8 24             jmp a01284
0024C4  3  A9 63                lda #99
0024C6  3  85 rr                sta vart
0024C8  3  A9 01        a01284: lda #1
0024CA  3  C5 rr                cmp varg
0024CC  3  90 03                bcc *+5
0024CE  3  4C DB 24             jmp a01321
0024D1  3  A5 rr                lda varg
0024D3  3  C9 05                cmp #5
0024D5  3  90 03                bcc *+5
0024D7  3  4C DB 24             jmp a01321
0024DA  3  60                   rts
0024DB  3  A9 FF        a01321: lda #255
0024DD  3  85 rr                sta varobj
0024DF  3  A9 00                lda #0
0024E1  3  C5 rr                cmp varg
0024E3  3  F0 03                beq *+5
0024E5  3  4C F3 24             jmp a01374
0024E8  3  20 20 14             jsr skobj
0024EB  3  85 rr                sta varobj
0024ED  3  A9 FF                lda #255
0024EF  3                       ; ldy #10
0024EF  3  A0 0A                ldy #10
0024F1  3  91 rr                sta (z80_ix),y
0024F3  3  A9 18        a01374: lda #24
0024F5  3                       ; ldy #9
0024F5  3  A0 09                ldy #9
0024F7  3  91 rr                sta (z80_ix),y
0024F9  3  A9 18                lda #24
0024FB  3                       ; ldy #8
0024FB  3  88                   dey
0024FC  3  91 rr                sta (z80_ix),y
0024FE  3  A9 01                lda #1
002500  3  C5 rr                cmp scno
002502  3  90 03                bcc *+5
002504  3  4C 0B 25             jmp a01440
002507  3  A9 30                lda #48
002509  3                       ; ldy #8
002509  3  91 rr                sta (z80_ix),y
00250B  3  A9 05        a01440: lda #5
00250D  3  C5 rr                cmp varg
00250F  3  F0 03                beq *+5
002511  3  4C 29 25             jmp a01509
002514  3  A9 00                lda #0
002516  3  20 9F 13             jsr getob
002519  3                       ; ldy #9
002519  3  A0 09                ldy #9
00251B  3  B1 rr                lda (z80_ix),y
00251D  3  85 rr                sta dispx
00251F  3                       ; ldy #8
00251F  3  88                   dey
002520  3  B1 rr                lda (z80_ix),y
002522  3  85 rr                sta dispy
002524  3  A9 00                lda #0
002526  3  20 FF 13             jsr drpob
002529  3  A9 06        a01509: lda #6
00252B  3  C5 rr                cmp varg
00252D  3  F0 03                beq *+5
00252F  3  4C 4C 25             jmp a01595
002532  3  A9 00                lda #0
002534  3                       ; ldy #10
002534  3  A0 0A                ldy #10
002536  3  D1 rr                cmp (z80_ix),y
002538  3  F0 03                beq *+5
00253A  3  4C 4C 25             jmp a01595
00253D  3                       ; ldy #9
00253D  3  88                   dey
00253E  3  B1 rr                lda (z80_ix),y
002540  3  85 rr                sta dispx
002542  3                       ; ldy #8
002542  3  88                   dey
002543  3  B1 rr                lda (z80_ix),y
002545  3  85 rr                sta dispy
002547  3  A9 00                lda #0
002549  3  20 FF 13             jsr drpob
00254C  3  A9 00        a01595: lda #0
00254E  3  85 rr                sta vard
002550  3  A9 00                lda #0
002552  3  C5 rr                cmp varobj
002554  3  F0 03                beq *+5
002556  3  4C 6C 25             jmp a01672
002559  3                       ; ldy #8
002559  3  A0 08                ldy #8
00255B  3  B1 rr                lda (z80_ix),y
00255D  3  85 rr                sta varo
00255F  3                       ; ldy #9
00255F  3  C8                   iny
002560  3  B1 rr                lda (z80_ix),y
002562  3  85 rr                sta varp
002564  3  A9 02                lda #2
002566  3  85 rr                sta varg
002568  3  A9 01                lda #1
00256A  3  85 rr                sta vard
00256C  3  A9 A8        a01672: lda #168
00256E  3                       ; ldy #9
00256E  3  A0 09                ldy #9
002570  3  91 rr                sta (z80_ix),y
002572  3  A9 01                lda #1
002574  3  C5 rr                cmp varobj
002576  3  F0 03                beq *+5
002578  3  4C 8D 25             jmp a01758
00257B  3                       ; ldy #8
00257B  3  88                   dey
00257C  3  B1 rr                lda (z80_ix),y
00257E  3  85 rr                sta varo
002580  3                       ; ldy #9
002580  3  C8                   iny
002581  3  B1 rr                lda (z80_ix),y
002583  3  85 rr                sta varp
002585  3  A9 02                lda #2
002587  3  85 rr                sta varg
002589  3  A9 01                lda #1
00258B  3  85 rr                sta vard
00258D  3  A9 05        a01758: lda #5
00258F  3  C5 rr                cmp varg
002591  3  F0 03                beq *+5
002593  3  4C AB 25             jmp a01827
002596  3  A9 01                lda #1
002598  3  20 9F 13             jsr getob
00259B  3                       ; ldy #9
00259B  3  A0 09                ldy #9
00259D  3  B1 rr                lda (z80_ix),y
00259F  3  85 rr                sta dispx
0025A1  3                       ; ldy #8
0025A1  3  88                   dey
0025A2  3  B1 rr                lda (z80_ix),y
0025A4  3  85 rr                sta dispy
0025A6  3  A9 01                lda #1
0025A8  3  20 FF 13             jsr drpob
0025AB  3  A9 06        a01827: lda #6
0025AD  3  C5 rr                cmp varg
0025AF  3  F0 03                beq *+5
0025B1  3  4C CE 25             jmp a01913
0025B4  3  A9 01                lda #1
0025B6  3                       ; ldy #10
0025B6  3  A0 0A                ldy #10
0025B8  3  D1 rr                cmp (z80_ix),y
0025BA  3  F0 03                beq *+5
0025BC  3  4C CE 25             jmp a01913
0025BF  3                       ; ldy #9
0025BF  3  88                   dey
0025C0  3  B1 rr                lda (z80_ix),y
0025C2  3  85 rr                sta dispx
0025C4  3                       ; ldy #8
0025C4  3  88                   dey
0025C5  3  B1 rr                lda (z80_ix),y
0025C7  3  85 rr                sta dispy
0025C9  3  A9 01                lda #1
0025CB  3  20 FF 13             jsr drpob
0025CE  3  A9 98        a01913: lda #152
0025D0  3                       ; ldy #8
0025D0  3  A0 08                ldy #8
0025D2  3  91 rr                sta (z80_ix),y
0025D4  3  A9 01                lda #1
0025D6  3  C5 rr                cmp scno
0025D8  3  90 03                bcc *+5
0025DA  3  4C E1 25             jmp a01962
0025DD  3  A9 80                lda #128
0025DF  3                       ; ldy #8
0025DF  3  91 rr                sta (z80_ix),y
0025E1  3  A9 02        a01962: lda #2
0025E3  3  C5 rr                cmp varobj
0025E5  3  F0 03                beq *+5
0025E7  3  4C F9 25             jmp a02023
0025EA  3                       ; ldy #8
0025EA  3  A0 08                ldy #8
0025EC  3  B1 rr                lda (z80_ix),y
0025EE  3  85 rr                sta varo
0025F0  3                       ; ldy #9
0025F0  3  C8                   iny
0025F1  3  B1 rr                lda (z80_ix),y
0025F3  3  85 rr                sta varp
0025F5  3  A9 02                lda #2
0025F7  3  85 rr                sta varg
0025F9  3  A9 05        a02023: lda #5
0025FB  3  C5 rr                cmp varg
0025FD  3  F0 03                beq *+5
0025FF  3  4C 17 26             jmp a02092
002602  3  A9 02                lda #2
002604  3  20 9F 13             jsr getob
002607  3                       ; ldy #9
002607  3  A0 09                ldy #9
002609  3  B1 rr                lda (z80_ix),y
00260B  3  85 rr                sta dispx
00260D  3                       ; ldy #8
00260D  3  88                   dey
00260E  3  B1 rr                lda (z80_ix),y
002610  3  85 rr                sta dispy
002612  3  A9 02                lda #2
002614  3  20 FF 13             jsr drpob
002617  3  A9 06        a02092: lda #6
002619  3  C5 rr                cmp varg
00261B  3  F0 03                beq *+5
00261D  3  4C 3A 26             jmp a02179
002620  3  A9 02                lda #2
002622  3                       ; ldy #10
002622  3  A0 0A                ldy #10
002624  3  D1 rr                cmp (z80_ix),y
002626  3  F0 03                beq *+5
002628  3  4C 3A 26             jmp a02179
00262B  3                       ; ldy #9
00262B  3  88                   dey
00262C  3  B1 rr                lda (z80_ix),y
00262E  3  85 rr                sta dispx
002630  3                       ; ldy #8
002630  3  88                   dey
002631  3  B1 rr                lda (z80_ix),y
002633  3  85 rr                sta dispy
002635  3  A9 02                lda #2
002637  3  20 FF 13             jsr drpob
00263A  3  A9 18        a02179: lda #24
00263C  3                       ; ldy #9
00263C  3  A0 09                ldy #9
00263E  3  91 rr                sta (z80_ix),y
002640  3  A9 03                lda #3
002642  3  C5 rr                cmp varobj
002644  3  F0 03                beq *+5
002646  3  4C 57 26             jmp a02256
002649  3                       ; ldy #8
002649  3  88                   dey
00264A  3  B1 rr                lda (z80_ix),y
00264C  3  85 rr                sta varo
00264E  3                       ; ldy #9
00264E  3  C8                   iny
00264F  3  B1 rr                lda (z80_ix),y
002651  3  85 rr                sta varp
002653  3  A9 02                lda #2
002655  3  85 rr                sta varg
002657  3  A9 05        a02256: lda #5
002659  3  C5 rr                cmp varg
00265B  3  F0 03                beq *+5
00265D  3  4C 75 26             jmp a02325
002660  3  A9 03                lda #3
002662  3  20 9F 13             jsr getob
002665  3                       ; ldy #9
002665  3  A0 09                ldy #9
002667  3  B1 rr                lda (z80_ix),y
002669  3  85 rr                sta dispx
00266B  3                       ; ldy #8
00266B  3  88                   dey
00266C  3  B1 rr                lda (z80_ix),y
00266E  3  85 rr                sta dispy
002670  3  A9 03                lda #3
002672  3  20 FF 13             jsr drpob
002675  3  A9 06        a02325: lda #6
002677  3  C5 rr                cmp varg
002679  3  F0 03                beq *+5
00267B  3  4C 98 26             jmp a02412
00267E  3  A9 03                lda #3
002680  3                       ; ldy #10
002680  3  A0 0A                ldy #10
002682  3  D1 rr                cmp (z80_ix),y
002684  3  F0 03                beq *+5
002686  3  4C 98 26             jmp a02412
002689  3                       ; ldy #9
002689  3  88                   dey
00268A  3  B1 rr                lda (z80_ix),y
00268C  3  85 rr                sta dispx
00268E  3                       ; ldy #8
00268E  3  88                   dey
00268F  3  B1 rr                lda (z80_ix),y
002691  3  85 rr                sta dispy
002693  3  A9 03                lda #3
002695  3  20 FF 13             jsr drpob
002698  3  A9 60        a02412: lda #96
00269A  3                       ; ldy #9
00269A  3  A0 09                ldy #9
00269C  3  91 rr                sta (z80_ix),y
00269E  3  A9 10                lda #16
0026A0  3                       ; ldy #8
0026A0  3  88                   dey
0026A1  3  91 rr                sta (z80_ix),y
0026A3  3  A9 04                lda #4
0026A5  3  C5 rr                cmp varobj
0026A7  3  F0 03                beq *+5
0026A9  3  4C B9 26             jmp a02503
0026AC  3                       ; ldy #8
0026AC  3  B1 rr                lda (z80_ix),y
0026AE  3  85 rr                sta varo
0026B0  3                       ; ldy #9
0026B0  3  C8                   iny
0026B1  3  B1 rr                lda (z80_ix),y
0026B3  3  85 rr                sta varp
0026B5  3  A9 02                lda #2
0026B7  3  85 rr                sta varg
0026B9  3  A9 05        a02503: lda #5
0026BB  3  C5 rr                cmp varg
0026BD  3  F0 03                beq *+5
0026BF  3  4C D7 26             jmp a02572
0026C2  3  A9 04                lda #4
0026C4  3  20 9F 13             jsr getob
0026C7  3                       ; ldy #9
0026C7  3  A0 09                ldy #9
0026C9  3  B1 rr                lda (z80_ix),y
0026CB  3  85 rr                sta dispx
0026CD  3                       ; ldy #8
0026CD  3  88                   dey
0026CE  3  B1 rr                lda (z80_ix),y
0026D0  3  85 rr                sta dispy
0026D2  3  A9 04                lda #4
0026D4  3  20 FF 13             jsr drpob
0026D7  3  A9 06        a02572: lda #6
0026D9  3  C5 rr                cmp varg
0026DB  3  F0 03                beq *+5
0026DD  3  4C FA 26             jmp a02659
0026E0  3  A9 04                lda #4
0026E2  3                       ; ldy #10
0026E2  3  A0 0A                ldy #10
0026E4  3  D1 rr                cmp (z80_ix),y
0026E6  3  F0 03                beq *+5
0026E8  3  4C FA 26             jmp a02659
0026EB  3                       ; ldy #9
0026EB  3  88                   dey
0026EC  3  B1 rr                lda (z80_ix),y
0026EE  3  85 rr                sta dispx
0026F0  3                       ; ldy #8
0026F0  3  88                   dey
0026F1  3  B1 rr                lda (z80_ix),y
0026F3  3  85 rr                sta dispy
0026F5  3  A9 04                lda #4
0026F7  3  20 FF 13             jsr drpob
0026FA  3  A9 A0        a02659: lda #160
0026FC  3                       ; ldy #8
0026FC  3  A0 08                ldy #8
0026FE  3  91 rr                sta (z80_ix),y
002700  3  A9 05                lda #5
002702  3  C5 rr                cmp varobj
002704  3  F0 03                beq *+5
002706  3  4C 1A 27             jmp a02742
002709  3                       ; ldy #8
002709  3  B1 rr                lda (z80_ix),y
00270B  3  85 rr                sta varo
00270D  3                       ; ldy #9
00270D  3  C8                   iny
00270E  3  B1 rr                lda (z80_ix),y
002710  3  85 rr                sta varp
002712  3  A9 02                lda #2
002714  3  85 rr                sta varg
002716  3  A9 01                lda #1
002718  3  85 rr                sta vard
00271A  3  A9 05        a02742: lda #5
00271C  3  C5 rr                cmp varg
00271E  3  F0 03                beq *+5
002720  3  4C 38 27             jmp a02811
002723  3  A9 05                lda #5
002725  3  20 9F 13             jsr getob
002728  3                       ; ldy #9
002728  3  A0 09                ldy #9
00272A  3  B1 rr                lda (z80_ix),y
00272C  3  85 rr                sta dispx
00272E  3                       ; ldy #8
00272E  3  88                   dey
00272F  3  B1 rr                lda (z80_ix),y
002731  3  85 rr                sta dispy
002733  3  A9 05                lda #5
002735  3  20 FF 13             jsr drpob
002738  3  A9 06        a02811: lda #6
00273A  3  C5 rr                cmp varg
00273C  3  F0 03                beq *+5
00273E  3  4C 5B 27             jmp a02898
002741  3  A9 05                lda #5
002743  3                       ; ldy #10
002743  3  A0 0A                ldy #10
002745  3  D1 rr                cmp (z80_ix),y
002747  3  F0 03                beq *+5
002749  3  4C 5B 27             jmp a02898
00274C  3                       ; ldy #9
00274C  3  88                   dey
00274D  3  B1 rr                lda (z80_ix),y
00274F  3  85 rr                sta dispx
002751  3                       ; ldy #8
002751  3  88                   dey
002752  3  B1 rr                lda (z80_ix),y
002754  3  85 rr                sta dispy
002756  3  A9 05                lda #5
002758  3  20 FF 13             jsr drpob
00275B  3  A9 58        a02898: lda #88
00275D  3                       ; ldy #8
00275D  3  A0 08                ldy #8
00275F  3  91 rr                sta (z80_ix),y
002761  3  A9 30                lda #48
002763  3                       ; ldy #9
002763  3  C8                   iny
002764  3  91 rr                sta (z80_ix),y
002766  3  A9 01                lda #1
002768  3  C5 rr                cmp scno
00276A  3  90 03                bcc *+5
00276C  3  4C 73 27             jmp a02963
00276F  3  A9 18                lda #24
002771  3                       ; ldy #9
002771  3  91 rr                sta (z80_ix),y
002773  3  A9 06        a02963: lda #6
002775  3  C5 rr                cmp varobj
002777  3  F0 03                beq *+5
002779  3  4C 8F 27             jmp a03032
00277C  3                       ; ldy #8
00277C  3  A0 08                ldy #8
00277E  3  B1 rr                lda (z80_ix),y
002780  3  85 rr                sta varo
002782  3                       ; ldy #9
002782  3  C8                   iny
002783  3  B1 rr                lda (z80_ix),y
002785  3  85 rr                sta varp
002787  3  A9 02                lda #2
002789  3  85 rr                sta varg
00278B  3  A9 03                lda #3
00278D  3  85 rr                sta vard
00278F  3  A9 05        a03032: lda #5
002791  3  C5 rr                cmp varg
002793  3  F0 03                beq *+5
002795  3  4C AD 27             jmp a03101
002798  3  A9 06                lda #6
00279A  3  20 9F 13             jsr getob
00279D  3                       ; ldy #9
00279D  3  A0 09                ldy #9
00279F  3  B1 rr                lda (z80_ix),y
0027A1  3  85 rr                sta dispx
0027A3  3                       ; ldy #8
0027A3  3  88                   dey
0027A4  3  B1 rr                lda (z80_ix),y
0027A6  3  85 rr                sta dispy
0027A8  3  A9 06                lda #6
0027AA  3  20 FF 13             jsr drpob
0027AD  3  A9 06        a03101: lda #6
0027AF  3  C5 rr                cmp varg
0027B1  3  F0 03                beq *+5
0027B3  3  4C D0 27             jmp a03187
0027B6  3  A9 06                lda #6
0027B8  3                       ; ldy #10
0027B8  3  A0 0A                ldy #10
0027BA  3  D1 rr                cmp (z80_ix),y
0027BC  3  F0 03                beq *+5
0027BE  3  4C D0 27             jmp a03187
0027C1  3                       ; ldy #9
0027C1  3  88                   dey
0027C2  3  B1 rr                lda (z80_ix),y
0027C4  3  85 rr                sta dispx
0027C6  3                       ; ldy #8
0027C6  3  88                   dey
0027C7  3  B1 rr                lda (z80_ix),y
0027C9  3  85 rr                sta dispy
0027CB  3  A9 06                lda #6
0027CD  3  20 FF 13             jsr drpob
0027D0  3  A9 90        a03187: lda #144
0027D2  3                       ; ldy #9
0027D2  3  A0 09                ldy #9
0027D4  3  91 rr                sta (z80_ix),y
0027D6  3  A9 01                lda #1
0027D8  3  C5 rr                cmp scno
0027DA  3  90 03                bcc *+5
0027DC  3  4C E3 27             jmp a03236
0027DF  3  A9 A8                lda #168
0027E1  3                       ; ldy #9
0027E1  3  91 rr                sta (z80_ix),y
0027E3  3  A9 07        a03236: lda #7
0027E5  3  C5 rr                cmp varobj
0027E7  3  F0 03                beq *+5
0027E9  3  4C FF 27             jmp a03305
0027EC  3                       ; ldy #8
0027EC  3  A0 08                ldy #8
0027EE  3  B1 rr                lda (z80_ix),y
0027F0  3  85 rr                sta varo
0027F2  3                       ; ldy #9
0027F2  3  C8                   iny
0027F3  3  B1 rr                lda (z80_ix),y
0027F5  3  85 rr                sta varp
0027F7  3  A9 02                lda #2
0027F9  3  85 rr                sta varg
0027FB  3  A9 02                lda #2
0027FD  3  85 rr                sta vard
0027FF  3  A9 05        a03305: lda #5
002801  3  C5 rr                cmp varg
002803  3  F0 03                beq *+5
002805  3  4C 1D 28             jmp a03374
002808  3  A9 07                lda #7
00280A  3  20 9F 13             jsr getob
00280D  3                       ; ldy #9
00280D  3  A0 09                ldy #9
00280F  3  B1 rr                lda (z80_ix),y
002811  3  85 rr                sta dispx
002813  3                       ; ldy #8
002813  3  88                   dey
002814  3  B1 rr                lda (z80_ix),y
002816  3  85 rr                sta dispy
002818  3  A9 07                lda #7
00281A  3  20 FF 13             jsr drpob
00281D  3  A9 06        a03374: lda #6
00281F  3  C5 rr                cmp varg
002821  3  F0 03                beq *+5
002823  3  4C 55 28             jmp a03524
002826  3  A9 07                lda #7
002828  3                       ; ldy #10
002828  3  A0 0A                ldy #10
00282A  3  D1 rr                cmp (z80_ix),y
00282C  3  F0 03                beq *+5
00282E  3  4C 40 28             jmp a03461
002831  3                       ; ldy #9
002831  3  88                   dey
002832  3  B1 rr                lda (z80_ix),y
002834  3  85 rr                sta dispx
002836  3                       ; ldy #8
002836  3  88                   dey
002837  3  B1 rr                lda (z80_ix),y
002839  3  85 rr                sta dispy
00283B  3  A9 07                lda #7
00283D  3  20 FF 13             jsr drpob
002840  3  A5 rr        a03461: lda vara
002842  3                       ; ldy #8
002842  3  A0 08                ldy #8
002844  3  91 rr                sta (z80_ix),y
002846  3  A5 rr                lda varb
002848  3                       ; ldy #9
002848  3  C8                   iny
002849  3  91 rr                sta (z80_ix),y
00284B  3  A9 FF                lda #255
00284D  3                       ; ldy #10
00284D  3  C8                   iny
00284E  3  91 rr                sta (z80_ix),y
002850  3  A9 03                lda #3
002852  3  85 rr                sta varg
002854  3  60                   rts
002855  3  A9 02        a03524: lda #2
002857  3  C5 rr                cmp varg
002859  3  F0 03                beq *+5
00285B  3  4C DB 29             jmp a04465
00285E  3  A5 rr                lda varobj
002860  3                       ; ldy #10
002860  3  A0 0A                ldy #10
002862  3  91 rr                sta (z80_ix),y
002864  3  A5 rr                lda varobj
002866  3  20 9F 13             jsr getob
002869  3  A5 rr                lda varo
00286B  3                       ; ldy #8
00286B  3  A0 08                ldy #8
00286D  3  91 rr                sta (z80_ix),y
00286F  3  A5 rr                lda varp
002871  3                       ; ldy #9
002871  3  C8                   iny
002872  3  91 rr                sta (z80_ix),y
002874  3  A5 rr                lda vars
002876  3  C5 rr                cmp varobj
002878  3  F0 03                beq *+5
00287A  3  4C 02 29             jmp a03950
00287D  3  A9 50                lda #<80
00287F  3  85 rr                sta z80_l
002881  3  A9 00                lda #>80
002883  3  85 rr                sta z80_h
002885  3  20 95 15             jsr addsc
002888  3  A9 01                lda #1
00288A  3  85 rr                sta chary
00288C  3  A9 1B                lda #27
00288E  3  85 rr                sta charx
002890  3  20 49 15             jsr dscor
002893  3  A9 04                lda #4
002895  3  85 rr                sta chary
002897  3  A9 1B                lda #27
002899  3  85 rr                sta charx
00289B  3  A9 08                lda #8
00289D  3  85 rr                sta z80_c
00289F  3  A9 09                lda #9
0028A1  3  85 rr                sta z80_b
0028A3  3  20 79 14             jsr spawn
0028A6  3  A5 rr                lda spptr
0028A8  3  85 rr                sta z80_x
0028AA  3  A5 rr                lda spptr+1
0028AC  3  85 rr                sta z80_i
0028AE  3  A5 rr                lda vard
0028B0  3                       ; ldy #10
0028B0  3  C8                   iny
0028B1  3  91 rr                sta (z80_ix),y
0028B3  3  A5 rr                lda vard
0028B5  3  85 rr                sta z80_c
0028B7  3                       ; ldy #6
0028B7  3  A0 06                ldy #6
0028B9  3  B1 rr                lda (z80_ix),y
0028BB  3  18                   clc
0028BC  3  65 rr                adc z80_c
0028BE  3                       ; ldy #6
0028BE  3  91 rr                sta (z80_ix),y
0028C0  3  A9 32                lda #50
0028C2  3                       ; ldy #12
0028C2  3  A0 0C                ldy #12
0028C4  3  91 rr                sta (z80_ix),y
0028C6  3  A9 00                lda #0
0028C8  3                       ; ldy #11
0028C8  3  88                   dey
0028C9  3  91 rr                sta (z80_ix),y
0028CB  3  A9 00                lda #0
0028CD  3  C5 rr                cmp scno
0028CF  3  90 03                bcc *+5
0028D1  3  4C D8 28             jmp a03845
0028D4  3  A9 01                lda #1
0028D6  3                       ; ldy #11
0028D6  3  91 rr                sta (z80_ix),y
0028D8  3  A9 02        a03845: lda #2
0028DA  3  C5 rr                cmp scno
0028DC  3  90 03                bcc *+5
0028DE  3  4C E7 28             jmp a03880
0028E1  3  A9 02                lda #2
0028E3  3                       ; ldy #11
0028E3  3  A0 0B                ldy #11
0028E5  3  91 rr                sta (z80_ix),y
0028E7  3  A9 00        a03880: lda #0
0028E9  3  85 rr                sta varg
0028EB  3  A5 rr                lda ogptr
0028ED  3  85 rr                sta z80_x
0028EF  3  A5 rr                lda ogptr+1
0028F1  3  85 rr                sta z80_i
0028F3  3  A5 rr                lda vara
0028F5  3                       ; ldy #8
0028F5  3  A0 08                ldy #8
0028F7  3  91 rr                sta (z80_ix),y
0028F9  3  A5 rr                lda varb
0028FB  3                       ; ldy #9
0028FB  3  C8                   iny
0028FC  3  91 rr                sta (z80_ix),y
0028FE  3  60                   rts
0028FF  3  4C DB 29             jmp a04465
002902  3  A5 rr        a03950: lda vart
002904  3  C5 rr                cmp varobj
002906  3  F0 03                beq *+5
002908  3  4C 8B 29             jmp a04271
00290B  3  A9 01                lda #1
00290D  3  85 rr                sta varq
00290F  3  A9 50                lda #<80
002911  3  85 rr                sta z80_l
002913  3  A9 00                lda #>80
002915  3  85 rr                sta z80_h
002917  3  20 95 15             jsr addsc
00291A  3  A9 01                lda #1
00291C  3  85 rr                sta chary
00291E  3  A9 1B                lda #27
002920  3  85 rr                sta charx
002922  3  20 49 15             jsr dscor
002925  3  A9 04                lda #4
002927  3  85 rr                sta chary
002929  3  A9 1B                lda #27
00292B  3  85 rr                sta charx
00292D  3  A9 08                lda #8
00292F  3  85 rr                sta z80_c
002931  3  A9 09                lda #9
002933  3  85 rr                sta z80_b
002935  3  20 79 14             jsr spawn
002938  3  A5 rr                lda spptr
00293A  3  85 rr                sta z80_x
00293C  3  A5 rr                lda spptr+1
00293E  3  85 rr                sta z80_i
002940  3  A5 rr                lda vard
002942  3  85 rr                sta z80_c
002944  3                       ; ldy #6
002944  3  A0 06                ldy #6
002946  3  B1 rr                lda (z80_ix),y
002948  3  18                   clc
002949  3  65 rr                adc z80_c
00294B  3                       ; ldy #6
00294B  3  91 rr                sta (z80_ix),y
00294D  3  A9 32                lda #50
00294F  3                       ; ldy #12
00294F  3  A0 0C                ldy #12
002951  3  91 rr                sta (z80_ix),y
002953  3  A9 00                lda #0
002955  3  C5 rr                cmp scno
002957  3  90 03                bcc *+5
002959  3  4C 61 29             jmp a04167
00295C  3  A9 01                lda #1
00295E  3                       ; ldy #11
00295E  3  88                   dey
00295F  3  91 rr                sta (z80_ix),y
002961  3  A9 02        a04167: lda #2
002963  3  C5 rr                cmp scno
002965  3  90 03                bcc *+5
002967  3  4C 70 29             jmp a04202
00296A  3  A9 02                lda #2
00296C  3                       ; ldy #11
00296C  3  A0 0B                ldy #11
00296E  3  91 rr                sta (z80_ix),y
002970  3  A9 00        a04202: lda #0
002972  3  85 rr                sta varg
002974  3  A5 rr                lda ogptr
002976  3  85 rr                sta z80_x
002978  3  A5 rr                lda ogptr+1
00297A  3  85 rr                sta z80_i
00297C  3  A5 rr                lda vara
00297E  3                       ; ldy #8
00297E  3  A0 08                ldy #8
002980  3  91 rr                sta (z80_ix),y
002982  3  A5 rr                lda varb
002984  3                       ; ldy #9
002984  3  C8                   iny
002985  3  91 rr                sta (z80_ix),y
002987  3  60                   rts
002988  3  4C DB 29             jmp a04465
00298B  3  A9 64        a04271: lda #<100
00298D  3  85 rr                sta z80_l
00298F  3  A9 00                lda #>100
002991  3  85 rr                sta z80_h
002993  3  20 95 15             jsr addsc
002996  3  A9 01                lda #1
002998  3  85 rr                sta chary
00299A  3  A9 1B                lda #27
00299C  3  85 rr                sta charx
00299E  3  20 49 15             jsr dscor
0029A1  3  A9 04                lda #4
0029A3  3  85 rr                sta chary
0029A5  3  A9 1B                lda #27
0029A7  3  85 rr                sta charx
0029A9  3  A9 04                lda #4
0029AB  3  85 rr                sta z80_c
0029AD  3  A9 0E                lda #14
0029AF  3  85 rr                sta z80_b
0029B1  3  20 79 14             jsr spawn
0029B4  3  A5 rr                lda spptr
0029B6  3  85 rr                sta z80_x
0029B8  3  A5 rr                lda spptr+1
0029BA  3  85 rr                sta z80_i
0029BC  3  A5 rr                lda vard
0029BE  3                       ; ldy #10
0029BE  3  A0 0A                ldy #10
0029C0  3  91 rr                sta (z80_ix),y
0029C2  3  A5 rr                lda varobj
0029C4  3                       ; ldy #11
0029C4  3  C8                   iny
0029C5  3  91 rr                sta (z80_ix),y
0029C7  3  A5 rr                lda ogptr
0029C9  3  85 rr                sta z80_x
0029CB  3  A5 rr                lda ogptr+1
0029CD  3  85 rr                sta z80_i
0029CF  3  A5 rr                lda vara
0029D1  3                       ; ldy #8
0029D1  3  A0 08                ldy #8
0029D3  3  91 rr                sta (z80_ix),y
0029D5  3  A5 rr                lda varb
0029D7  3                       ; ldy #9
0029D7  3  C8                   iny
0029D8  3  91 rr                sta (z80_ix),y
0029DA  3  60                   rts
0029DB  3  A5 rr        a04465: lda vara
0029DD  3                       ; ldy #8
0029DD  3  A0 08                ldy #8
0029DF  3  91 rr                sta (z80_ix),y
0029E1  3  A5 rr                lda varb
0029E3  3                       ; ldy #9
0029E3  3  C8                   iny
0029E4  3  91 rr                sta (z80_ix),y
0029E6  3  A9 05                lda #5
0029E8  3  C5 rr                cmp varg
0029EA  3  F0 03                beq *+5
0029EC  3  4C F3 29             jmp a04525
0029EF  3  A9 00                lda #0
0029F1  3  85 rr                sta varg
0029F3  3  A9 00        a04525: lda #0
0029F5  3  85 rr                sta varq
0029F7  3  A5 rr                lda joyval
0029F9  3  29 20                and #32
0029FB  3  F0 03                beq :+
0029FD  3  4C 04 2A             jmp a04558
002A00  3               :
002A00  3  A9 01                lda #1
002A02  3  85 rr                sta varq
002A04  3  A5 rr        a04558: lda joyval
002A06  3  29 10                and #16
002A08  3  F0 03                beq :+
002A0A  3  4C 11 2A             jmp a04584
002A0D  3               :
002A0D  3  A9 01                lda #1
002A0F  3  85 rr                sta varq
002A11  3  A9 01        a04584: lda #1
002A13  3  C5 rr                cmp varq
002A15  3  F0 03                beq *+5
002A17  3  4C 82 2A             jmp a04846
002A1A  3  A9 00                lda #0
002A1C  3                       ; ldy #11
002A1C  3  A0 0B                ldy #11
002A1E  3  D1 rr                cmp (z80_ix),y
002A20  3  F0 03                beq *+5
002A22  3  4C 82 2A             jmp a04846
002A25  3  A9 00                lda #0
002A27  3  C5 rr                cmp vark
002A29  3  90 03                bcc *+5
002A2B  3  4C 82 2A             jmp a04846
002A2E  3  A9 02                lda #2
002A30  3  85 rr                sta z80_c
002A32  3  A9 08                lda #8
002A34  3  85 rr                sta z80_b
002A36  3  20 79 14             jsr spawn
002A39  3  A9 01                lda #1
002A3B  3                       ; ldy #11
002A3B  3  91 rr                sta (z80_ix),y
002A3D  3  A5 rr                lda spptr
002A3F  3  85 rr                sta z80_x
002A41  3  A5 rr                lda spptr+1
002A43  3  85 rr                sta z80_i
002A45  3  A5 rr                lda clock
002A47  3                       ; ldy #12
002A47  3  C8                   iny
002A48  3  91 rr                sta (z80_ix),y
002A4A  3  A9 FF                lda #255
002A4C  3  85 rr                sta z80_c
002A4E  3                       ; ldy #12
002A4E  3  B1 rr                lda (z80_ix),y
002A50  3  18                   clc
002A51  3  65 rr                adc z80_c
002A53  3                       ; ldy #12
002A53  3  91 rr                sta (z80_ix),y
002A55  3  A9 FF                lda #255
002A57  3  85 rr                sta z80_c
002A59  3  A5 rr                lda vark
002A5B  3  18                   clc
002A5C  3  65 rr                adc z80_c
002A5E  3  85 rr                sta vark
002A60  3  A9 07                lda #7
002A62  3  85 rr                sta chary
002A64  3  A9 1D                lda #29
002A66  3  85 rr                sta charx
002A68  3  A9 18                lda #24
002A6A  3  20 ED 1A             jsr dmsg
002A6D  3  A9 07                lda #7
002A6F  3  85 rr                sta chary
002A71  3  A9 1D                lda #29
002A73  3  85 rr                sta charx
002A75  3  A5 rr                lda vark
002A77  3  20 34 1F             jsr disply
002A7A  3  A5 rr                lda ogptr
002A7C  3  85 rr                sta z80_x
002A7E  3  A5 rr                lda ogptr+1
002A80  3  85 rr                sta z80_i
002A82  3  A5 rr        a04846: lda joyval
002A84  3  29 08                and #8
002A86  3  F0 03                beq :+
002A88  3  4C 06 2B             jmp a05123
002A8B  3               :
002A8B  3  20 18 18             jsr cangu
002A8E  3  F0 03                beq :+
002A90  3  4C A5 2A             jmp a04922
002A93  3               :
002A93  3  A0 08                ldy #8
002A95  3  B1 rr                lda (z80_ix),y
002A97  3  38                   sec
002A98  3  E9 02                sbc #2
002A9A  3  91 rr                sta (z80_ix),y
002A9C  3  A9 00                lda #0
002A9E  3                       ; ldy #6
002A9E  3  A0 06                ldy #6
002AA0  3  91 rr                sta (z80_ix),y
002AA2  3  4C DF 2A             jmp a05046
002AA5  3  A0 09        a04922: ldy #9
002AA7  3  B1 rr                lda (z80_ix),y
002AA9  3  18                   clc
002AAA  3  69 02                adc #2
002AAC  3  91 rr                sta (z80_ix),y
002AAE  3  20 18 18             jsr cangu
002AB1  3  F0 03                beq :+
002AB3  3  4C B9 2A             jmp a04962
002AB6  3               :
002AB6  3  4C DF 2A             jmp a05046
002AB9  3  A0 09        a04962: ldy #9
002ABB  3  B1 rr                lda (z80_ix),y
002ABD  3  38                   sec
002ABE  3  E9 02                sbc #2
002AC0  3  91 rr                sta (z80_ix),y
002AC2  3  A0 09                ldy #9
002AC4  3  B1 rr                lda (z80_ix),y
002AC6  3  38                   sec
002AC7  3  E9 02                sbc #2
002AC9  3  91 rr                sta (z80_ix),y
002ACB  3  20 18 18             jsr cangu
002ACE  3  F0 03                beq :+
002AD0  3  4C D6 2A             jmp a05024
002AD3  3               :
002AD3  3  4C DF 2A             jmp a05046
002AD6  3  A0 09        a05024: ldy #9
002AD8  3  B1 rr                lda (z80_ix),y
002ADA  3  18                   clc
002ADB  3  69 02                adc #2
002ADD  3  91 rr                sta (z80_ix),y
002ADF  3               a05046: ; ldy #8
002ADF  3  A0 08                ldy #8
002AE1  3  B1 rr                lda (z80_ix),y
002AE3  3  C5 rr                cmp vara
002AE5  3  90 03                bcc *+5
002AE7  3  4C 06 2B             jmp a05123
002AEA  3  A9 00                lda #0
002AEC  3  C5 rr                cmp varc
002AEE  3  F0 03                beq *+5
002AF0  3  4C F8 2A             jmp a05098
002AF3  3  A9 00                lda #0
002AF5  3  20 59 1E             jsr animsp
002AF8  3  A9 02        a05098: lda #2
002AFA  3  C5 rr                cmp varc
002AFC  3  F0 03                beq *+5
002AFE  3  4C 06 2B             jmp a05123
002B01  3  A9 00                lda #0
002B03  3  20 59 1E             jsr animsp
002B06  3  A5 rr        a05123: lda joyval
002B08  3  29 04                and #4
002B0A  3  F0 03                beq :+
002B0C  3  4C 8A 2B             jmp a05400
002B0F  3               :
002B0F  3  20 4D 18             jsr cangd
002B12  3  F0 03                beq :+
002B14  3  4C 29 2B             jmp a05199
002B17  3               :
002B17  3  A0 08                ldy #8
002B19  3  B1 rr                lda (z80_ix),y
002B1B  3  18                   clc
002B1C  3  69 02                adc #2
002B1E  3  91 rr                sta (z80_ix),y
002B20  3  A9 01                lda #1
002B22  3                       ; ldy #6
002B22  3  A0 06                ldy #6
002B24  3  91 rr                sta (z80_ix),y
002B26  3  4C 63 2B             jmp a05323
002B29  3  A0 09        a05199: ldy #9
002B2B  3  B1 rr                lda (z80_ix),y
002B2D  3  18                   clc
002B2E  3  69 02                adc #2
002B30  3  91 rr                sta (z80_ix),y
002B32  3  20 4D 18             jsr cangd
002B35  3  F0 03                beq :+
002B37  3  4C 3D 2B             jmp a05239
002B3A  3               :
002B3A  3  4C 63 2B             jmp a05323
002B3D  3  A0 09        a05239: ldy #9
002B3F  3  B1 rr                lda (z80_ix),y
002B41  3  38                   sec
002B42  3  E9 02                sbc #2
002B44  3  91 rr                sta (z80_ix),y
002B46  3  A0 09                ldy #9
002B48  3  B1 rr                lda (z80_ix),y
002B4A  3  38                   sec
002B4B  3  E9 02                sbc #2
002B4D  3  91 rr                sta (z80_ix),y
002B4F  3  20 4D 18             jsr cangd
002B52  3  F0 03                beq :+
002B54  3  4C 5A 2B             jmp a05301
002B57  3               :
002B57  3  4C 63 2B             jmp a05323
002B5A  3  A0 09        a05301: ldy #9
002B5C  3  B1 rr                lda (z80_ix),y
002B5E  3  18                   clc
002B5F  3  69 02                adc #2
002B61  3  91 rr                sta (z80_ix),y
002B63  3  A5 rr        a05323: lda vara
002B65  3                       ; ldy #8
002B65  3  A0 08                ldy #8
002B67  3  D1 rr                cmp (z80_ix),y
002B69  3  90 03                bcc *+5
002B6B  3  4C 8A 2B             jmp a05400
002B6E  3  A9 00                lda #0
002B70  3  C5 rr                cmp varc
002B72  3  F0 03                beq *+5
002B74  3  4C 7C 2B             jmp a05375
002B77  3  A9 00                lda #0
002B79  3  20 59 1E             jsr animsp
002B7C  3  A9 02        a05375: lda #2
002B7E  3  C5 rr                cmp varc
002B80  3  F0 03                beq *+5
002B82  3  4C 8A 2B             jmp a05400
002B85  3  A9 00                lda #0
002B87  3  20 59 1E             jsr animsp
002B8A  3  A5 rr        a05400: lda joyval
002B8C  3  29 01                and #1
002B8E  3  F0 03                beq :+
002B90  3  4C 19 2C             jmp a05704
002B93  3               :
002B93  3                       ; ldy #9
002B93  3  A0 09                ldy #9
002B95  3  B1 rr                lda (z80_ix),y
002B97  3  C9 BF                cmp #191
002B99  3  90 03                bcc *+5
002B9B  3  4C 19 2C             jmp a05704
002B9E  3  20 94 18             jsr cangr
002BA1  3  F0 03                beq :+
002BA3  3  4C B8 2B             jmp a05502
002BA6  3               :
002BA6  3  A9 02                lda #2
002BA8  3                       ; ldy #6
002BA8  3  A0 06                ldy #6
002BAA  3  91 rr                sta (z80_ix),y
002BAC  3  A0 09                ldy #9
002BAE  3  B1 rr                lda (z80_ix),y
002BB0  3  18                   clc
002BB1  3  69 02                adc #2
002BB3  3  91 rr                sta (z80_ix),y
002BB5  3  4C F2 2B             jmp a05627
002BB8  3  A0 08        a05502: ldy #8
002BBA  3  B1 rr                lda (z80_ix),y
002BBC  3  38                   sec
002BBD  3  E9 02                sbc #2
002BBF  3  91 rr                sta (z80_ix),y
002BC1  3  20 94 18             jsr cangr
002BC4  3  F0 03                beq :+
002BC6  3  4C CC 2B             jmp a05543
002BC9  3               :
002BC9  3  4C F2 2B             jmp a05627
002BCC  3  A0 08        a05543: ldy #8
002BCE  3  B1 rr                lda (z80_ix),y
002BD0  3  18                   clc
002BD1  3  69 02                adc #2
002BD3  3  91 rr                sta (z80_ix),y
002BD5  3  A0 08                ldy #8
002BD7  3  B1 rr                lda (z80_ix),y
002BD9  3  18                   clc
002BDA  3  69 02                adc #2
002BDC  3  91 rr                sta (z80_ix),y
002BDE  3  20 94 18             jsr cangr
002BE1  3  F0 03                beq :+
002BE3  3  4C E9 2B             jmp a05605
002BE6  3               :
002BE6  3  4C F2 2B             jmp a05627
002BE9  3  A0 08        a05605: ldy #8
002BEB  3  B1 rr                lda (z80_ix),y
002BED  3  38                   sec
002BEE  3  E9 02                sbc #2
002BF0  3  91 rr                sta (z80_ix),y
002BF2  3  A5 rr        a05627: lda varb
002BF4  3                       ; ldy #9
002BF4  3  A0 09                ldy #9
002BF6  3  D1 rr                cmp (z80_ix),y
002BF8  3  90 03                bcc *+5
002BFA  3  4C 19 2C             jmp a05704
002BFD  3  A9 00                lda #0
002BFF  3  C5 rr                cmp varc
002C01  3  F0 03                beq *+5
002C03  3  4C 0B 2C             jmp a05679
002C06  3  A9 00                lda #0
002C08  3  20 59 1E             jsr animsp
002C0B  3  A9 02        a05679: lda #2
002C0D  3  C5 rr                cmp varc
002C0F  3  F0 03                beq *+5
002C11  3  4C 19 2C             jmp a05704
002C14  3  A9 00                lda #0
002C16  3  20 59 1E             jsr animsp
002C19  3  A5 rr        a05704: lda joyval
002C1B  3  29 02                and #2
002C1D  3  F0 03                beq :+
002C1F  3  4C A8 2C             jmp a06007
002C22  3               :
002C22  3  A9 01                lda #1
002C24  3                       ; ldy #9
002C24  3  A0 09                ldy #9
002C26  3  D1 rr                cmp (z80_ix),y
002C28  3  90 03                bcc *+5
002C2A  3  4C A8 2C             jmp a06007
002C2D  3  20 82 18             jsr cangl
002C30  3  F0 03                beq :+
002C32  3  4C 47 2C             jmp a05806
002C35  3               :
002C35  3  A0 09                ldy #9
002C37  3  B1 rr                lda (z80_ix),y
002C39  3  38                   sec
002C3A  3  E9 02                sbc #2
002C3C  3  91 rr                sta (z80_ix),y
002C3E  3  A9 03                lda #3
002C40  3                       ; ldy #6
002C40  3  A0 06                ldy #6
002C42  3  91 rr                sta (z80_ix),y
002C44  3  4C 81 2C             jmp a05930
002C47  3  A0 08        a05806: ldy #8
002C49  3  B1 rr                lda (z80_ix),y
002C4B  3  38                   sec
002C4C  3  E9 02                sbc #2
002C4E  3  91 rr                sta (z80_ix),y
002C50  3  20 82 18             jsr cangl
002C53  3  F0 03                beq :+
002C55  3  4C 5B 2C             jmp a05846
002C58  3               :
002C58  3  4C 81 2C             jmp a05930
002C5B  3  A0 08        a05846: ldy #8
002C5D  3  B1 rr                lda (z80_ix),y
002C5F  3  18                   clc
002C60  3  69 02                adc #2
002C62  3  91 rr                sta (z80_ix),y
002C64  3  A0 08                ldy #8
002C66  3  B1 rr                lda (z80_ix),y
002C68  3  18                   clc
002C69  3  69 02                adc #2
002C6B  3  91 rr                sta (z80_ix),y
002C6D  3  20 82 18             jsr cangl
002C70  3  F0 03                beq :+
002C72  3  4C 78 2C             jmp a05908
002C75  3               :
002C75  3  4C 81 2C             jmp a05930
002C78  3  A0 08        a05908: ldy #8
002C7A  3  B1 rr                lda (z80_ix),y
002C7C  3  38                   sec
002C7D  3  E9 02                sbc #2
002C7F  3  91 rr                sta (z80_ix),y
002C81  3               a05930: ; ldy #9
002C81  3  A0 09                ldy #9
002C83  3  B1 rr                lda (z80_ix),y
002C85  3  C5 rr                cmp varb
002C87  3  90 03                bcc *+5
002C89  3  4C A8 2C             jmp a06007
002C8C  3  A9 00                lda #0
002C8E  3  C5 rr                cmp varc
002C90  3  F0 03                beq *+5
002C92  3  4C 9A 2C             jmp a05982
002C95  3  A9 00                lda #0
002C97  3  20 59 1E             jsr animsp
002C9A  3  A9 02        a05982: lda #2
002C9C  3  C5 rr                cmp varc
002C9E  3  F0 03                beq *+5
002CA0  3  4C A8 2C             jmp a06007
002CA3  3  A9 00                lda #0
002CA5  3  20 59 1E             jsr animsp
002CA8  3  A9 FA        a06007: lda #250
002CAA  3                       ; ldy #8
002CAA  3  A0 08                ldy #8
002CAC  3  D1 rr                cmp (z80_ix),y
002CAE  3  90 03                bcc *+5
002CB0  3  4C B7 2C             jmp a06048
002CB3  3  A9 00                lda #0
002CB5  3                       ; ldy #8
002CB5  3  91 rr                sta (z80_ix),y
002CB7  3  A9 B0        a06048: lda #176
002CB9  3                       ; ldy #8
002CB9  3  A0 08                ldy #8
002CBB  3  D1 rr                cmp (z80_ix),y
002CBD  3  90 03                bcc *+5
002CBF  3  4C C6 2C             jmp a06089
002CC2  3  A9 B0                lda #176
002CC4  3                       ; ldy #8
002CC4  3  91 rr                sta (z80_ix),y
002CC6  3  A9 01        a06089: lda #1
002CC8  3  C5 rr                cmp varg
002CCA  3  F0 03                beq *+5
002CCC  3  4C E5 2C             jmp a06168
002CCF  3                       ; ldy #6
002CCF  3  A0 06                ldy #6
002CD1  3  B1 rr                lda (z80_ix),y
002CD3  3  C9 04                cmp #4
002CD5  3  90 03                bcc *+5
002CD7  3  4C E5 2C             jmp a06168
002CDA  3  A9 04                lda #4
002CDC  3  85 rr                sta z80_c
002CDE  3                       ; ldy #6
002CDE  3  B1 rr                lda (z80_ix),y
002CE0  3  18                   clc
002CE1  3  65 rr                adc z80_c
002CE3  3                       ; ldy #6
002CE3  3  91 rr                sta (z80_ix),y
002CE5  3  60           a06168: rts
002CE6  3               .out .sprintf("EVENT 0 SIZE = %d", (* - evnt00))
002CE6  3               
002CE6  3               evnt01:
002CE6  3  A9 00                lda #0
002CE8  3  C5 rr                cmp scno
002CEA  3  F0 03                beq *+5
002CEC  3  4C F3 2C             jmp b00027
002CEF  3  A9 0A                lda #10
002CF1  3  85 rr                sta varq
002CF3  3  A9 01        b00027: lda #1
002CF5  3  C5 rr                cmp scno
002CF7  3  F0 03                beq *+5
002CF9  3  4C 00 2D             jmp b00051
002CFC  3  A9 09                lda #9
002CFE  3  85 rr                sta varq
002D00  3  A9 02        b00051: lda #2
002D02  3  C5 rr                cmp scno
002D04  3  F0 03                beq *+5
002D06  3  4C 0D 2D             jmp b00076
002D09  3  A9 08                lda #8
002D0B  3  85 rr                sta varq
002D0D  3  A9 03        b00076: lda #3
002D0F  3  C5 rr                cmp scno
002D11  3  F0 03                beq *+5
002D13  3  4C 1A 2D             jmp b00101
002D16  3  A9 07                lda #7
002D18  3  85 rr                sta varq
002D1A  3               b00101: ; ldy #11
002D1A  3  A0 0B                ldy #11
002D1C  3  B1 rr                lda (z80_ix),y
002D1E  3  C9 02                cmp #2
002D20  3  90 03                bcc *+5
002D22  3  4C 4B 2D             jmp b00242
002D25  3  A9 00                lda #0
002D27  3  C5 rr                cmp clock
002D29  3  F0 03                beq *+5
002D2B  3  4C 4B 2D             jmp b00242
002D2E  3                       ; ldy #12
002D2E  3  C8                   iny
002D2F  3  B1 rr                lda (z80_ix),y
002D31  3  18                   clc
002D32  3  69 01                adc #1
002D34  3                       ; ldy #12
002D34  3  91 rr                sta (z80_ix),y
002D36  3  A5 rr                lda varq
002D38  3                       ; ldy #12
002D38  3  D1 rr                cmp (z80_ix),y
002D3A  3  F0 03                beq *+5
002D3C  3  4C 4B 2D             jmp b00242
002D3F  3  A9 00                lda #0
002D41  3                       ; ldy #12
002D41  3  91 rr                sta (z80_ix),y
002D43  3                       ; ldy #11
002D43  3  88                   dey
002D44  3  B1 rr                lda (z80_ix),y
002D46  3  18                   clc
002D47  3  69 01                adc #1
002D49  3                       ; ldy #11
002D49  3  91 rr                sta (z80_ix),y
002D4B  3  A9 02        b00242: lda #2
002D4D  3  C5 rr                cmp varg
002D4F  3  F0 03                beq *+5
002D51  3  4C 55 2D             jmp b00262
002D54  3  60                   rts
002D55  3               b00262: ; ldy #11
002D55  3  A0 0B                ldy #11
002D57  3  B1 rr                lda (z80_ix),y
002D59  3  C9 02                cmp #2
002D5B  3  90 03                bcc *+5
002D5D  3  4C 7F 2D             jmp b00344
002D60  3  A9 00                lda #0
002D62  3  C5 rr                cmp varc
002D64  3  F0 03                beq *+5
002D66  3  4C 6E 2D             jmp b00314
002D69  3  A9 00                lda #0
002D6B  3  20 59 1E             jsr animsp
002D6E  3  A9 02        b00314: lda #2
002D70  3  C5 rr                cmp varc
002D72  3  F0 03                beq *+5
002D74  3  4C 7C 2D             jmp b00339
002D77  3  A9 00                lda #0
002D79  3  20 59 1E             jsr animsp
002D7C  3  4C 84 2D     b00339: jmp b00353
002D7F  3  A9 00        b00344: lda #0
002D81  3  20 59 1E             jsr animsp
002D84  3               b00353: ; ldy #10
002D84  3  A0 0A                ldy #10
002D86  3  B1 rr                lda (z80_ix),y
002D88  3  85 rr                sta vard
002D8A  3  A9 00                lda #0
002D8C  3  85 rr                sta varo
002D8E  3  A9 00                lda #0
002D90  3                       ; ldy #8
002D90  3  A0 08                ldy #8
002D92  3  D1 rr                cmp (z80_ix),y
002D94  3  90 03                bcc *+5
002D96  3  4C 0D 2E             jmp b00690
002D99  3  20 18 18             jsr cangu
002D9C  3  F0 03                beq :+
002D9E  3  4C A5 2D             jmp b00427
002DA1  3               :
002DA1  3  A9 01                lda #1
002DA3  3  85 rr                sta varo
002DA5  3  A9 00        b00427: lda #0
002DA7  3  C5 rr                cmp varo
002DA9  3  F0 03                beq *+5
002DAB  3  4C D9 2D             jmp b00558
002DAE  3  A9 00                lda #0
002DB0  3                       ; ldy #9
002DB0  3  A0 09                ldy #9
002DB2  3  D1 rr                cmp (z80_ix),y
002DB4  3  90 03                bcc *+5
002DB6  3  4C D9 2D             jmp b00558
002DB9  3  A9 FF                lda #255
002DBB  3  85 rr                sta z80_c
002DBD  3                       ; ldy #9
002DBD  3  B1 rr                lda (z80_ix),y
002DBF  3  18                   clc
002DC0  3  65 rr                adc z80_c
002DC2  3                       ; ldy #9
002DC2  3  91 rr                sta (z80_ix),y
002DC4  3  20 18 18             jsr cangu
002DC7  3  F0 03                beq :+
002DC9  3  4C D0 2D             jmp b00528
002DCC  3               :
002DCC  3  A9 02                lda #2
002DCE  3  85 rr                sta varo
002DD0  3               b00528: ; ldy #9
002DD0  3  A0 09                ldy #9
002DD2  3  B1 rr                lda (z80_ix),y
002DD4  3  18                   clc
002DD5  3  69 01                adc #1
002DD7  3                       ; ldy #9
002DD7  3  91 rr                sta (z80_ix),y
002DD9  3  A9 00        b00558: lda #0
002DDB  3  C5 rr                cmp varo
002DDD  3  F0 03                beq *+5
002DDF  3  4C 0D 2E             jmp b00690
002DE2  3                       ; ldy #9
002DE2  3  A0 09                ldy #9
002DE4  3  B1 rr                lda (z80_ix),y
002DE6  3  C9 C0                cmp #192
002DE8  3  90 03                bcc *+5
002DEA  3  4C 0D 2E             jmp b00690
002DED  3                       ; ldy #9
002DED  3  B1 rr                lda (z80_ix),y
002DEF  3  18                   clc
002DF0  3  69 01                adc #1
002DF2  3                       ; ldy #9
002DF2  3  91 rr                sta (z80_ix),y
002DF4  3  20 18 18             jsr cangu
002DF7  3  F0 03                beq :+
002DF9  3  4C 00 2E             jmp b00650
002DFC  3               :
002DFC  3  A9 03                lda #3
002DFE  3  85 rr                sta varo
002E00  3  A9 FF        b00650: lda #255
002E02  3  85 rr                sta z80_c
002E04  3                       ; ldy #9
002E04  3  A0 09                ldy #9
002E06  3  B1 rr                lda (z80_ix),y
002E08  3  18                   clc
002E09  3  65 rr                adc z80_c
002E0B  3                       ; ldy #9
002E0B  3  91 rr                sta (z80_ix),y
002E0D  3  A9 00        b00690: lda #0
002E0F  3                       ; ldy #8
002E0F  3  A0 08                ldy #8
002E11  3  D1 rr                cmp (z80_ix),y
002E13  3  F0 03                beq *+5
002E15  3  4C 1C 2E             jmp b00724
002E18  3  A9 00                lda #0
002E1A  3  85 rr                sta varo
002E1C  3  A9 00        b00724: lda #0
002E1E  3  C5 rr                cmp varo
002E20  3  90 03                bcc *+5
002E22  3  4C 68 2E             jmp b00897
002E25  3  A9 00                lda #0
002E27  3  C5 rr                cmp vard
002E29  3  F0 03                beq *+5
002E2B  3  4C 68 2E             jmp b00897
002E2E  3  A9 F8                lda #248
002E30  3  85 rr                sta z80_c
002E32  3                       ; ldy #8
002E32  3  A0 08                ldy #8
002E34  3  B1 rr                lda (z80_ix),y
002E36  3  18                   clc
002E37  3  65 rr                adc z80_c
002E39  3                       ; ldy #8
002E39  3  91 rr                sta (z80_ix),y
002E3B  3  A9 01                lda #1
002E3D  3  85 rr                sta z80_b
002E3F  3  20 A4 1E             jsr sktyp
002E42  3  B0 03                bcs :+
002E44  3  4C 4B 2E             jmp b00827
002E47  3               :
002E47  3  A9 00                lda #0
002E49  3  85 rr                sta varo
002E4B  3  A9 08        b00827: lda #8
002E4D  3  85 rr                sta z80_b
002E4F  3  20 A4 1E             jsr sktyp
002E52  3  B0 03                bcs :+
002E54  3  4C 5B 2E             jmp b00857
002E57  3               :
002E57  3  A9 00                lda #0
002E59  3  85 rr                sta varo
002E5B  3  A9 08        b00857: lda #8
002E5D  3  85 rr                sta z80_c
002E5F  3                       ; ldy #8
002E5F  3  A0 08                ldy #8
002E61  3  B1 rr                lda (z80_ix),y
002E63  3  18                   clc
002E64  3  65 rr                adc z80_c
002E66  3                       ; ldy #8
002E66  3  91 rr                sta (z80_ix),y
002E68  3  A9 00        b00897: lda #0
002E6A  3  85 rr                sta varp
002E6C  3                       ; ldy #8
002E6C  3  A0 08                ldy #8
002E6E  3  B1 rr                lda (z80_ix),y
002E70  3  C9 B0                cmp #176
002E72  3  90 03                bcc *+5
002E74  3  4C EB 2E             jmp b01216
002E77  3  20 4D 18             jsr cangd
002E7A  3  F0 03                beq :+
002E7C  3  4C 83 2E             jmp b00953
002E7F  3               :
002E7F  3  A9 01                lda #1
002E81  3  85 rr                sta varp
002E83  3  A9 00        b00953: lda #0
002E85  3  C5 rr                cmp varp
002E87  3  F0 03                beq *+5
002E89  3  4C B7 2E             jmp b01084
002E8C  3  A9 00                lda #0
002E8E  3                       ; ldy #9
002E8E  3  A0 09                ldy #9
002E90  3  D1 rr                cmp (z80_ix),y
002E92  3  90 03                bcc *+5
002E94  3  4C B7 2E             jmp b01084
002E97  3  A9 FF                lda #255
002E99  3  85 rr                sta z80_c
002E9B  3                       ; ldy #9
002E9B  3  B1 rr                lda (z80_ix),y
002E9D  3  18                   clc
002E9E  3  65 rr                adc z80_c
002EA0  3                       ; ldy #9
002EA0  3  91 rr                sta (z80_ix),y
002EA2  3  20 4D 18             jsr cangd
002EA5  3  F0 03                beq :+
002EA7  3  4C AE 2E             jmp b01054
002EAA  3               :
002EAA  3  A9 02                lda #2
002EAC  3  85 rr                sta varp
002EAE  3               b01054: ; ldy #9
002EAE  3  A0 09                ldy #9
002EB0  3  B1 rr                lda (z80_ix),y
002EB2  3  18                   clc
002EB3  3  69 01                adc #1
002EB5  3                       ; ldy #9
002EB5  3  91 rr                sta (z80_ix),y
002EB7  3  A9 00        b01084: lda #0
002EB9  3  C5 rr                cmp varp
002EBB  3  F0 03                beq *+5
002EBD  3  4C EB 2E             jmp b01216
002EC0  3                       ; ldy #9
002EC0  3  A0 09                ldy #9
002EC2  3  B1 rr                lda (z80_ix),y
002EC4  3  C9 C0                cmp #192
002EC6  3  90 03                bcc *+5
002EC8  3  4C EB 2E             jmp b01216
002ECB  3                       ; ldy #9
002ECB  3  B1 rr                lda (z80_ix),y
002ECD  3  18                   clc
002ECE  3  69 01                adc #1
002ED0  3                       ; ldy #9
002ED0  3  91 rr                sta (z80_ix),y
002ED2  3  20 4D 18             jsr cangd
002ED5  3  F0 03                beq :+
002ED7  3  4C DE 2E             jmp b01176
002EDA  3               :
002EDA  3  A9 03                lda #3
002EDC  3  85 rr                sta varp
002EDE  3  A9 FF        b01176: lda #255
002EE0  3  85 rr                sta z80_c
002EE2  3                       ; ldy #9
002EE2  3  A0 09                ldy #9
002EE4  3  B1 rr                lda (z80_ix),y
002EE6  3  18                   clc
002EE7  3  65 rr                adc z80_c
002EE9  3                       ; ldy #9
002EE9  3  91 rr                sta (z80_ix),y
002EEB  3  A9 AF        b01216: lda #175
002EED  3                       ; ldy #8
002EED  3  A0 08                ldy #8
002EEF  3  D1 rr                cmp (z80_ix),y
002EF1  3  90 03                bcc *+5
002EF3  3  4C FE 2E             jmp b01265
002EF6  3  A9 B0                lda #176
002EF8  3                       ; ldy #8
002EF8  3  91 rr                sta (z80_ix),y
002EFA  3  A9 00                lda #0
002EFC  3  85 rr                sta varp
002EFE  3  A9 00        b01265: lda #0
002F00  3  C5 rr                cmp varp
002F02  3  90 03                bcc *+5
002F04  3  4C 4A 2F             jmp b01437
002F07  3  A9 01                lda #1
002F09  3  C5 rr                cmp vard
002F0B  3  F0 03                beq *+5
002F0D  3  4C 4A 2F             jmp b01437
002F10  3  A9 08                lda #8
002F12  3  85 rr                sta z80_c
002F14  3                       ; ldy #8
002F14  3  A0 08                ldy #8
002F16  3  B1 rr                lda (z80_ix),y
002F18  3  18                   clc
002F19  3  65 rr                adc z80_c
002F1B  3                       ; ldy #8
002F1B  3  91 rr                sta (z80_ix),y
002F1D  3  A9 01                lda #1
002F1F  3  85 rr                sta z80_b
002F21  3  20 A4 1E             jsr sktyp
002F24  3  B0 03                bcs :+
002F26  3  4C 2D 2F             jmp b01368
002F29  3               :
002F29  3  A9 00                lda #0
002F2B  3  85 rr                sta varp
002F2D  3  A9 08        b01368: lda #8
002F2F  3  85 rr                sta z80_b
002F31  3  20 A4 1E             jsr sktyp
002F34  3  B0 03                bcs :+
002F36  3  4C 3D 2F             jmp b01397
002F39  3               :
002F39  3  A9 00                lda #0
002F3B  3  85 rr                sta varp
002F3D  3  A9 F8        b01397: lda #248
002F3F  3  85 rr                sta z80_c
002F41  3                       ; ldy #8
002F41  3  A0 08                ldy #8
002F43  3  B1 rr                lda (z80_ix),y
002F45  3  18                   clc
002F46  3  65 rr                adc z80_c
002F48  3                       ; ldy #8
002F48  3  91 rr                sta (z80_ix),y
002F4A  3  A9 00        b01437: lda #0
002F4C  3  85 rr                sta vars
002F4E  3                       ; ldy #9
002F4E  3  A0 09                ldy #9
002F50  3  B1 rr                lda (z80_ix),y
002F52  3  C9 C0                cmp #192
002F54  3  90 03                bcc *+5
002F56  3  4C CD 2F             jmp b01757
002F59  3  20 94 18             jsr cangr
002F5C  3  F0 03                beq :+
002F5E  3  4C 65 2F             jmp b01494
002F61  3               :
002F61  3  A9 01                lda #1
002F63  3  85 rr                sta vars
002F65  3  A9 00        b01494: lda #0
002F67  3  C5 rr                cmp vars
002F69  3  F0 03                beq *+5
002F6B  3  4C 99 2F             jmp b01625
002F6E  3  A9 00                lda #0
002F70  3                       ; ldy #8
002F70  3  A0 08                ldy #8
002F72  3  D1 rr                cmp (z80_ix),y
002F74  3  90 03                bcc *+5
002F76  3  4C 99 2F             jmp b01625
002F79  3  A9 FF                lda #255
002F7B  3  85 rr                sta z80_c
002F7D  3                       ; ldy #8
002F7D  3  B1 rr                lda (z80_ix),y
002F7F  3  18                   clc
002F80  3  65 rr                adc z80_c
002F82  3                       ; ldy #8
002F82  3  91 rr                sta (z80_ix),y
002F84  3  20 94 18             jsr cangr
002F87  3  F0 03                beq :+
002F89  3  4C 90 2F             jmp b01594
002F8C  3               :
002F8C  3  A9 02                lda #2
002F8E  3  85 rr                sta vars
002F90  3               b01594: ; ldy #8
002F90  3  A0 08                ldy #8
002F92  3  B1 rr                lda (z80_ix),y
002F94  3  18                   clc
002F95  3  69 01                adc #1
002F97  3                       ; ldy #8
002F97  3  91 rr                sta (z80_ix),y
002F99  3  A9 00        b01625: lda #0
002F9B  3  C5 rr                cmp vars
002F9D  3  F0 03                beq *+5
002F9F  3  4C CD 2F             jmp b01757
002FA2  3                       ; ldy #8
002FA2  3  A0 08                ldy #8
002FA4  3  B1 rr                lda (z80_ix),y
002FA6  3  C9 B0                cmp #176
002FA8  3  90 03                bcc *+5
002FAA  3  4C CD 2F             jmp b01757
002FAD  3                       ; ldy #8
002FAD  3  B1 rr                lda (z80_ix),y
002FAF  3  18                   clc
002FB0  3  69 01                adc #1
002FB2  3                       ; ldy #8
002FB2  3  91 rr                sta (z80_ix),y
002FB4  3  20 94 18             jsr cangr
002FB7  3  F0 03                beq :+
002FB9  3  4C C0 2F             jmp b01717
002FBC  3               :
002FBC  3  A9 03                lda #3
002FBE  3  85 rr                sta vars
002FC0  3  A9 FF        b01717: lda #255
002FC2  3  85 rr                sta z80_c
002FC4  3                       ; ldy #8
002FC4  3  A0 08                ldy #8
002FC6  3  B1 rr                lda (z80_ix),y
002FC8  3  18                   clc
002FC9  3  65 rr                adc z80_c
002FCB  3                       ; ldy #8
002FCB  3  91 rr                sta (z80_ix),y
002FCD  3  A9 00        b01757: lda #0
002FCF  3  C5 rr                cmp vars
002FD1  3  90 03                bcc *+5
002FD3  3  4C 19 30             jmp b01929
002FD6  3  A9 02                lda #2
002FD8  3  C5 rr                cmp vard
002FDA  3  F0 03                beq *+5
002FDC  3  4C 19 30             jmp b01929
002FDF  3  A9 08                lda #8
002FE1  3  85 rr                sta z80_c
002FE3  3                       ; ldy #9
002FE3  3  A0 09                ldy #9
002FE5  3  B1 rr                lda (z80_ix),y
002FE7  3  18                   clc
002FE8  3  65 rr                adc z80_c
002FEA  3                       ; ldy #9
002FEA  3  91 rr                sta (z80_ix),y
002FEC  3  A9 01                lda #1
002FEE  3  85 rr                sta z80_b
002FF0  3  20 A4 1E             jsr sktyp
002FF3  3  B0 03                bcs :+
002FF5  3  4C FC 2F             jmp b01859
002FF8  3               :
002FF8  3  A9 00                lda #0
002FFA  3  85 rr                sta vars
002FFC  3  A9 08        b01859: lda #8
002FFE  3  85 rr                sta z80_b
003000  3  20 A4 1E             jsr sktyp
003003  3  B0 03                bcs :+
003005  3  4C 0C 30             jmp b01889
003008  3               :
003008  3  A9 00                lda #0
00300A  3  85 rr                sta vars
00300C  3  A9 F8        b01889: lda #248
00300E  3  85 rr                sta z80_c
003010  3                       ; ldy #9
003010  3  A0 09                ldy #9
003012  3  B1 rr                lda (z80_ix),y
003014  3  18                   clc
003015  3  65 rr                adc z80_c
003017  3                       ; ldy #9
003017  3  91 rr                sta (z80_ix),y
003019  3  A9 00        b01929: lda #0
00301B  3  85 rr                sta vart
00301D  3  A9 00                lda #0
00301F  3                       ; ldy #9
00301F  3  A0 09                ldy #9
003021  3  D1 rr                cmp (z80_ix),y
003023  3  90 03                bcc *+5
003025  3  4C 9C 30             jmp b02248
003028  3  20 82 18             jsr cangl
00302B  3  F0 03                beq :+
00302D  3  4C 34 30             jmp b01985
003030  3               :
003030  3  A9 01                lda #1
003032  3  85 rr                sta vart
003034  3  A9 00        b01985: lda #0
003036  3  C5 rr                cmp vart
003038  3  F0 03                beq *+5
00303A  3  4C 68 30             jmp b02116
00303D  3  A9 00                lda #0
00303F  3                       ; ldy #8
00303F  3  A0 08                ldy #8
003041  3  D1 rr                cmp (z80_ix),y
003043  3  90 03                bcc *+5
003045  3  4C 68 30             jmp b02116
003048  3  A9 FF                lda #255
00304A  3  85 rr                sta z80_c
00304C  3                       ; ldy #8
00304C  3  B1 rr                lda (z80_ix),y
00304E  3  18                   clc
00304F  3  65 rr                adc z80_c
003051  3                       ; ldy #8
003051  3  91 rr                sta (z80_ix),y
003053  3  20 82 18             jsr cangl
003056  3  F0 03                beq :+
003058  3  4C 5F 30             jmp b02086
00305B  3               :
00305B  3  A9 02                lda #2
00305D  3  85 rr                sta vart
00305F  3               b02086: ; ldy #8
00305F  3  A0 08                ldy #8
003061  3  B1 rr                lda (z80_ix),y
003063  3  18                   clc
003064  3  69 01                adc #1
003066  3                       ; ldy #8
003066  3  91 rr                sta (z80_ix),y
003068  3  A9 00        b02116: lda #0
00306A  3  C5 rr                cmp vart
00306C  3  F0 03                beq *+5
00306E  3  4C 9C 30             jmp b02248
003071  3                       ; ldy #8
003071  3  A0 08                ldy #8
003073  3  B1 rr                lda (z80_ix),y
003075  3  C9 B0                cmp #176
003077  3  90 03                bcc *+5
003079  3  4C 9C 30             jmp b02248
00307C  3                       ; ldy #8
00307C  3  B1 rr                lda (z80_ix),y
00307E  3  18                   clc
00307F  3  69 01                adc #1
003081  3                       ; ldy #8
003081  3  91 rr                sta (z80_ix),y
003083  3  20 82 18             jsr cangl
003086  3  F0 03                beq :+
003088  3  4C 8F 30             jmp b02208
00308B  3               :
00308B  3  A9 03                lda #3
00308D  3  85 rr                sta vart
00308F  3  A9 FF        b02208: lda #255
003091  3  85 rr                sta z80_c
003093  3                       ; ldy #8
003093  3  A0 08                ldy #8
003095  3  B1 rr                lda (z80_ix),y
003097  3  18                   clc
003098  3  65 rr                adc z80_c
00309A  3                       ; ldy #8
00309A  3  91 rr                sta (z80_ix),y
00309C  3  A9 00        b02248: lda #0
00309E  3  C5 rr                cmp vart
0030A0  3  90 03                bcc *+5
0030A2  3  4C E8 30             jmp b02420
0030A5  3  A9 03                lda #3
0030A7  3  C5 rr                cmp vard
0030A9  3  F0 03                beq *+5
0030AB  3  4C E8 30             jmp b02420
0030AE  3  A9 F8                lda #248
0030B0  3  85 rr                sta z80_c
0030B2  3                       ; ldy #9
0030B2  3  A0 09                ldy #9
0030B4  3  B1 rr                lda (z80_ix),y
0030B6  3  18                   clc
0030B7  3  65 rr                adc z80_c
0030B9  3                       ; ldy #9
0030B9  3  91 rr                sta (z80_ix),y
0030BB  3  A9 01                lda #1
0030BD  3  85 rr                sta z80_b
0030BF  3  20 A4 1E             jsr sktyp
0030C2  3  B0 03                bcs :+
0030C4  3  4C CB 30             jmp b02351
0030C7  3               :
0030C7  3  A9 00                lda #0
0030C9  3  85 rr                sta vart
0030CB  3  A9 08        b02351: lda #8
0030CD  3  85 rr                sta z80_b
0030CF  3  20 A4 1E             jsr sktyp
0030D2  3  B0 03                bcs :+
0030D4  3  4C DB 30             jmp b02381
0030D7  3               :
0030D7  3  A9 00                lda #0
0030D9  3  85 rr                sta vart
0030DB  3  A9 08        b02381: lda #8
0030DD  3  85 rr                sta z80_c
0030DF  3                       ; ldy #9
0030DF  3  A0 09                ldy #9
0030E1  3  B1 rr                lda (z80_ix),y
0030E3  3  18                   clc
0030E4  3  65 rr                adc z80_c
0030E6  3                       ; ldy #9
0030E6  3  91 rr                sta (z80_ix),y
0030E8  3  A9 00        b02420: lda #0
0030EA  3  85 rr                sta varq
0030EC  3  A9 02                lda #2
0030EE  3                       ; ldy #11
0030EE  3  A0 0B                ldy #11
0030F0  3  D1 rr                cmp (z80_ix),y
0030F2  3  F0 03                beq *+5
0030F4  3  4C 1A 31             jmp b02521
0030F7  3  A9 00                lda #0
0030F9  3  C5 rr                cmp varc
0030FB  3  F0 03                beq *+5
0030FD  3  4C 04 31             jmp b02480
003100  3  A9 01                lda #1
003102  3  85 rr                sta varq
003104  3  A9 03        b02480: lda #3
003106  3  C5 rr                cmp scno
003108  3  F0 03                beq *+5
00310A  3  4C 1A 31             jmp b02521
00310D  3  A9 02                lda #2
00310F  3  C5 rr                cmp varc
003111  3  F0 03                beq *+5
003113  3  4C 1A 31             jmp b02521
003116  3  A9 01                lda #1
003118  3  85 rr                sta varq
00311A  3  A9 01        b02521: lda #1
00311C  3                       ; ldy #11
00311C  3  A0 0B                ldy #11
00311E  3  D1 rr                cmp (z80_ix),y
003120  3  F0 03                beq *+5
003122  3  4C 3B 31             jmp b02590
003125  3  A9 01                lda #1
003127  3  C5 rr                cmp scno
003129  3  90 03                bcc *+5
00312B  3  4C 3B 31             jmp b02590
00312E  3  A9 00                lda #0
003130  3  C5 rr                cmp varc
003132  3  F0 03                beq *+5
003134  3  4C 3B 31             jmp b02590
003137  3  A9 01                lda #1
003139  3  85 rr                sta varq
00313B  3  A5 rr        b02590: lda vard
00313D  3  C9 02                cmp #2
00313F  3  90 03                bcc *+5
003141  3  4C 01 32             jmp b02965
003144  3  A5 rr                lda varb
003146  3                       ; ldy #9
003146  3  A0 09                ldy #9
003148  3  D1 rr                cmp (z80_ix),y
00314A  3  90 03                bcc *+5
00314C  3  4C 8E 31             jmp b02748
00314F  3  A9 00                lda #0
003151  3  C5 rr                cmp vart
003153  3  90 03                bcc *+5
003155  3  4C 5F 31             jmp b02663
003158  3  A9 03                lda #3
00315A  3  85 rr                sta vard
00315C  3  4C 8B 31             jmp b02743
00315F  3  A9 00        b02663: lda #0
003161  3  C5 rr                cmp vard
003163  3  F0 03                beq *+5
003165  3  4C 7B 31             jmp b02714
003168  3  A9 00                lda #0
00316A  3  C5 rr                cmp varo
00316C  3  90 03                bcc *+5
00316E  3  4C 74 31             jmp b02701
003171  3  4C 78 31             jmp b02709
003174  3  A9 01        b02701: lda #1
003176  3  85 rr                sta vard
003178  3  4C 8B 31     b02709: jmp b02743
00317B  3  A9 00        b02714: lda #0
00317D  3  C5 rr                cmp varp
00317F  3  90 03                bcc *+5
003181  3  4C 87 31             jmp b02735
003184  3  4C 8B 31             jmp b02743
003187  3  A9 00        b02735: lda #0
003189  3  85 rr                sta vard
00318B  3  4C FE 31     b02743: jmp b02960
00318E  3  A5 rr        b02748: lda varb
003190  3                       ; ldy #9
003190  3  A0 09                ldy #9
003192  3  D1 rr                cmp (z80_ix),y
003194  3  F0 03                beq *+5
003196  3  4C C2 31             jmp b02850
003199  3  A9 00                lda #0
00319B  3  C5 rr                cmp vard
00319D  3  F0 03                beq *+5
00319F  3  4C B2 31             jmp b02821
0031A2  3  A9 00                lda #0
0031A4  3  C5 rr                cmp varo
0031A6  3  F0 03                beq *+5
0031A8  3  4C AF 31             jmp b02816
0031AB  3  A9 01                lda #1
0031AD  3  85 rr                sta vard
0031AF  3  4C BF 31     b02816: jmp b02846
0031B2  3  A9 00        b02821: lda #0
0031B4  3  C5 rr                cmp varp
0031B6  3  F0 03                beq *+5
0031B8  3  4C BF 31             jmp b02846
0031BB  3  A9 00                lda #0
0031BD  3  85 rr                sta vard
0031BF  3  4C FE 31     b02846: jmp b02960
0031C2  3  A9 00        b02850: lda #0
0031C4  3  C5 rr                cmp vars
0031C6  3  90 03                bcc *+5
0031C8  3  4C D2 31             jmp b02880
0031CB  3  A9 02                lda #2
0031CD  3  85 rr                sta vard
0031CF  3  4C FE 31             jmp b02960
0031D2  3  A9 00        b02880: lda #0
0031D4  3  C5 rr                cmp vard
0031D6  3  F0 03                beq *+5
0031D8  3  4C EE 31             jmp b02931
0031DB  3  A9 00                lda #0
0031DD  3  C5 rr                cmp varo
0031DF  3  90 03                bcc *+5
0031E1  3  4C E7 31             jmp b02918
0031E4  3  4C EB 31             jmp b02926
0031E7  3  A9 01        b02918: lda #1
0031E9  3  85 rr                sta vard
0031EB  3  4C FE 31     b02926: jmp b02960
0031EE  3  A9 00        b02931: lda #0
0031F0  3  C5 rr                cmp varp
0031F2  3  90 03                bcc *+5
0031F4  3  4C FA 31             jmp b02952
0031F7  3  4C FE 31             jmp b02960
0031FA  3  A9 00        b02952: lda #0
0031FC  3  85 rr                sta vard
0031FE  3  4C C1 32     b02960: jmp b03329
003201  3               b02965: ; ldy #8
003201  3  A0 08                ldy #8
003203  3  B1 rr                lda (z80_ix),y
003205  3  C5 rr                cmp vara
003207  3  90 03                bcc *+5
003209  3  4C 4B 32             jmp b03107
00320C  3  A9 00                lda #0
00320E  3  C5 rr                cmp varp
003210  3  90 03                bcc *+5
003212  3  4C 1C 32             jmp b03021
003215  3  A9 01                lda #1
003217  3  85 rr                sta vard
003219  3  4C 48 32             jmp b03102
00321C  3  A9 03        b03021: lda #3
00321E  3  C5 rr                cmp vard
003220  3  F0 03                beq *+5
003222  3  4C 38 32             jmp b03072
003225  3  A9 00                lda #0
003227  3  C5 rr                cmp vart
003229  3  90 03                bcc *+5
00322B  3  4C 31 32             jmp b03060
00322E  3  4C 35 32             jmp b03068
003231  3  A9 02        b03060: lda #2
003233  3  85 rr                sta vard
003235  3  4C 48 32     b03068: jmp b03102
003238  3  A9 00        b03072: lda #0
00323A  3  C5 rr                cmp vars
00323C  3  90 03                bcc *+5
00323E  3  4C 44 32             jmp b03094
003241  3  4C 48 32             jmp b03102
003244  3  A9 03        b03094: lda #3
003246  3  85 rr                sta vard
003248  3  4C C1 32     b03102: jmp b03329
00324B  3  A5 rr        b03107: lda vara
00324D  3                       ; ldy #8
00324D  3  A0 08                ldy #8
00324F  3  D1 rr                cmp (z80_ix),y
003251  3  F0 03                beq *+5
003253  3  4C 85 32             jmp b03219
003256  3  A9 02                lda #2
003258  3  C5 rr                cmp vard
00325A  3  F0 03                beq *+5
00325C  3  4C 72 32             jmp b03184
00325F  3  A9 00                lda #0
003261  3  C5 rr                cmp vars
003263  3  90 03                bcc *+5
003265  3  4C 6B 32             jmp b03172
003268  3  4C 6F 32             jmp b03180
00326B  3  A9 03        b03172: lda #3
00326D  3  85 rr                sta vard
00326F  3  4C 82 32     b03180: jmp b03214
003272  3  A9 00        b03184: lda #0
003274  3  C5 rr                cmp vart
003276  3  90 03                bcc *+5
003278  3  4C 7E 32             jmp b03206
00327B  3  4C 82 32             jmp b03214
00327E  3  A9 02        b03206: lda #2
003280  3  85 rr                sta vard
003282  3  4C C1 32     b03214: jmp b03329
003285  3  A9 00        b03219: lda #0
003287  3  C5 rr                cmp varo
003289  3  90 03                bcc *+5
00328B  3  4C 95 32             jmp b03248
00328E  3  A9 00                lda #0
003290  3  85 rr                sta vard
003292  3  4C C1 32             jmp b03329
003295  3  A9 02        b03248: lda #2
003297  3  C5 rr                cmp vard
003299  3  F0 03                beq *+5
00329B  3  4C B1 32             jmp b03299
00329E  3  A9 00                lda #0
0032A0  3  C5 rr                cmp vars
0032A2  3  90 03                bcc *+5
0032A4  3  4C AA 32             jmp b03286
0032A7  3  4C AE 32             jmp b03294
0032AA  3  A9 03        b03286: lda #3
0032AC  3  85 rr                sta vard
0032AE  3  4C C1 32     b03294: jmp b03329
0032B1  3  A9 00        b03299: lda #0
0032B3  3  C5 rr                cmp vart
0032B5  3  90 03                bcc *+5
0032B7  3  4C BD 32             jmp b03321
0032BA  3  4C C1 32             jmp b03329
0032BD  3  A9 02        b03321: lda #2
0032BF  3  85 rr                sta vard
0032C1  3  A5 rr        b03329: lda vard
0032C3  3                       ; ldy #6
0032C3  3  A0 06                ldy #6
0032C5  3  91 rr                sta (z80_ix),y
0032C7  3  A9 09                lda #9
0032C9  3  85 rr                sta z80_c
0032CB  3                       ; ldy #6
0032CB  3  B1 rr                lda (z80_ix),y
0032CD  3  18                   clc
0032CE  3  65 rr                adc z80_c
0032D0  3                       ; ldy #6
0032D0  3  91 rr                sta (z80_ix),y
0032D2  3  A9 00                lda #0
0032D4  3                       ; ldy #11
0032D4  3  A0 0B                ldy #11
0032D6  3  D1 rr                cmp (z80_ix),y
0032D8  3  F0 03                beq *+5
0032DA  3  4C 18 33             jmp b03523
0032DD  3  A9 00                lda #0
0032DF  3  C5 rr                cmp varc
0032E1  3  F0 03                beq *+5
0032E3  3  4C F6 32             jmp b03458
0032E6  3  A9 00                lda #0
0032E8  3  85 rr                sta varo
0032EA  3  A9 00                lda #0
0032EC  3  85 rr                sta varp
0032EE  3  A9 00                lda #0
0032F0  3  85 rr                sta vars
0032F2  3  A9 00                lda #0
0032F4  3  85 rr                sta vart
0032F6  3  A9 00        b03458: lda #0
0032F8  3  C5 rr                cmp scno
0032FA  3  F0 03                beq *+5
0032FC  3  4C 18 33             jmp b03523
0032FF  3  A9 02                lda #2
003301  3  C5 rr                cmp varc
003303  3  F0 03                beq *+5
003305  3  4C 18 33             jmp b03523
003308  3  A9 00                lda #0
00330A  3  85 rr                sta varo
00330C  3  A9 00                lda #0
00330E  3  85 rr                sta varp
003310  3  A9 00                lda #0
003312  3  85 rr                sta vars
003314  3  A9 00                lda #0
003316  3  85 rr                sta vart
003318  3  A9 00        b03523: lda #0
00331A  3  C5 rr                cmp vard
00331C  3  F0 03                beq *+5
00331E  3  4C A5 33             jmp b03879
003321  3  A9 00                lda #0
003323  3  C5 rr                cmp varo
003325  3  90 03                bcc *+5
003327  3  4C A5 33             jmp b03879
00332A  3  A9 02                lda #2
00332C  3  C5 rr                cmp varo
00332E  3  F0 03                beq *+5
003330  3  4C 40 33             jmp b03614
003333  3  A9 FF                lda #255
003335  3  85 rr                sta z80_c
003337  3                       ; ldy #9
003337  3  A0 09                ldy #9
003339  3  B1 rr                lda (z80_ix),y
00333B  3  18                   clc
00333C  3  65 rr                adc z80_c
00333E  3                       ; ldy #9
00333E  3  91 rr                sta (z80_ix),y
003340  3  A9 03        b03614: lda #3
003342  3  C5 rr                cmp varo
003344  3  F0 03                beq *+5
003346  3  4C 52 33             jmp b03661
003349  3                       ; ldy #9
003349  3  A0 09                ldy #9
00334B  3  B1 rr                lda (z80_ix),y
00334D  3  18                   clc
00334E  3  69 01                adc #1
003350  3                       ; ldy #9
003350  3  91 rr                sta (z80_ix),y
003352  3  A9 00        b03661: lda #0
003354  3                       ; ldy #8
003354  3  A0 08                ldy #8
003356  3  D1 rr                cmp (z80_ix),y
003358  3  90 03                bcc *+5
00335A  3  4C 68 33             jmp b03723
00335D  3  A9 FF                lda #255
00335F  3  85 rr                sta z80_c
003361  3                       ; ldy #8
003361  3  B1 rr                lda (z80_ix),y
003363  3  18                   clc
003364  3  65 rr                adc z80_c
003366  3                       ; ldy #8
003366  3  91 rr                sta (z80_ix),y
003368  3  A9 00        b03723: lda #0
00336A  3                       ; ldy #8
00336A  3  A0 08                ldy #8
00336C  3  D1 rr                cmp (z80_ix),y
00336E  3  90 03                bcc *+5
003370  3  4C 7E 33             jmp b03786
003373  3  A9 FF                lda #255
003375  3  85 rr                sta z80_c
003377  3                       ; ldy #8
003377  3  B1 rr                lda (z80_ix),y
003379  3  18                   clc
00337A  3  65 rr                adc z80_c
00337C  3                       ; ldy #8
00337C  3  91 rr                sta (z80_ix),y
00337E  3  A9 01        b03786: lda #1
003380  3  C5 rr                cmp varq
003382  3  F0 03                beq *+5
003384  3  4C A5 33             jmp b03879
003387  3  A9 00                lda #0
003389  3                       ; ldy #8
003389  3  A0 08                ldy #8
00338B  3  D1 rr                cmp (z80_ix),y
00338D  3  90 03                bcc *+5
00338F  3  4C A5 33             jmp b03879
003392  3  20 18 18             jsr cangu
003395  3  F0 03                beq :+
003397  3  4C A5 33             jmp b03879
00339A  3               :
00339A  3  A9 FF                lda #255
00339C  3  85 rr                sta z80_c
00339E  3                       ; ldy #8
00339E  3  B1 rr                lda (z80_ix),y
0033A0  3  18                   clc
0033A1  3  65 rr                adc z80_c
0033A3  3                       ; ldy #8
0033A3  3  91 rr                sta (z80_ix),y
0033A5  3  A9 01        b03879: lda #1
0033A7  3  C5 rr                cmp vard
0033A9  3  F0 03                beq *+5
0033AB  3  4C 0B 34             jmp b04122
0033AE  3  A9 00                lda #0
0033B0  3  C5 rr                cmp varp
0033B2  3  90 03                bcc *+5
0033B4  3  4C 0B 34             jmp b04122
0033B7  3  A9 02                lda #2
0033B9  3  C5 rr                cmp varp
0033BB  3  F0 03                beq *+5
0033BD  3  4C CD 33             jmp b03969
0033C0  3  A9 FF                lda #255
0033C2  3  85 rr                sta z80_c
0033C4  3                       ; ldy #9
0033C4  3  A0 09                ldy #9
0033C6  3  B1 rr                lda (z80_ix),y
0033C8  3  18                   clc
0033C9  3  65 rr                adc z80_c
0033CB  3                       ; ldy #9
0033CB  3  91 rr                sta (z80_ix),y
0033CD  3  A9 03        b03969: lda #3
0033CF  3  C5 rr                cmp varp
0033D1  3  F0 03                beq *+5
0033D3  3  4C DF 33             jmp b04016
0033D6  3                       ; ldy #9
0033D6  3  A0 09                ldy #9
0033D8  3  B1 rr                lda (z80_ix),y
0033DA  3  18                   clc
0033DB  3  69 01                adc #1
0033DD  3                       ; ldy #9
0033DD  3  91 rr                sta (z80_ix),y
0033DF  3  A0 08        b04016: ldy #8
0033E1  3  B1 rr                lda (z80_ix),y
0033E3  3  18                   clc
0033E4  3  69 02                adc #2
0033E6  3  91 rr                sta (z80_ix),y
0033E8  3  A9 01                lda #1
0033EA  3  C5 rr                cmp varq
0033EC  3  F0 03                beq *+5
0033EE  3  4C 0B 34             jmp b04122
0033F1  3                       ; ldy #8
0033F1  3  A0 08                ldy #8
0033F3  3  B1 rr                lda (z80_ix),y
0033F5  3  C9 B0                cmp #176
0033F7  3  90 03                bcc *+5
0033F9  3  4C 0B 34             jmp b04122
0033FC  3  20 4D 18             jsr cangd
0033FF  3  F0 03                beq :+
003401  3  4C 0B 34             jmp b04122
003404  3               :
003404  3                       ; ldy #8
003404  3  B1 rr                lda (z80_ix),y
003406  3  18                   clc
003407  3  69 01                adc #1
003409  3                       ; ldy #8
003409  3  91 rr                sta (z80_ix),y
00340B  3  A9 02        b04122: lda #2
00340D  3  C5 rr                cmp vard
00340F  3  F0 03                beq *+5
003411  3  4C 71 34             jmp b04365
003414  3  A9 00                lda #0
003416  3  C5 rr                cmp vars
003418  3  90 03                bcc *+5
00341A  3  4C 71 34             jmp b04365
00341D  3  A9 02                lda #2
00341F  3  C5 rr                cmp vars
003421  3  F0 03                beq *+5
003423  3  4C 33 34             jmp b04212
003426  3  A9 FF                lda #255
003428  3  85 rr                sta z80_c
00342A  3                       ; ldy #8
00342A  3  A0 08                ldy #8
00342C  3  B1 rr                lda (z80_ix),y
00342E  3  18                   clc
00342F  3  65 rr                adc z80_c
003431  3                       ; ldy #8
003431  3  91 rr                sta (z80_ix),y
003433  3  A9 03        b04212: lda #3
003435  3  C5 rr                cmp vars
003437  3  F0 03                beq *+5
003439  3  4C 45 34             jmp b04259
00343C  3                       ; ldy #8
00343C  3  A0 08                ldy #8
00343E  3  B1 rr                lda (z80_ix),y
003440  3  18                   clc
003441  3  69 01                adc #1
003443  3                       ; ldy #8
003443  3  91 rr                sta (z80_ix),y
003445  3  A0 09        b04259: ldy #9
003447  3  B1 rr                lda (z80_ix),y
003449  3  18                   clc
00344A  3  69 02                adc #2
00344C  3  91 rr                sta (z80_ix),y
00344E  3  A9 01                lda #1
003450  3  C5 rr                cmp varq
003452  3  F0 03                beq *+5
003454  3  4C 71 34             jmp b04365
003457  3                       ; ldy #9
003457  3  A0 09                ldy #9
003459  3  B1 rr                lda (z80_ix),y
00345B  3  C9 C0                cmp #192
00345D  3  90 03                bcc *+5
00345F  3  4C 71 34             jmp b04365
003462  3  20 94 18             jsr cangr
003465  3  F0 03                beq :+
003467  3  4C 71 34             jmp b04365
00346A  3               :
00346A  3                       ; ldy #9
00346A  3  B1 rr                lda (z80_ix),y
00346C  3  18                   clc
00346D  3  69 01                adc #1
00346F  3                       ; ldy #9
00346F  3  91 rr                sta (z80_ix),y
003471  3  A9 03        b04365: lda #3
003473  3  C5 rr                cmp vard
003475  3  F0 03                beq *+5
003477  3  4C DB 34             jmp b04617
00347A  3  A9 00                lda #0
00347C  3  C5 rr                cmp vart
00347E  3  90 03                bcc *+5
003480  3  4C DB 34             jmp b04617
003483  3  A9 02                lda #2
003485  3  C5 rr                cmp vart
003487  3  F0 03                beq *+5
003489  3  4C 99 34             jmp b04455
00348C  3  A9 FF                lda #255
00348E  3  85 rr                sta z80_c
003490  3                       ; ldy #8
003490  3  A0 08                ldy #8
003492  3  B1 rr                lda (z80_ix),y
003494  3  18                   clc
003495  3  65 rr                adc z80_c
003497  3                       ; ldy #8
003497  3  91 rr                sta (z80_ix),y
003499  3  A9 03        b04455: lda #3
00349B  3  C5 rr                cmp vart
00349D  3  F0 03                beq *+5
00349F  3  4C AB 34             jmp b04503
0034A2  3                       ; ldy #8
0034A2  3  A0 08                ldy #8
0034A4  3  B1 rr                lda (z80_ix),y
0034A6  3  18                   clc
0034A7  3  69 01                adc #1
0034A9  3                       ; ldy #8
0034A9  3  91 rr                sta (z80_ix),y
0034AB  3  A0 09        b04503: ldy #9
0034AD  3  B1 rr                lda (z80_ix),y
0034AF  3  38                   sec
0034B0  3  E9 02                sbc #2
0034B2  3  91 rr                sta (z80_ix),y
0034B4  3  A9 01                lda #1
0034B6  3  C5 rr                cmp varq
0034B8  3  F0 03                beq *+5
0034BA  3  4C DB 34             jmp b04617
0034BD  3  A9 00                lda #0
0034BF  3                       ; ldy #9
0034BF  3  A0 09                ldy #9
0034C1  3  D1 rr                cmp (z80_ix),y
0034C3  3  90 03                bcc *+5
0034C5  3  4C DB 34             jmp b04617
0034C8  3  20 82 18             jsr cangl
0034CB  3  F0 03                beq :+
0034CD  3  4C DB 34             jmp b04617
0034D0  3               :
0034D0  3  A9 FF                lda #255
0034D2  3  85 rr                sta z80_c
0034D4  3                       ; ldy #9
0034D4  3  B1 rr                lda (z80_ix),y
0034D6  3  18                   clc
0034D7  3  65 rr                adc z80_c
0034D9  3                       ; ldy #9
0034D9  3  91 rr                sta (z80_ix),y
0034DB  3               b04617: ; ldy #8
0034DB  3  A0 08                ldy #8
0034DD  3  B1 rr                lda (z80_ix),y
0034DF  3  85 rr                sta varo
0034E1  3  A5 rr                lda varo
0034E3  3  4A                   lsr a
0034E4  3  85 rr                sta varo
0034E6  3  A5 rr                lda varo
0034E8  3  0A                   asl a
0034E9  3  85 rr                sta varo
0034EB  3  A5 rr                lda varo
0034ED  3                       ; ldy #8
0034ED  3  D1 rr                cmp (z80_ix),y
0034EF  3  90 03                bcc *+5
0034F1  3  4C 14 35             jmp b04771
0034F4  3  A9 00                lda #0
0034F6  3  C5 rr                cmp vard
0034F8  3  F0 03                beq *+5
0034FA  3  4C 0B 35             jmp b04740
0034FD  3  A9 FF                lda #255
0034FF  3  85 rr                sta z80_c
003501  3                       ; ldy #8
003501  3  B1 rr                lda (z80_ix),y
003503  3  18                   clc
003504  3  65 rr                adc z80_c
003506  3                       ; ldy #8
003506  3  91 rr                sta (z80_ix),y
003508  3  4C 14 35             jmp b04771
00350B  3               b04740: ; ldy #8
00350B  3  A0 08                ldy #8
00350D  3  B1 rr                lda (z80_ix),y
00350F  3  18                   clc
003510  3  69 01                adc #1
003512  3                       ; ldy #8
003512  3  91 rr                sta (z80_ix),y
003514  3               b04771: ; ldy #9
003514  3  A0 09                ldy #9
003516  3  B1 rr                lda (z80_ix),y
003518  3  85 rr                sta varp
00351A  3  A5 rr                lda varp
00351C  3  4A                   lsr a
00351D  3  85 rr                sta varp
00351F  3  A5 rr                lda varp
003521  3  0A                   asl a
003522  3  85 rr                sta varp
003524  3  A5 rr                lda varp
003526  3                       ; ldy #9
003526  3  D1 rr                cmp (z80_ix),y
003528  3  90 03                bcc *+5
00352A  3  4C 4D 35             jmp b04924
00352D  3  A9 02                lda #2
00352F  3  C5 rr                cmp vard
003531  3  F0 03                beq *+5
003533  3  4C 40 35             jmp b04884
003536  3                       ; ldy #9
003536  3  B1 rr                lda (z80_ix),y
003538  3  18                   clc
003539  3  69 01                adc #1
00353B  3                       ; ldy #9
00353B  3  91 rr                sta (z80_ix),y
00353D  3  4C 4D 35             jmp b04924
003540  3  A9 FF        b04884: lda #255
003542  3  85 rr                sta z80_c
003544  3                       ; ldy #9
003544  3  A0 09                ldy #9
003546  3  B1 rr                lda (z80_ix),y
003548  3  18                   clc
003549  3  65 rr                adc z80_c
00354B  3                       ; ldy #9
00354B  3  91 rr                sta (z80_ix),y
00354D  3  A5 rr        b04924: lda vard
00354F  3                       ; ldy #10
00354F  3  A0 0A                ldy #10
003551  3  91 rr                sta (z80_ix),y
003553  3  A9 02                lda #2
003555  3                       ; ldy #11
003555  3  C8                   iny
003556  3  D1 rr                cmp (z80_ix),y
003558  3  F0 03                beq *+5
00355A  3  4C 5D 35             jmp b04968
00355D  3  A9 01        b04968: lda #1
00355F  3                       ; ldy #11
00355F  3  A0 0B                ldy #11
003561  3  D1 rr                cmp (z80_ix),y
003563  3  F0 03                beq *+5
003565  3  4C 68 35             jmp b04995
003568  3  60           b04995: rts
003569  3               .out .sprintf("EVENT 1 SIZE = %d", (* - evnt01))
003569  3               
003569  3               evnt02:
003569  3  A9 00                lda #0
00356B  3  C5 rr                cmp clock
00356D  3  F0 03                beq *+5
00356F  3  4C B7 35             jmp c00199
003572  3                       ; ldy #10
003572  3  A0 0A                ldy #10
003574  3  B1 rr                lda (z80_ix),y
003576  3  38                   sec
003577  3  E9 01                sbc #1
003579  3                       ; ldy #10
003579  3  91 rr                sta (z80_ix),y
00357B  3  A9 FA                lda #250
00357D  3                       ; ldy #10
00357D  3  D1 rr                cmp (z80_ix),y
00357F  3  F0 03                beq *+5
003581  3  4C B7 35             jmp c00199
003584  3  A5 rr                lda vara
003586  3                       ; ldy #8
003586  3  A0 08                ldy #8
003588  3  91 rr                sta (z80_ix),y
00358A  3  A5 rr                lda varb
00358C  3                       ; ldy #9
00358C  3  C8                   iny
00358D  3  91 rr                sta (z80_ix),y
00358F  3  A9 00                lda #0
003591  3  85 rr                sta z80_b
003593  3  20 A4 1E             jsr sktyp
003596  3  B0 03                bcs :+
003598  3  4C B7 35             jmp c00199
00359B  3               :
00359B  3  A5 rr                lda skptr
00359D  3  85 rr                sta z80_x
00359F  3  A5 rr                lda skptr+1
0035A1  3  85 rr                sta z80_i
0035A3  3  A9 00                lda #0
0035A5  3                       ; ldy #11
0035A5  3  A0 0B                ldy #11
0035A7  3  91 rr                sta (z80_ix),y
0035A9  3  A5 rr                lda ogptr
0035AB  3  85 rr                sta z80_x
0035AD  3  A5 rr                lda ogptr+1
0035AF  3  85 rr                sta z80_i
0035B1  3  A9 FF                lda #255
0035B3  3  A0 05                ldy #5
0035B5  3  91 rr                sta (z80_ix),y
0035B7  3  A9 03        c00199: lda #3
0035B9  3  C5 rr                cmp varg
0035BB  3  F0 03                beq *+5
0035BD  3  4C F3 35             jmp c00341
0035C0  3  A5 rr                lda vara
0035C2  3                       ; ldy #8
0035C2  3  A0 08                ldy #8
0035C4  3  91 rr                sta (z80_ix),y
0035C6  3  A5 rr                lda varb
0035C8  3                       ; ldy #9
0035C8  3  C8                   iny
0035C9  3  91 rr                sta (z80_ix),y
0035CB  3  A9 00                lda #0
0035CD  3  85 rr                sta z80_b
0035CF  3  20 A4 1E             jsr sktyp
0035D2  3  B0 03                bcs :+
0035D4  3  4C F3 35             jmp c00341
0035D7  3               :
0035D7  3  A5 rr                lda skptr
0035D9  3  85 rr                sta z80_x
0035DB  3  A5 rr                lda skptr+1
0035DD  3  85 rr                sta z80_i
0035DF  3  A9 00                lda #0
0035E1  3                       ; ldy #11
0035E1  3  A0 0B                ldy #11
0035E3  3  91 rr                sta (z80_ix),y
0035E5  3  A5 rr                lda ogptr
0035E7  3  85 rr                sta z80_x
0035E9  3  A5 rr                lda ogptr+1
0035EB  3  85 rr                sta z80_i
0035ED  3  A9 FF                lda #255
0035EF  3  A0 05                ldy #5
0035F1  3  91 rr                sta (z80_ix),y
0035F3  3  A9 00        c00341: lda #0
0035F5  3  C5 rr                cmp varc
0035F7  3  F0 03                beq *+5
0035F9  3  4C 01 36             jmp c00367
0035FC  3  A9 00                lda #0
0035FE  3  20 59 1E             jsr animsp
003601  3  A9 01        c00367: lda #1
003603  3  85 rr                sta z80_b
003605  3  20 A4 1E             jsr sktyp
003608  3  B0 03                bcs :+
00360A  3  4C FA 36             jmp c00960
00360D  3               :
00360D  3  A5 rr                lda ogptr
00360F  3  85 rr                sta z80_x
003611  3  A5 rr                lda ogptr+1
003613  3  85 rr                sta z80_i
003615  3                       ; ldy #8
003615  3  A0 08                ldy #8
003617  3  B1 rr                lda (z80_ix),y
003619  3  85 rr                sta varo
00361B  3                       ; ldy #9
00361B  3  C8                   iny
00361C  3  B1 rr                lda (z80_ix),y
00361E  3  85 rr                sta varp
003620  3  A5 rr                lda skptr
003622  3  85 rr                sta z80_x
003624  3  A5 rr                lda skptr+1
003626  3  85 rr                sta z80_i
003628  3  A5 rr                lda varo
00362A  3  85 rr                sta varq
00362C  3                       ; ldy #8
00362C  3  88                   dey
00362D  3  B1 rr                lda (z80_ix),y
00362F  3  C5 rr                cmp varo
003631  3  90 03                bcc *+5
003633  3  4C 44 36             jmp c00530
003636  3                       ; ldy #8
003636  3  B1 rr                lda (z80_ix),y
003638  3  85 rr                sta z80_c
00363A  3  A5 rr                lda varq
00363C  3  38                   sec
00363D  3  E5 rr                sbc z80_c
00363F  3  85 rr                sta varq
003641  3  4C 55 36             jmp c00573
003644  3               c00530: ; ldy #8
003644  3  A0 08                ldy #8
003646  3  B1 rr                lda (z80_ix),y
003648  3  85 rr                sta varq
00364A  3  A5 rr                lda varo
00364C  3  85 rr                sta z80_c
00364E  3  A5 rr                lda varq
003650  3  38                   sec
003651  3  E5 rr                sbc z80_c
003653  3  85 rr                sta varq
003655  3  A5 rr        c00573: lda varq
003657  3  C9 05                cmp #5
003659  3  90 03                bcc *+5
00365B  3  4C FA 36             jmp c00960
00365E  3  A5 rr                lda varp
003660  3  85 rr                sta varq
003662  3                       ; ldy #9
003662  3  A0 09                ldy #9
003664  3  B1 rr                lda (z80_ix),y
003666  3  C5 rr                cmp varp
003668  3  90 03                bcc *+5
00366A  3  4C 7B 36             jmp c00660
00366D  3                       ; ldy #9
00366D  3  B1 rr                lda (z80_ix),y
00366F  3  85 rr                sta z80_c
003671  3  A5 rr                lda varq
003673  3  38                   sec
003674  3  E5 rr                sbc z80_c
003676  3  85 rr                sta varq
003678  3  4C 8C 36             jmp c00703
00367B  3               c00660: ; ldy #9
00367B  3  A0 09                ldy #9
00367D  3  B1 rr                lda (z80_ix),y
00367F  3  85 rr                sta varq
003681  3  A5 rr                lda varp
003683  3  85 rr                sta z80_c
003685  3  A5 rr                lda varq
003687  3  38                   sec
003688  3  E5 rr                sbc z80_c
00368A  3  85 rr                sta varq
00368C  3  A5 rr        c00703: lda varq
00368E  3  C9 05                cmp #5
003690  3  90 03                bcc *+5
003692  3  4C FA 36             jmp c00960
003695  3  A9 32                lda #<50
003697  3  85 rr                sta z80_l
003699  3  A9 00                lda #>50
00369B  3  85 rr                sta z80_h
00369D  3  20 95 15             jsr addsc
0036A0  3  A9 01                lda #1
0036A2  3  85 rr                sta chary
0036A4  3  A9 1B                lda #27
0036A6  3  85 rr                sta charx
0036A8  3  20 49 15             jsr dscor
0036AB  3  A9 04                lda #4
0036AD  3  85 rr                sta chary
0036AF  3  A9 1B                lda #27
0036B1  3  85 rr                sta charx
0036B3  3  A9 64                lda #100
0036B5  3                       ; ldy #12
0036B5  3  A0 0C                ldy #12
0036B7  3  91 rr                sta (z80_ix),y
0036B9  3  A9 08                lda #8
0036BB  3                       ; ldy #5
0036BB  3  A0 05                ldy #5
0036BD  3  91 rr                sta (z80_ix),y
0036BF  3  A5 rr                lda ogptr
0036C1  3  85 rr                sta z80_x
0036C3  3  A5 rr                lda ogptr+1
0036C5  3  85 rr                sta z80_i
0036C7  3  A5 rr                lda vara
0036C9  3                       ; ldy #8
0036C9  3  A0 08                ldy #8
0036CB  3  91 rr                sta (z80_ix),y
0036CD  3  A5 rr                lda varb
0036CF  3                       ; ldy #9
0036CF  3  C8                   iny
0036D0  3  91 rr                sta (z80_ix),y
0036D2  3  A9 00                lda #0
0036D4  3  85 rr                sta z80_b
0036D6  3  20 A4 1E             jsr sktyp
0036D9  3  B0 03                bcs :+
0036DB  3  4C FA 36             jmp c00960
0036DE  3               :
0036DE  3  A5 rr                lda skptr
0036E0  3  85 rr                sta z80_x
0036E2  3  A5 rr                lda skptr+1
0036E4  3  85 rr                sta z80_i
0036E6  3  A9 00                lda #0
0036E8  3                       ; ldy #11
0036E8  3  A0 0B                ldy #11
0036EA  3  91 rr                sta (z80_ix),y
0036EC  3  A5 rr                lda ogptr
0036EE  3  85 rr                sta z80_x
0036F0  3  A5 rr                lda ogptr+1
0036F2  3  85 rr                sta z80_i
0036F4  3  A9 FF                lda #255
0036F6  3  A0 05                ldy #5
0036F8  3  91 rr                sta (z80_ix),y
0036FA  3  60           c00960: rts
0036FB  3               .out .sprintf("EVENT 2 SIZE = %d", (* - evnt02))
0036FB  3               
0036FB  3               evnt03:
0036FB  3                       ; ldy #8
0036FB  3  A0 08                ldy #8
0036FD  3  B1 rr                lda (z80_ix),y
0036FF  3  C9 C8                cmp #200
003701  3  90 03                bcc *+5
003703  3  4C 42 38             jmp d00672
003706  3  A9 00                lda #0
003708  3  85 rr                sta z80_b
00370A  3  20 A4 1E             jsr sktyp
00370D  3  B0 03                bcs :+
00370F  3  4C 42 38             jmp d00672
003712  3               :
003712  3  A9 96                lda #<150
003714  3  85 rr                sta z80_l
003716  3  A9 00                lda #>150
003718  3  85 rr                sta z80_h
00371A  3  20 95 15             jsr addsc
00371D  3  A9 01                lda #1
00371F  3  85 rr                sta chary
003721  3  A9 1B                lda #27
003723  3  85 rr                sta charx
003725  3  20 49 15             jsr dscor
003728  3  A9 04                lda #4
00372A  3  85 rr                sta chary
00372C  3  A9 1B                lda #27
00372E  3  85 rr                sta charx
003730  3  A5 rr                lda skptr
003732  3  85 rr                sta z80_x
003734  3  A5 rr                lda skptr+1
003736  3  85 rr                sta z80_i
003738  3  A9 00                lda #0
00373A  3  85 rr                sta varg
00373C  3  A5 rr                lda vari
00373E  3  18                   clc
00373F  3  69 01                adc #1
003741  3  85 rr                sta vari
003743  3  A5 rr                lda vari
003745  3  85 rr                sta varo
003747  3  A9 19                lda #25
003749  3  C5 rr                cmp vari
00374B  3  F0 03                beq *+5
00374D  3  4C 57 37             jmp d00194
003750  3  A5 rr                lda numlif
003752  3  18                   clc
003753  3  69 01                adc #1
003755  3  85 rr                sta numlif
003757  3  A9 32        d00194: lda #50
003759  3  C5 rr                cmp vari
00375B  3  F0 03                beq *+5
00375D  3  4C 67 37             jmp d00227
003760  3  A5 rr                lda numlif
003762  3  18                   clc
003763  3  69 01                adc #1
003765  3  85 rr                sta numlif
003767  3  A5 rr        d00227: lda vari
003769  3  C5 rr                cmp varo
00376B  3  90 03                bcc *+5
00376D  3  4C AA 37             jmp d00361
003770  3  A9 02                lda #2
003772  3  85 rr                sta chary
003774  3  A9 1A                lda #26
003776  3  85 rr                sta charx
003778  3  A9 18                lda #24
00377A  3  20 ED 1A             jsr dmsg
00377D  3  A9 02                lda #2
00377F  3  85 rr                sta chary
003781  3  A9 1D                lda #29
003783  3  85 rr                sta charx
003785  3  A9 18                lda #24
003787  3  20 ED 1A             jsr dmsg
00378A  3  A9 02                lda #2
00378C  3  85 rr                sta chary
00378E  3  A9 1B                lda #27
003790  3  85 rr                sta charx
003792  3  A5 rr                lda numlif
003794  3  85 rr                sta loopa
003796  3  A5 rr        d00321: lda charx
003798  3  85 rr                sta dispx
00379A  3  A5 rr                lda chary
00379C  3  85 rr                sta dispy
00379E  3  A9 57                lda #87
0037A0  3  20 C9 16             jsr pattr
0037A3  3  C6 rr                dec loopa
0037A5  3  F0 03                beq :+
0037A7  3  4C 96 37             jmp d00321
0037AA  3               :
0037AA  3  A5 rr        d00361: lda varj
0037AC  3  18                   clc
0037AD  3  69 01                adc #1
0037AF  3  85 rr                sta varj
0037B1  3  A9 0D                lda #13
0037B3  3  85 rr                sta chary
0037B5  3  A9 1D                lda #29
0037B7  3  85 rr                sta charx
0037B9  3  A9 18                lda #24
0037BB  3  20 ED 1A             jsr dmsg
0037BE  3  A9 0D                lda #13
0037C0  3  85 rr                sta chary
0037C2  3  A9 1D                lda #29
0037C4  3  85 rr                sta charx
0037C6  3  A5 rr                lda vari
0037C8  3  20 34 1F             jsr disply
0037CB  3  A5 rr                lda scno
0037CD  3  C9 02                cmp #2
0037CF  3  90 03                bcc *+5
0037D1  3  4C EF 37             jmp d00494
0037D4  3  A9 06                lda #6
0037D6  3  C5 rr                cmp varj
0037D8  3  F0 03                beq *+5
0037DA  3  4C EC 37             jmp d00490
0037DD  3  A9 00                lda #0
0037DF  3  85 rr                sta varj
0037E1  3  A9 00                lda #0
0037E3  3  85 rr                sta scno
0037E5  3  20 AD 1F             jsr nwscr
0037E8  3  A9 01                lda #1
0037EA  3  85 rr                sta restfl
0037EC  3  4C 2E 38     d00490: jmp d00617
0037EF  3  A9 07        d00494: lda #7
0037F1  3  C5 rr                cmp varj
0037F3  3  F0 03                beq *+5
0037F5  3  4C 2E 38             jmp d00617
0037F8  3  A9 07                lda #7
0037FA  3  C5 rr                cmp varf
0037FC  3  F0 03                beq *+5
0037FE  3  4C 1F 38             jmp d00588
003801  3  A9 00                lda #0
003803  3  85 rr                sta varf
003805  3  A9 63                lda #99
003807  3  85 rr                sta varj
003809  3  A9 04                lda #4
00380B  3  85 rr                sta scno
00380D  3  20 AD 1F             jsr nwscr
003810  3  A5 rr                lda varr
003812  3  18                   clc
003813  3  69 01                adc #1
003815  3  85 rr                sta varr
003817  3  A9 01                lda #1
003819  3  85 rr                sta restfl
00381B  3  60                   rts
00381C  3  4C 2E 38             jmp d00617
00381F  3  A9 00        d00588: lda #0
003821  3  85 rr                sta varj
003823  3  A9 05                lda #5
003825  3  85 rr                sta scno
003827  3  20 AD 1F             jsr nwscr
00382A  3  A9 01                lda #1
00382C  3  85 rr                sta restfl
00382E  3  A5 rr        d00617: lda ogptr
003830  3  85 rr                sta z80_x
003832  3  A5 rr                lda ogptr+1
003834  3  85 rr                sta z80_i
003836  3  A9 C8                lda #200
003838  3                       ; ldy #8
003838  3  A0 08                ldy #8
00383A  3  91 rr                sta (z80_ix),y
00383C  3  A9 1E                lda #30
00383E  3                       ; ldy #12
00383E  3  A0 0C                ldy #12
003840  3  91 rr                sta (z80_ix),y
003842  3  A9 00        d00672: lda #0
003844  3                       ; ldy #12
003844  3  A0 0C                ldy #12
003846  3  D1 rr                cmp (z80_ix),y
003848  3  90 03                bcc *+5
00384A  3  4C F4 39             jmp d01616
00384D  3                       ; ldy #12
00384D  3  B1 rr                lda (z80_ix),y
00384F  3  38                   sec
003850  3  E9 01                sbc #1
003852  3                       ; ldy #12
003852  3  91 rr                sta (z80_ix),y
003854  3  A5 rr                lda varr
003856  3  85 rr                sta varo
003858  3  A9 00                lda #0
00385A  3  85 rr                sta varr
00385C  3  A9 1D                lda #29
00385E  3                       ; ldy #12
00385E  3  D1 rr                cmp (z80_ix),y
003860  3  F0 03                beq *+5
003862  3  4C 6D 38             jmp d00782
003865  3  A9 C4                lda #196
003867  3  85 rr                sta varr
003869  3  A9 03                lda #3
00386B  3  85 rr                sta varq
00386D  3  A9 1A        d00782: lda #26
00386F  3                       ; ldy #12
00386F  3  A0 0C                ldy #12
003871  3  D1 rr                cmp (z80_ix),y
003873  3  F0 03                beq *+5
003875  3  4C 80 38             jmp d00825
003878  3  A9 26                lda #38
00387A  3  85 rr                sta varr
00387C  3  A9 03                lda #3
00387E  3  85 rr                sta varq
003880  3  A9 17        d00825: lda #23
003882  3                       ; ldy #12
003882  3  A0 0C                ldy #12
003884  3  D1 rr                cmp (z80_ix),y
003886  3  F0 03                beq *+5
003888  3  4C 13 39             jmp d01131
00388B  3  A9 54                lda #84
00388D  3  85 rr                sta varr
00388F  3  A9 02                lda #2
003891  3  85 rr                sta varq
003893  3  A9 10                lda #16
003895  3  85 rr                sta chary
003897  3  A9 1D                lda #29
003899  3  85 rr                sta charx
00389B  3  A5 rr                lda charx
00389D  3  85 rr                sta dispx
00389F  3  A5 rr                lda chary
0038A1  3  85 rr                sta dispy
0038A3  3  A9 39                lda #57
0038A5  3  20 C9 16             jsr pattr
0038A8  3  A5 rr                lda charx
0038AA  3  85 rr                sta dispx
0038AC  3  A5 rr                lda chary
0038AE  3  85 rr                sta dispy
0038B0  3  A9 39                lda #57
0038B2  3  20 C9 16             jsr pattr
0038B5  3  A9 11                lda #17
0038B7  3  85 rr                sta chary
0038B9  3  A9 1D                lda #29
0038BB  3  85 rr                sta charx
0038BD  3  A5 rr                lda charx
0038BF  3  85 rr                sta dispx
0038C1  3  A5 rr                lda chary
0038C3  3  85 rr                sta dispy
0038C5  3  A9 30                lda #48
0038C7  3  20 C9 16             jsr pattr
0038CA  3  A5 rr                lda charx
0038CC  3  85 rr                sta dispx
0038CE  3  A5 rr                lda chary
0038D0  3  85 rr                sta dispy
0038D2  3  A9 58                lda #88
0038D4  3  20 C9 16             jsr pattr
0038D7  3  A5 rr                lda charx
0038D9  3  85 rr                sta dispx
0038DB  3  A5 rr                lda chary
0038DD  3  85 rr                sta dispy
0038DF  3  A9 39                lda #57
0038E1  3  20 C9 16             jsr pattr
0038E4  3  A9 12                lda #18
0038E6  3  85 rr                sta chary
0038E8  3  A9 1D                lda #29
0038EA  3  85 rr                sta charx
0038EC  3  A5 rr                lda charx
0038EE  3  85 rr                sta dispx
0038F0  3  A5 rr                lda chary
0038F2  3  85 rr                sta dispy
0038F4  3  A9 39                lda #57
0038F6  3  20 C9 16             jsr pattr
0038F9  3  A5 rr                lda charx
0038FB  3  85 rr                sta dispx
0038FD  3  A5 rr                lda chary
0038FF  3  85 rr                sta dispy
003901  3  A9 59                lda #89
003903  3  20 C9 16             jsr pattr
003906  3  A5 rr                lda charx
003908  3  85 rr                sta dispx
00390A  3  A5 rr                lda chary
00390C  3  85 rr                sta dispy
00390E  3  A9 39                lda #57
003910  3  20 C9 16             jsr pattr
003913  3  A9 14        d01131: lda #20
003915  3                       ; ldy #12
003915  3  A0 0C                ldy #12
003917  3  D1 rr                cmp (z80_ix),y
003919  3  F0 03                beq *+5
00391B  3  4C 26 39             jmp d01175
00391E  3  A9 01                lda #1
003920  3  85 rr                sta varq
003922  3  A9 D3                lda #211
003924  3  85 rr                sta varr
003926  3  A9 0E        d01175: lda #14
003928  3                       ; ldy #12
003928  3  A0 0C                ldy #12
00392A  3  D1 rr                cmp (z80_ix),y
00392C  3  F0 03                beq *+5
00392E  3  4C B9 39             jmp d01481
003931  3  A9 10                lda #16
003933  3  85 rr                sta chary
003935  3  A9 1D                lda #29
003937  3  85 rr                sta charx
003939  3  A5 rr                lda charx
00393B  3  85 rr                sta dispx
00393D  3  A5 rr                lda chary
00393F  3  85 rr                sta dispy
003941  3  A9 30                lda #48
003943  3  20 C9 16             jsr pattr
003946  3  A5 rr                lda charx
003948  3  85 rr                sta dispx
00394A  3  A5 rr                lda chary
00394C  3  85 rr                sta dispy
00394E  3  A9 31                lda #49
003950  3  20 C9 16             jsr pattr
003953  3  A9 11                lda #17
003955  3  85 rr                sta chary
003957  3  A9 1D                lda #29
003959  3  85 rr                sta charx
00395B  3  A5 rr                lda charx
00395D  3  85 rr                sta dispx
00395F  3  A5 rr                lda chary
003961  3  85 rr                sta dispy
003963  3  A9 35                lda #53
003965  3  20 C9 16             jsr pattr
003968  3  A5 rr                lda charx
00396A  3  85 rr                sta dispx
00396C  3  A5 rr                lda chary
00396E  3  85 rr                sta dispy
003970  3  A9 36                lda #54
003972  3  20 C9 16             jsr pattr
003975  3  A5 rr                lda charx
003977  3  85 rr                sta dispx
003979  3  A5 rr                lda chary
00397B  3  85 rr                sta dispy
00397D  3  A9 37                lda #55
00397F  3  20 C9 16             jsr pattr
003982  3  A9 12                lda #18
003984  3  85 rr                sta chary
003986  3  A9 1D                lda #29
003988  3  85 rr                sta charx
00398A  3  A5 rr                lda charx
00398C  3  85 rr                sta dispx
00398E  3  A5 rr                lda chary
003990  3  85 rr                sta dispy
003992  3  A9 3A                lda #58
003994  3  20 C9 16             jsr pattr
003997  3  A5 rr                lda charx
003999  3  85 rr                sta dispx
00399B  3  A5 rr                lda chary
00399D  3  85 rr                sta dispy
00399F  3  A9 3B                lda #59
0039A1  3  20 C9 16             jsr pattr
0039A4  3  A5 rr                lda charx
0039A6  3  85 rr                sta dispx
0039A8  3  A5 rr                lda chary
0039AA  3  85 rr                sta dispy
0039AC  3  A9 3C                lda #60
0039AE  3  20 C9 16             jsr pattr
0039B1  3  A9 02                lda #2
0039B3  3  85 rr                sta varq
0039B5  3  A9 54                lda #84
0039B7  3  85 rr                sta varr
0039B9  3  A9 05        d01481: lda #5
0039BB  3                       ; ldy #12
0039BB  3  A0 0C                ldy #12
0039BD  3  D1 rr                cmp (z80_ix),y
0039BF  3  90 03                bcc *+5
0039C1  3  4C D5 39             jmp d01547
0039C4  3                       ; ldy #12
0039C4  3  B1 rr                lda (z80_ix),y
0039C6  3  C9 0C                cmp #12
0039C8  3  90 03                bcc *+5
0039CA  3  4C D5 39             jmp d01547
0039CD  3  A9 01                lda #1
0039CF  3  85 rr                sta varq
0039D1  3  A9 D3                lda #211
0039D3  3  85 rr                sta varr
0039D5  3  A9 00        d01547: lda #0
0039D7  3  C5 rr                cmp varr
0039D9  3  90 03                bcc *+5
0039DB  3  4C DE 39             jmp d01564
0039DE  3  A5 rr        d01564: lda varo
0039E0  3  85 rr                sta varr
0039E2  3  A9 00                lda #0
0039E4  3                       ; ldy #12
0039E4  3  A0 0C                ldy #12
0039E6  3  D1 rr                cmp (z80_ix),y
0039E8  3  F0 03                beq *+5
0039EA  3  4C F4 39             jmp d01616
0039ED  3  A9 FF                lda #255
0039EF  3  A0 05                ldy #5
0039F1  3  91 rr                sta (z80_ix),y
0039F3  3  60                   rts
0039F4  3  A9 00        d01616: lda #0
0039F6  3                       ; ldy #8
0039F6  3  A0 08                ldy #8
0039F8  3  D1 rr                cmp (z80_ix),y
0039FA  3  F0 03                beq *+5
0039FC  3  4C 18 3A             jmp d01719
0039FF  3  A9 08                lda #8
003A01  3  85 rr                sta z80_c
003A03  3                       ; ldy #8
003A03  3  B1 rr                lda (z80_ix),y
003A05  3  18                   clc
003A06  3  65 rr                adc z80_c
003A08  3                       ; ldy #8
003A08  3  91 rr                sta (z80_ix),y
003A0A  3  A9 08                lda #8
003A0C  3  85 rr                sta z80_c
003A0E  3                       ; ldy #8
003A0E  3  B1 rr                lda (z80_ix),y
003A10  3  38                   sec
003A11  3  E5 rr                sbc z80_c
003A13  3                       ; ldy #8
003A13  3  91 rr                sta (z80_ix),y
003A15  3  4C 30 3A             jmp d01794
003A18  3  A9 08        d01719: lda #8
003A1A  3  85 rr                sta z80_c
003A1C  3                       ; ldy #8
003A1C  3  A0 08                ldy #8
003A1E  3  B1 rr                lda (z80_ix),y
003A20  3  38                   sec
003A21  3  E5 rr                sbc z80_c
003A23  3                       ; ldy #8
003A23  3  91 rr                sta (z80_ix),y
003A25  3  A9 08                lda #8
003A27  3  85 rr                sta z80_c
003A29  3                       ; ldy #8
003A29  3  B1 rr                lda (z80_ix),y
003A2B  3  18                   clc
003A2C  3  65 rr                adc z80_c
003A2E  3                       ; ldy #8
003A2E  3  91 rr                sta (z80_ix),y
003A30  3  A9 00        d01794: lda #0
003A32  3  C5 rr                cmp varc
003A34  3  F0 03                beq *+5
003A36  3  4C 3E 3A             jmp d01819
003A39  3  A9 00                lda #0
003A3B  3  20 59 1E             jsr animsp
003A3E  3  A9 00        d01819: lda #0
003A40  3                       ; ldy #12
003A40  3  A0 0C                ldy #12
003A42  3  D1 rr                cmp (z80_ix),y
003A44  3  F0 03                beq *+5
003A46  3  4C 67 3A             jmp d01907
003A49  3  A9 00                lda #0
003A4B  3  C5 rr                cmp varg
003A4D  3  F0 03                beq *+5
003A4F  3  4C 58 3A             jmp d01876
003A52  3  A9 FF                lda #255
003A54  3  A0 05                ldy #5
003A56  3  91 rr                sta (z80_ix),y
003A58  3  A9 03        d01876: lda #3
003A5A  3  C5 rr                cmp varg
003A5C  3  F0 03                beq *+5
003A5E  3  4C 67 3A             jmp d01907
003A61  3  A9 FF                lda #255
003A63  3  A0 05                ldy #5
003A65  3  91 rr                sta (z80_ix),y
003A67  3  60           d01907: rts
003A68  3               .out .sprintf("EVENT 3 SIZE = %d", (* - evnt03))
003A68  3               
003A68  3               evnt04:
003A68  3  A9 00                lda #0
003A6A  3  C5 rr                cmp varc
003A6C  3  F0 03                beq *+5
003A6E  3  4C 76 3A             jmp e00027
003A71  3  A9 00                lda #0
003A73  3  20 59 1E             jsr animsp
003A76  3  A9 02        e00027: lda #2
003A78  3  C5 rr                cmp varg
003A7A  3  F0 03                beq *+5
003A7C  3  4C 7F 3A             jmp e00044
003A7F  3  A9 01        e00044: lda #1
003A81  3                       ; ldy #10
003A81  3  A0 0A                ldy #10
003A83  3  D1 rr                cmp (z80_ix),y
003A85  3  90 03                bcc *+5
003A87  3  4C 90 3A             jmp e00088
003A8A  3  A9 0F                lda #15
003A8C  3                       ; ldy #6
003A8C  3  A0 06                ldy #6
003A8E  3  91 rr                sta (z80_ix),y
003A90  3               e00088: ; ldy #12
003A90  3  A0 0C                ldy #12
003A92  3  B1 rr                lda (z80_ix),y
003A94  3  18                   clc
003A95  3  69 01                adc #1
003A97  3                       ; ldy #12
003A97  3  91 rr                sta (z80_ix),y
003A99  3  A9 97                lda #151
003A9B  3  85 rr                sta varo
003A9D  3                       ; ldy #12
003A9D  3  B1 rr                lda (z80_ix),y
003A9F  3  85 rr                sta z80_c
003AA1  3  A5 rr                lda varo
003AA3  3  38                   sec
003AA4  3  E5 rr                sbc z80_c
003AA6  3  85 rr                sta varo
003AA8  3  A9 00                lda #0
003AAA  3  C5 rr                cmp varc
003AAC  3  F0 03                beq *+5
003AAE  3  4C C0 3A             jmp e00205
003AB1  3  A9 78                lda #120
003AB3  3  C5 rr                cmp varo
003AB5  3  90 03                bcc *+5
003AB7  3  4C C0 3A             jmp e00205
003ABA  3  A5 rr                lda varo
003ABC  3  0A                   asl a
003ABD  3  8D DD 0E             sta sndtyp
003AC0  3  A9 96        e00205: lda #150
003AC2  3                       ; ldy #12
003AC2  3  A0 0C                ldy #12
003AC4  3  D1 rr                cmp (z80_ix),y
003AC6  3  F0 03                beq *+5
003AC8  3  4C D6 3A             jmp e00268
003ACB  3  A5 rr                lda vara
003ACD  3                       ; ldy #8
003ACD  3  A0 08                ldy #8
003ACF  3  91 rr                sta (z80_ix),y
003AD1  3  A5 rr                lda varb
003AD3  3                       ; ldy #9
003AD3  3  C8                   iny
003AD4  3  91 rr                sta (z80_ix),y
003AD6  3  A9 00        e00268: lda #0
003AD8  3  C5 rr                cmp varc
003ADA  3  F0 03                beq *+5
003ADC  3  4C 35 3B             jmp e00531
003ADF  3  A9 00                lda #0
003AE1  3                       ; ldy #10
003AE1  3  A0 0A                ldy #10
003AE3  3  D1 rr                cmp (z80_ix),y
003AE5  3  F0 03                beq *+5
003AE7  3  4C F7 3A             jmp e00351
003AEA  3  A9 FF                lda #255
003AEC  3  85 rr                sta z80_c
003AEE  3                       ; ldy #8
003AEE  3  A0 08                ldy #8
003AF0  3  B1 rr                lda (z80_ix),y
003AF2  3  18                   clc
003AF3  3  65 rr                adc z80_c
003AF5  3                       ; ldy #8
003AF5  3  91 rr                sta (z80_ix),y
003AF7  3  A9 01        e00351: lda #1
003AF9  3                       ; ldy #10
003AF9  3  A0 0A                ldy #10
003AFB  3  D1 rr                cmp (z80_ix),y
003AFD  3  F0 03                beq *+5
003AFF  3  4C 0B 3B             jmp e00408
003B02  3                       ; ldy #8
003B02  3  A0 08                ldy #8
003B04  3  B1 rr                lda (z80_ix),y
003B06  3  18                   clc
003B07  3  69 01                adc #1
003B09  3                       ; ldy #8
003B09  3  91 rr                sta (z80_ix),y
003B0B  3  A9 02        e00408: lda #2
003B0D  3                       ; ldy #10
003B0D  3  A0 0A                ldy #10
003B0F  3  D1 rr                cmp (z80_ix),y
003B11  3  F0 03                beq *+5
003B13  3  4C 1E 3B             jmp e00465
003B16  3                       ; ldy #9
003B16  3  88                   dey
003B17  3  B1 rr                lda (z80_ix),y
003B19  3  18                   clc
003B1A  3  69 01                adc #1
003B1C  3                       ; ldy #9
003B1C  3  91 rr                sta (z80_ix),y
003B1E  3  A9 03        e00465: lda #3
003B20  3                       ; ldy #10
003B20  3  A0 0A                ldy #10
003B22  3  D1 rr                cmp (z80_ix),y
003B24  3  F0 03                beq *+5
003B26  3  4C 35 3B             jmp e00531
003B29  3  A9 FF                lda #255
003B2B  3  85 rr                sta z80_c
003B2D  3                       ; ldy #9
003B2D  3  88                   dey
003B2E  3  B1 rr                lda (z80_ix),y
003B30  3  18                   clc
003B31  3  65 rr                adc z80_c
003B33  3                       ; ldy #9
003B33  3  91 rr                sta (z80_ix),y
003B35  3  A5 rr        e00531: lda vara
003B37  3                       ; ldy #8
003B37  3  A0 08                ldy #8
003B39  3  D1 rr                cmp (z80_ix),y
003B3B  3  F0 03                beq *+5
003B3D  3  4C AF 3B             jmp e00813
003B40  3  A5 rr                lda varb
003B42  3                       ; ldy #9
003B42  3  C8                   iny
003B43  3  D1 rr                cmp (z80_ix),y
003B45  3  F0 03                beq *+5
003B47  3  4C AF 3B             jmp e00813
003B4A  3  A9 01                lda #1
003B4C  3  85 rr                sta varg
003B4E  3  A9 00                lda #0
003B50  3                       ; ldy #8
003B50  3  88                   dey
003B51  3  91 rr                sta (z80_ix),y
003B53  3  A9 00                lda #0
003B55  3                       ; ldy #9
003B55  3  C8                   iny
003B56  3  91 rr                sta (z80_ix),y
003B58  3  A9 02                lda #2
003B5A  3  85 rr                sta z80_d
003B5C  3  20 A4 1A             jsr random
003B5F  3  85 rr                sta z80_h
003B61  3  20 0D 13             jsr imul
003B64  3  A5 rr                lda z80_h
003B66  3  85 rr                sta varrnd
003B68  3  A9 01                lda #1
003B6A  3  C5 rr                cmp varrnd
003B6C  3  F0 03                beq *+5
003B6E  3  4C 76 3B             jmp e00691
003B71  3  A9 B0                lda #176
003B73  3                       ; ldy #8
003B73  3  88                   dey
003B74  3  91 rr                sta (z80_ix),y
003B76  3  A9 02        e00691: lda #2
003B78  3  85 rr                sta z80_d
003B7A  3  20 A4 1A             jsr random
003B7D  3  85 rr                sta z80_h
003B7F  3  20 0D 13             jsr imul
003B82  3  A5 rr                lda z80_h
003B84  3  85 rr                sta varrnd
003B86  3  A9 01                lda #1
003B88  3  C5 rr                cmp varrnd
003B8A  3  F0 03                beq *+5
003B8C  3  4C 95 3B             jmp e00757
003B8F  3  A9 C0                lda #192
003B91  3                       ; ldy #9
003B91  3  A0 09                ldy #9
003B93  3  91 rr                sta (z80_ix),y
003B95  3  A9 03        e00757: lda #3
003B97  3  85 rr                sta z80_c
003B99  3  A9 0D                lda #13
003B9B  3  85 rr                sta z80_b
003B9D  3  20 79 14             jsr spawn
003BA0  3  A5 rr                lda ogptr
003BA2  3  85 rr                sta z80_x
003BA4  3  A5 rr                lda ogptr+1
003BA6  3  85 rr                sta z80_i
003BA8  3  A9 FF                lda #255
003BAA  3  A0 05                ldy #5
003BAC  3  91 rr                sta (z80_ix),y
003BAE  3  60                   rts
003BAF  3  60           e00813: rts
003BB0  3               .out .sprintf("EVENT 4 SIZE = %d", (* - evnt04))
003BB0  3               
003BB0  3               evnt05:
003BB0  3  A9 05                lda #5
003BB2  3  C5 rr                cmp scno
003BB4  3  F0 03                beq *+5
003BB6  3  4C EC 3C             jmp f00687
003BB9  3  A5 rr                lda varo
003BBB  3  C9 FF                cmp #255
003BBD  3  90 03                bcc *+5
003BBF  3  4C 1B 3C             jmp f00217
003BC2  3  A9 02                lda #2
003BC4  3  85 rr                sta chary
003BC6  3  A9 08                lda #8
003BC8  3  85 rr                sta charx
003BCA  3  A9 07                lda #7
003BCC  3  85 rr                sta z80_c
003BCE  3  A5 rr                lda varf
003BD0  3  18                   clc
003BD1  3  65 rr                adc z80_c
003BD3  3  85 rr                sta varf
003BD5  3  A5 rr                lda varf
003BD7  3  20 ED 1A             jsr dmsg
003BDA  3  A9 02                lda #2
003BDC  3  85 rr                sta chary
003BDE  3  A9 0C                lda #12
003BE0  3  85 rr                sta charx
003BE2  3  A9 04                lda #4
003BE4  3  20 ED 1A             jsr dmsg
003BE7  3  A9 FF                lda #255
003BE9  3  85 rr                sta z80_c
003BEB  3  A5 rr                lda varf
003BED  3  18                   clc
003BEE  3  65 rr                adc z80_c
003BF0  3  85 rr                sta varf
003BF2  3  A9 15                lda #21
003BF4  3  85 rr                sta chary
003BF6  3  A9 08                lda #8
003BF8  3  85 rr                sta charx
003BFA  3  A5 rr                lda varf
003BFC  3  20 ED 1A             jsr dmsg
003BFF  3  A9 0C                lda #12
003C01  3  85 rr                sta charx
003C03  3  A9 15                lda #21
003C05  3  85 rr                sta chary
003C07  3  A9 04                lda #4
003C09  3  20 ED 1A             jsr dmsg
003C0C  3  A9 06                lda #6
003C0E  3  85 rr                sta z80_c
003C10  3  A5 rr                lda varf
003C12  3  38                   sec
003C13  3  E5 rr                sbc z80_c
003C15  3  85 rr                sta varf
003C17  3  A9 FF                lda #255
003C19  3  85 rr                sta varo
003C1B  3  A9 00        f00217: lda #0
003C1D  3  C5 rr                cmp varc
003C1F  3  F0 03                beq *+5
003C21  3  4C 36 3C             jmp f00283
003C24  3  A9 FF                lda #255
003C26  3  85 rr                sta z80_c
003C28  3                       ; ldy #8
003C28  3  A0 08                ldy #8
003C2A  3  B1 rr                lda (z80_ix),y
003C2C  3  18                   clc
003C2D  3  65 rr                adc z80_c
003C2F  3                       ; ldy #8
003C2F  3  91 rr                sta (z80_ix),y
003C31  3  A9 00                lda #0
003C33  3  20 59 1E             jsr animsp
003C36  3  A9 02        f00283: lda #2
003C38  3  C5 rr                cmp varc
003C3A  3  F0 03                beq *+5
003C3C  3  4C 51 3C             jmp f00348
003C3F  3  A9 FF                lda #255
003C41  3  85 rr                sta z80_c
003C43  3                       ; ldy #8
003C43  3  A0 08                ldy #8
003C45  3  B1 rr                lda (z80_ix),y
003C47  3  18                   clc
003C48  3  65 rr                adc z80_c
003C4A  3                       ; ldy #8
003C4A  3  91 rr                sta (z80_ix),y
003C4C  3  A9 00                lda #0
003C4E  3  20 59 1E             jsr animsp
003C51  3  A5 rr        f00348: lda joyval
003C53  3  29 10                and #16
003C55  3  F0 03                beq :+
003C57  3  4C 60 3C             jmp f00383
003C5A  3               :
003C5A  3  A9 20                lda #32
003C5C  3                       ; ldy #8
003C5C  3  A0 08                ldy #8
003C5E  3  91 rr                sta (z80_ix),y
003C60  3  A5 rr        f00383: lda joyval
003C62  3  29 20                and #32
003C64  3  F0 03                beq :+
003C66  3  4C 6F 3C             jmp f00419
003C69  3               :
003C69  3  A9 20                lda #32
003C6B  3                       ; ldy #8
003C6B  3  A0 08                ldy #8
003C6D  3  91 rr                sta (z80_ix),y
003C6F  3  A9 20        f00419: lda #32
003C71  3                       ; ldy #8
003C71  3  A0 08                ldy #8
003C73  3  D1 rr                cmp (z80_ix),y
003C75  3  F0 03                beq *+5
003C77  3  4C AB 3C             jmp f00543
003C7A  3  A9 00                lda #0
003C7C  3  C5 rr                cmp varl
003C7E  3  F0 03                beq *+5
003C80  3  4C 8D 3C             jmp f00482
003C83  3  A5 rr                lda varl
003C85  3  18                   clc
003C86  3  69 01                adc #1
003C88  3  85 rr                sta varl
003C8A  3  4C 91 3C             jmp f00490
003C8D  3  A9 00        f00482: lda #0
003C8F  3  85 rr                sta varl
003C91  3  A5 rr        f00490: lda varf
003C93  3  18                   clc
003C94  3  69 01                adc #1
003C96  3  85 rr                sta varf
003C98  3  A5 rr                lda varf
003C9A  3  85 rr                sta scno
003C9C  3  20 AD 1F             jsr nwscr
003C9F  3  A5 rr                lda scno
003CA1  3  4A                   lsr a
003CA2  3  85 rr                sta scno
003CA4  3  20 AD 1F             jsr nwscr
003CA7  3  A9 01                lda #1
003CA9  3  85 rr                sta restfl
003CAB  3  A9 09        f00543: lda #9
003CAD  3                       ; ldy #6
003CAD  3  A0 06                ldy #6
003CAF  3  D1 rr                cmp (z80_ix),y
003CB1  3  F0 03                beq *+5
003CB3  3  4C E1 3C             jmp f00661
003CB6  3  A9 03                lda #3
003CB8  3  C5 rr                cmp varf
003CBA  3  90 03                bcc *+5
003CBC  3  4C CA 3C             jmp f00613
003CBF  3  A9 60                lda #96
003CC1  3                       ; ldy #9
003CC1  3  A0 09                ldy #9
003CC3  3  D1 rr                cmp (z80_ix),y
003CC5  3  F0 03                beq *+5
003CC7  3  4C CA 3C             jmp f00613
003CCA  3  A9 06        f00613: lda #6
003CCC  3  C5 rr                cmp varf
003CCE  3  90 03                bcc *+5
003CD0  3  4C E1 3C             jmp f00661
003CD3  3  A9 60                lda #96
003CD5  3                       ; ldy #9
003CD5  3  A0 09                ldy #9
003CD7  3  D1 rr                cmp (z80_ix),y
003CD9  3  F0 03                beq *+5
003CDB  3  4C E1 3C             jmp f00661
003CDE  3  4C E1 3C             jmp f00661
003CE1  3  A9 00        f00661: lda #0
003CE3  3                       ; ldy #6
003CE3  3  A0 06                ldy #6
003CE5  3  D1 rr                cmp (z80_ix),y
003CE7  3  F0 03                beq *+5
003CE9  3  4C EC 3C             jmp f00687
003CEC  3  A9 06        f00687: lda #6
003CEE  3  C5 rr                cmp scno
003CF0  3  F0 03                beq *+5
003CF2  3  4C EE 3E             jmp f01789
003CF5  3  A5 rr                lda joyval
003CF7  3  29 10                and #16
003CF9  3  F0 03                beq :+
003CFB  3  4C 09 3D             jmp f00743
003CFE  3               :
003CFE  3  A9 04                lda #4
003D00  3  85 rr                sta scno
003D02  3  20 AD 1F             jsr nwscr
003D05  3  A9 01                lda #1
003D07  3  85 rr                sta restfl
003D09  3  A5 rr        f00743: lda joyval
003D0B  3  29 20                and #32
003D0D  3  F0 03                beq :+
003D0F  3  4C 1D 3D             jmp f00781
003D12  3               :
003D12  3  A9 04                lda #4
003D14  3  85 rr                sta scno
003D16  3  20 AD 1F             jsr nwscr
003D19  3  A9 01                lda #1
003D1B  3  85 rr                sta restfl
003D1D  3  A9 00        f00781: lda #0
003D1F  3                       ; ldy #10
003D1F  3  A0 0A                ldy #10
003D21  3  D1 rr                cmp (z80_ix),y
003D23  3  90 03                bcc *+5
003D25  3  4C 2F 3D             jmp f00835
003D28  3                       ; ldy #10
003D28  3  B1 rr                lda (z80_ix),y
003D2A  3  38                   sec
003D2B  3  E9 01                sbc #1
003D2D  3                       ; ldy #10
003D2D  3  91 rr                sta (z80_ix),y
003D2F  3  A5 rr        f00835: lda joyval
003D31  3  29 40                and #64
003D33  3  F0 03                beq :+
003D35  3  4C 68 3D             jmp f00965
003D38  3               :
003D38  3  A9 00                lda #0
003D3A  3                       ; ldy #10
003D3A  3  A0 0A                ldy #10
003D3C  3  D1 rr                cmp (z80_ix),y
003D3E  3  F0 03                beq *+5
003D40  3  4C 68 3D             jmp f00965
003D43  3  A9 63                lda #99
003D45  3                       ; ldy #12
003D45  3  A0 0C                ldy #12
003D47  3  D1 rr                cmp (z80_ix),y
003D49  3  F0 03                beq *+5
003D4B  3  4C 68 3D             jmp f00965
003D4E  3  A5 rr                lda varn
003D50  3  18                   clc
003D51  3  69 01                adc #1
003D53  3  85 rr                sta varn
003D55  3  A9 02                lda #2
003D57  3  C5 rr                cmp varn
003D59  3  90 03                bcc *+5
003D5B  3  4C 62 3D             jmp f00947
003D5E  3  A9 00                lda #0
003D60  3  85 rr                sta varn
003D62  3  A9 05        f00947: lda #5
003D64  3                       ; ldy #10
003D64  3  A0 0A                ldy #10
003D66  3  91 rr                sta (z80_ix),y
003D68  3  A9 0F        f00965: lda #15
003D6A  3  85 rr                sta chary
003D6C  3  A9 05                lda #5
003D6E  3  85 rr                sta charx
003D70  3  A9 1E                lda #30
003D72  3  20 ED 1A             jsr dmsg
003D75  3  A9 10                lda #16
003D77  3  85 rr                sta chary
003D79  3  A9 06                lda #6
003D7B  3  85 rr                sta charx
003D7D  3  A9 1F                lda #31
003D7F  3  20 ED 1A             jsr dmsg
003D82  3  A9 0F                lda #15
003D84  3  85 rr                sta chary
003D86  3  A9 0D                lda #13
003D88  3  85 rr                sta charx
003D8A  3  A9 1B                lda #27
003D8C  3  85 rr                sta z80_c
003D8E  3  A5 rr                lda varn
003D90  3  18                   clc
003D91  3  65 rr                adc z80_c
003D93  3  85 rr                sta varn
003D95  3  A5 rr                lda varn
003D97  3  20 ED 1A             jsr dmsg
003D9A  3  A9 1B                lda #27
003D9C  3  85 rr                sta z80_c
003D9E  3  A5 rr                lda varn
003DA0  3  38                   sec
003DA1  3  E5 rr                sbc z80_c
003DA3  3  85 rr                sta varn
003DA5  3  A9 0C                lda #12
003DA7  3  85 rr                sta chary
003DA9  3  A9 04                lda #4
003DAB  3  85 rr                sta charx
003DAD  3  A9 B4                lda #180
003DAF  3  C5 rr                cmp clock
003DB1  3  90 03                bcc *+5
003DB3  3  4C D1 3D             jmp f01177
003DB6  3  A9 12                lda #18
003DB8  3  85 rr                sta loopa
003DBA  3  A5 rr        f01132: lda charx
003DBC  3  85 rr                sta dispx
003DBE  3  A5 rr                lda chary
003DC0  3  85 rr                sta dispy
003DC2  3  A9 17                lda #23
003DC4  3  20 C9 16             jsr pattr
003DC7  3  C6 rr                dec loopa
003DC9  3  F0 03                beq :+
003DCB  3  4C BA 3D             jmp f01132
003DCE  3               :
003DCE  3  4C D6 3D             jmp f01185
003DD1  3  A9 15        f01177: lda #21
003DD3  3  20 ED 1A             jsr dmsg
003DD6  3  A5 rr        f01185: lda varo
003DD8  3  C9 FF                cmp #255
003DDA  3  90 03                bcc *+5
003DDC  3  4C 6E 3E             jmp f01484
003DDF  3  A9 FF                lda #255
003DE1  3  85 rr                sta varo
003DE3  3  A9 02                lda #2
003DE5  3  85 rr                sta chary
003DE7  3  A9 0A                lda #10
003DE9  3  85 rr                sta charx
003DEB  3  A9 0F                lda #15
003DED  3  20 ED 1A             jsr dmsg
003DF0  3  A9 03                lda #3
003DF2  3  85 rr                sta chary
003DF4  3  A9 07                lda #7
003DF6  3  85 rr                sta charx
003DF8  3  A9 10                lda #16
003DFA  3  20 ED 1A             jsr dmsg
003DFD  3  A9 08                lda #8
003DFF  3  85 rr                sta chary
003E01  3  A9 02                lda #2
003E03  3  85 rr                sta charx
003E05  3  A9 11                lda #17
003E07  3  20 ED 1A             jsr dmsg
003E0A  3  A9 09                lda #9
003E0C  3  85 rr                sta chary
003E0E  3  A9 04                lda #4
003E10  3  85 rr                sta charx
003E12  3  A9 12                lda #18
003E14  3  20 ED 1A             jsr dmsg
003E17  3  A9 15                lda #21
003E19  3  85 rr                sta chary
003E1B  3  A9 01                lda #1
003E1D  3  85 rr                sta charx
003E1F  3  A9 13                lda #19
003E21  3  20 ED 1A             jsr dmsg
003E24  3  A9 16                lda #22
003E26  3  85 rr                sta chary
003E28  3  A9 01                lda #1
003E2A  3  85 rr                sta charx
003E2C  3  A9 14                lda #20
003E2E  3  20 ED 1A             jsr dmsg
003E31  3  A9 17                lda #23
003E33  3  85 rr                sta chary
003E35  3  A9 02                lda #2
003E37  3  85 rr                sta charx
003E39  3  A9 1D                lda #29
003E3B  3  85 rr                sta varq
003E3D  3  A9 06                lda #6
003E3F  3  85 rr                sta loopa
003E41  3  A5 rr        f01393: lda charx
003E43  3  85 rr                sta dispx
003E45  3  A5 rr                lda chary
003E47  3  85 rr                sta dispy
003E49  3  A5 rr                lda varq
003E4B  3  20 C9 16             jsr pattr
003E4E  3  A5 rr                lda varq
003E50  3  18                   clc
003E51  3  69 01                adc #1
003E53  3  85 rr                sta varq
003E55  3  C6 rr                dec loopa
003E57  3  F0 03                beq :+
003E59  3  4C 41 3E             jmp f01393
003E5C  3               :
003E5C  3  A5 rr                lda charx
003E5E  3  85 rr                sta dispx
003E60  3  A5 rr                lda chary
003E62  3  85 rr                sta dispy
003E64  3  A9 17                lda #23
003E66  3  20 C9 16             jsr pattr
003E69  3  A9 16                lda #22
003E6B  3  20 ED 1A             jsr dmsg
003E6E  3  A9 10        f01484: lda #16
003E70  3                       ; ldy #6
003E70  3  A0 06                ldy #6
003E72  3  D1 rr                cmp (z80_ix),y
003E74  3  F0 03                beq *+5
003E76  3  4C 97 3E             jmp f01586
003E79  3  20 82 18             jsr cangl
003E7C  3  F0 03                beq :+
003E7E  3  4C 91 3E             jmp f01568
003E81  3               :
003E81  3  A9 FF                lda #255
003E83  3  85 rr                sta z80_c
003E85  3                       ; ldy #9
003E85  3  A0 09                ldy #9
003E87  3  B1 rr                lda (z80_ix),y
003E89  3  18                   clc
003E8A  3  65 rr                adc z80_c
003E8C  3                       ; ldy #9
003E8C  3  91 rr                sta (z80_ix),y
003E8E  3  4C 97 3E             jmp f01586
003E91  3  A9 11        f01568: lda #17
003E93  3                       ; ldy #6
003E93  3  A0 06                ldy #6
003E95  3  91 rr                sta (z80_ix),y
003E97  3  A9 11        f01586: lda #17
003E99  3                       ; ldy #6
003E99  3  A0 06                ldy #6
003E9B  3  D1 rr                cmp (z80_ix),y
003E9D  3  F0 03                beq *+5
003E9F  3  4C BC 3E             jmp f01679
003EA2  3  20 94 18             jsr cangr
003EA5  3  F0 03                beq :+
003EA7  3  4C B6 3E             jmp f01661
003EAA  3               :
003EAA  3                       ; ldy #9
003EAA  3  A0 09                ldy #9
003EAC  3  B1 rr                lda (z80_ix),y
003EAE  3  18                   clc
003EAF  3  69 01                adc #1
003EB1  3                       ; ldy #9
003EB1  3  91 rr                sta (z80_ix),y
003EB3  3  4C BC 3E             jmp f01679
003EB6  3  A9 10        f01661: lda #16
003EB8  3                       ; ldy #6
003EB8  3  A0 06                ldy #6
003EBA  3  91 rr                sta (z80_ix),y
003EBC  3  A9 00        f01679: lda #0
003EBE  3  C5 rr                cmp varc
003EC0  3  F0 03                beq *+5
003EC2  3  4C CA 3E             jmp f01704
003EC5  3  A9 00                lda #0
003EC7  3  20 59 1E             jsr animsp
003ECA  3  A9 05        f01704: lda #5
003ECC  3  85 rr                sta z80_b
003ECE  3  20 A4 1E             jsr sktyp
003ED1  3  B0 03                bcs :+
003ED3  3  4C EE 3E             jmp f01789
003ED6  3               :
003ED6  3  A9 10                lda #16
003ED8  3                       ; ldy #6
003ED8  3  A0 06                ldy #6
003EDA  3  D1 rr                cmp (z80_ix),y
003EDC  3  F0 03                beq *+5
003EDE  3  4C E8 3E             jmp f01771
003EE1  3  A9 11                lda #17
003EE3  3                       ; ldy #6
003EE3  3  91 rr                sta (z80_ix),y
003EE5  3  4C EE 3E             jmp f01789
003EE8  3  A9 10        f01771: lda #16
003EEA  3                       ; ldy #6
003EEA  3  A0 06                ldy #6
003EEC  3  91 rr                sta (z80_ix),y
003EEE  3  60           f01789: rts
003EEF  3               .out .sprintf("EVENT 5 SIZE = %d", (* - evnt05))
003EEF  3               
003EEF  3               evnt06:
003EEF  3  A9 00                lda #0
003EF1  3                       ; ldy #12
003EF1  3  A0 0C                ldy #12
003EF3  3  D1 rr                cmp (z80_ix),y
003EF5  3  90 03                bcc *+5
003EF7  3  4C 26 40             jmp g00745
003EFA  3  A9 FF                lda #255
003EFC  3  85 rr                sta z80_c
003EFE  3                       ; ldy #12
003EFE  3  B1 rr                lda (z80_ix),y
003F00  3  18                   clc
003F01  3  65 rr                adc z80_c
003F03  3                       ; ldy #12
003F03  3  91 rr                sta (z80_ix),y
003F05  3  A9 96                lda #150
003F07  3                       ; ldy #12
003F07  3  D1 rr                cmp (z80_ix),y
003F09  3  90 03                bcc *+5
003F0B  3  4C 51 3F             jmp g00268
003F0E  3  A9 00                lda #0
003F10  3  C5 rr                cmp varc
003F12  3  F0 03                beq *+5
003F14  3  4C 28 3F             jmp g00158
003F17  3                       ; ldy #6
003F17  3  A0 06                ldy #6
003F19  3  B1 rr                lda (z80_ix),y
003F1B  3  18                   clc
003F1C  3  69 01                adc #1
003F1E  3                       ; ldy #6
003F1E  3  91 rr                sta (z80_ix),y
003F20  3                       ; ldy #12
003F20  3  A0 0C                ldy #12
003F22  3  B1 rr                lda (z80_ix),y
003F24  3  0A                   asl a
003F25  3  8D DD 0E             sta sndtyp
003F28  3  A9 02        g00158: lda #2
003F2A  3  C5 rr                cmp varc
003F2C  3  F0 03                beq *+5
003F2E  3  4C 42 3F             jmp g00228
003F31  3                       ; ldy #6
003F31  3  A0 06                ldy #6
003F33  3  B1 rr                lda (z80_ix),y
003F35  3  18                   clc
003F36  3  69 01                adc #1
003F38  3                       ; ldy #6
003F38  3  91 rr                sta (z80_ix),y
003F3A  3                       ; ldy #12
003F3A  3  A0 0C                ldy #12
003F3C  3  B1 rr                lda (z80_ix),y
003F3E  3  0A                   asl a
003F3F  3  8D DD 0E             sta sndtyp
003F42  3  A9 04        g00228: lda #4
003F44  3                       ; ldy #6
003F44  3  A0 06                ldy #6
003F46  3  D1 rr                cmp (z80_ix),y
003F48  3  F0 03                beq *+5
003F4A  3  4C 51 3F             jmp g00268
003F4D  3  A9 00                lda #0
003F4F  3                       ; ldy #6
003F4F  3  91 rr                sta (z80_ix),y
003F51  3  A9 BE        g00268: lda #190
003F53  3                       ; ldy #12
003F53  3  A0 0C                ldy #12
003F55  3  D1 rr                cmp (z80_ix),y
003F57  3  F0 03                beq *+5
003F59  3  4C D9 3F             jmp g00545
003F5C  3  A9 08                lda #8
003F5E  3  85 rr                sta varm
003F60  3  A9 FF                lda #255
003F62  3  85 rr                sta z80_c
003F64  3  A5 rr                lda numlif
003F66  3  18                   clc
003F67  3  65 rr                adc z80_c
003F69  3  85 rr                sta numlif
003F6B  3  A9 02                lda #2
003F6D  3  85 rr                sta chary
003F6F  3  A9 1A                lda #26
003F71  3  85 rr                sta charx
003F73  3  A9 18                lda #24
003F75  3  20 ED 1A             jsr dmsg
003F78  3  A9 02                lda #2
003F7A  3  85 rr                sta chary
003F7C  3  A9 1D                lda #29
003F7E  3  85 rr                sta charx
003F80  3  A9 18                lda #24
003F82  3  20 ED 1A             jsr dmsg
003F85  3  A9 02                lda #2
003F87  3  85 rr                sta chary
003F89  3  A9 1B                lda #27
003F8B  3  85 rr                sta charx
003F8D  3  A9 00                lda #0
003F8F  3  C5 rr                cmp numlif
003F91  3  90 03                bcc *+5
003F93  3  4C AE 3F             jmp g00462
003F96  3  A5 rr                lda numlif
003F98  3  85 rr                sta loopa
003F9A  3  A5 rr        g00422: lda charx
003F9C  3  85 rr                sta dispx
003F9E  3  A5 rr                lda chary
003FA0  3  85 rr                sta dispy
003FA2  3  A9 57                lda #87
003FA4  3  20 C9 16             jsr pattr
003FA7  3  C6 rr                dec loopa
003FA9  3  F0 03                beq :+
003FAB  3  4C 9A 3F             jmp g00422
003FAE  3               :
003FAE  3  A9 00        g00462: lda #0
003FB0  3  C5 rr                cmp numlif
003FB2  3  F0 03                beq *+5
003FB4  3  4C D9 3F             jmp g00545
003FB7  3  A9 02                lda #2
003FB9  3  85 rr                sta varg
003FBB  3  A9 0C                lda #12
003FBD  3  85 rr                sta varm
003FBF  3  A9 06                lda #6
003FC1  3  85 rr                sta chary
003FC3  3  A9 0B                lda #11
003FC5  3  85 rr                sta charx
003FC7  3  A9 00                lda #0
003FC9  3  20 ED 1A             jsr dmsg
003FCC  3  A9 11                lda #17
003FCE  3  85 rr                sta chary
003FD0  3  A9 0B                lda #11
003FD2  3  85 rr                sta charx
003FD4  3  A9 01                lda #1
003FD6  3  20 ED 1A             jsr dmsg
003FD9  3  A9 0A        g00545: lda #10
003FDB  3                       ; ldy #12
003FDB  3  A0 0C                ldy #12
003FDD  3  D1 rr                cmp (z80_ix),y
003FDF  3  F0 03                beq *+5
003FE1  3  4C F1 3F             jmp g00598
003FE4  3  A9 00                lda #0
003FE6  3  C5 rr                cmp numlif
003FE8  3  F0 03                beq *+5
003FEA  3  4C F1 3F             jmp g00598
003FED  3  A9 01                lda #1
003FEF  3  85 rr                sta gamwon
003FF1  3               g00598: ; ldy #12
003FF1  3  A0 0C                ldy #12
003FF3  3  B1 rr                lda (z80_ix),y
003FF5  3  C9 96                cmp #150
003FF7  3  90 03                bcc *+5
003FF9  3  4C 0B 40             jmp g00666
003FFC  3  A9 50                lda #80
003FFE  3                       ; ldy #12
003FFE  3  D1 rr                cmp (z80_ix),y
004000  3  90 03                bcc *+5
004002  3  4C 0B 40             jmp g00666
004005  3  A9 13                lda #19
004007  3                       ; ldy #6
004007  3  A0 06                ldy #6
004009  3  91 rr                sta (z80_ix),y
00400B  3               g00666: ; ldy #12
00400B  3  A0 0C                ldy #12
00400D  3  B1 rr                lda (z80_ix),y
00400F  3  C9 28                cmp #40
004011  3  90 03                bcc *+5
004013  3  4C 26 40             jmp g00745
004016  3  A9 01                lda #1
004018  3                       ; ldy #7
004018  3  A0 07                ldy #7
00401A  3  91 rr                sta (z80_ix),y
00401C  3  A9 B0                lda #176
00401E  3                       ; ldy #8
00401E  3  C8                   iny
00401F  3  91 rr                sta (z80_ix),y
004021  3  A9 00                lda #0
004023  3                       ; ldy #9
004023  3  C8                   iny
004024  3  91 rr                sta (z80_ix),y
004026  3  A9 00        g00745: lda #0
004028  3                       ; ldy #12
004028  3  A0 0C                ldy #12
00402A  3  D1 rr                cmp (z80_ix),y
00402C  3  F0 03                beq *+5
00402E  3  4C 38 41             jmp g01428
004031  3  A9 00                lda #0
004033  3                       ; ldy #11
004033  3  88                   dey
004034  3  91 rr                sta (z80_ix),y
004036  3  A9 01                lda #1
004038  3  85 rr                sta z80_b
00403A  3  20 A4 1E             jsr sktyp
00403D  3  B0 03                bcs :+
00403F  3  4C 46 40             jmp g00824
004042  3               :
004042  3  A9 01                lda #1
004044  3                       ; ldy #11
004044  3  91 rr                sta (z80_ix),y
004046  3  A9 08        g00824: lda #8
004048  3  85 rr                sta z80_b
00404A  3  20 A4 1E             jsr sktyp
00404D  3  B0 03                bcs :+
00404F  3  4C 58 40             jmp g00864
004052  3               :
004052  3  A9 01                lda #1
004054  3                       ; ldy #11
004054  3  A0 0B                ldy #11
004056  3  91 rr                sta (z80_ix),y
004058  3  A9 10        g00864: lda #16
00405A  3  85 rr                sta z80_c
00405C  3                       ; ldy #9
00405C  3  A0 09                ldy #9
00405E  3  B1 rr                lda (z80_ix),y
004060  3  18                   clc
004061  3  65 rr                adc z80_c
004063  3                       ; ldy #9
004063  3  91 rr                sta (z80_ix),y
004065  3  A9 01                lda #1
004067  3  85 rr                sta z80_b
004069  3  20 A4 1E             jsr sktyp
00406C  3  B0 03                bcs :+
00406E  3  4C 77 40             jmp g00943
004071  3               :
004071  3  A9 01                lda #1
004073  3                       ; ldy #11
004073  3  A0 0B                ldy #11
004075  3  91 rr                sta (z80_ix),y
004077  3  A9 08        g00943: lda #8
004079  3  85 rr                sta z80_c
00407B  3                       ; ldy #9
00407B  3  A0 09                ldy #9
00407D  3  B1 rr                lda (z80_ix),y
00407F  3  18                   clc
004080  3  65 rr                adc z80_c
004082  3                       ; ldy #9
004082  3  91 rr                sta (z80_ix),y
004084  3  A9 01                lda #1
004086  3  85 rr                sta z80_b
004088  3  20 A4 1E             jsr sktyp
00408B  3  B0 03                bcs :+
00408D  3  4C 96 40             jmp g01023
004090  3               :
004090  3  A9 01                lda #1
004092  3                       ; ldy #11
004092  3  A0 0B                ldy #11
004094  3  91 rr                sta (z80_ix),y
004096  3  A9 18        g01023: lda #24
004098  3  85 rr                sta z80_c
00409A  3                       ; ldy #9
00409A  3  A0 09                ldy #9
00409C  3  B1 rr                lda (z80_ix),y
00409E  3  38                   sec
00409F  3  E5 rr                sbc z80_c
0040A1  3                       ; ldy #9
0040A1  3  91 rr                sta (z80_ix),y
0040A3  3  A9 10                lda #16
0040A5  3  85 rr                sta z80_c
0040A7  3                       ; ldy #8
0040A7  3  88                   dey
0040A8  3  B1 rr                lda (z80_ix),y
0040AA  3  38                   sec
0040AB  3  E5 rr                sbc z80_c
0040AD  3                       ; ldy #8
0040AD  3  91 rr                sta (z80_ix),y
0040AF  3  A9 01                lda #1
0040B1  3  85 rr                sta z80_b
0040B3  3  20 A4 1E             jsr sktyp
0040B6  3  B0 03                bcs :+
0040B8  3  4C C1 40             jmp g01141
0040BB  3               :
0040BB  3  A9 01                lda #1
0040BD  3                       ; ldy #11
0040BD  3  A0 0B                ldy #11
0040BF  3  91 rr                sta (z80_ix),y
0040C1  3  A9 08        g01141: lda #8
0040C3  3  85 rr                sta z80_c
0040C5  3                       ; ldy #8
0040C5  3  A0 08                ldy #8
0040C7  3  B1 rr                lda (z80_ix),y
0040C9  3  38                   sec
0040CA  3  E5 rr                sbc z80_c
0040CC  3                       ; ldy #8
0040CC  3  91 rr                sta (z80_ix),y
0040CE  3  A9 01                lda #1
0040D0  3  85 rr                sta z80_b
0040D2  3  20 A4 1E             jsr sktyp
0040D5  3  B0 03                bcs :+
0040D7  3  4C E0 40             jmp g01220
0040DA  3               :
0040DA  3  A9 01                lda #1
0040DC  3                       ; ldy #11
0040DC  3  A0 0B                ldy #11
0040DE  3  91 rr                sta (z80_ix),y
0040E0  3  A9 18        g01220: lda #24
0040E2  3  85 rr                sta z80_c
0040E4  3                       ; ldy #8
0040E4  3  A0 08                ldy #8
0040E6  3  B1 rr                lda (z80_ix),y
0040E8  3  18                   clc
0040E9  3  65 rr                adc z80_c
0040EB  3                       ; ldy #8
0040EB  3  91 rr                sta (z80_ix),y
0040ED  3  A5 rr                lda joyval
0040EF  3  29 10                and #16
0040F1  3  F0 03                beq :+
0040F3  3  4C FC 40             jmp g01296
0040F6  3               :
0040F6  3  A9 00                lda #0
0040F8  3                       ; ldy #11
0040F8  3  A0 0B                ldy #11
0040FA  3  91 rr                sta (z80_ix),y
0040FC  3  A5 rr        g01296: lda joyval
0040FE  3  29 20                and #32
004100  3  F0 03                beq :+
004102  3  4C 0B 41             jmp g01332
004105  3               :
004105  3  A9 00                lda #0
004107  3                       ; ldy #11
004107  3  A0 0B                ldy #11
004109  3  91 rr                sta (z80_ix),y
00410B  3  A9 00        g01332: lda #0
00410D  3                       ; ldy #11
00410D  3  A0 0B                ldy #11
00410F  3  D1 rr                cmp (z80_ix),y
004111  3  F0 03                beq *+5
004113  3  4C 38 41             jmp g01428
004116  3  A9 04                lda #4
004118  3  85 rr                sta varg
00411A  3  A5 rr                lda scno
00411C  3  18                   clc
00411D  3  69 01                adc #1
00411F  3  85 rr                sta scno
004121  3  20 AD 1F             jsr nwscr
004124  3  A5 rr                lda scno
004126  3  85 rr                sta varm
004128  3  A5 rr                lda scno
00412A  3  38                   sec
00412B  3  E9 01                sbc #1
00412D  3  85 rr                sta scno
00412F  3  20 AD 1F             jsr nwscr
004132  3  A9 FF                lda #255
004134  3  A0 05                ldy #5
004136  3  91 rr                sta (z80_ix),y
004138  3  60           g01428: rts
004139  3               .out .sprintf("EVENT 6 SIZE = %d", (* - evnt06))
004139  3               
004139  3               evnt07:
004139  3  A9 00                lda #0
00413B  3  C5 rr                cmp varj
00413D  3  90 03                bcc *+5
00413F  3  4C 4B 41             jmp h00050
004142  3                       ; ldy #11
004142  3  A0 0B                ldy #11
004144  3  B1 rr                lda (z80_ix),y
004146  3  18                   clc
004147  3  69 01                adc #1
004149  3                       ; ldy #11
004149  3  91 rr                sta (z80_ix),y
00414B  3  A9 5F        h00050: lda #95
00414D  3  C5 rr                cmp varj
00414F  3  F0 03                beq *+5
004151  3  4C 67 41             jmp h00109
004154  3  A9 A0                lda #160
004156  3                       ; ldy #8
004156  3  A0 08                ldy #8
004158  3  91 rr                sta (z80_ix),y
00415A  3  A9 00                lda #0
00415C  3  85 rr                sta chary
00415E  3  A9 07                lda #7
004160  3  85 rr                sta charx
004162  3  A9 19                lda #25
004164  3  20 ED 1A             jsr dmsg
004167  3  A9 63        h00109: lda #99
004169  3  C5 rr                cmp varj
00416B  3  F0 03                beq *+5
00416D  3  4C 89 41             jmp h00194
004170  3  A9 AA                lda #170
004172  3                       ; ldy #11
004172  3  A0 0B                ldy #11
004174  3  91 rr                sta (z80_ix),y
004176  3  A9 80                lda #128
004178  3                       ; ldy #9
004178  3  A0 09                ldy #9
00417A  3  D1 rr                cmp (z80_ix),y
00417C  3  F0 03                beq *+5
00417E  3  4C 85 41             jmp h00186
004181  3  A9 68                lda #104
004183  3                       ; ldy #9
004183  3  91 rr                sta (z80_ix),y
004185  3  A9 0B        h00186: lda #11
004187  3  85 rr                sta varm
004189  3  A9 5D        h00194: lda #93
00418B  3  C5 rr                cmp varj
00418D  3  F0 03                beq *+5
00418F  3  4C 9F 41             jmp h00236
004192  3  A9 00                lda #0
004194  3  85 rr                sta chary
004196  3  A9 00                lda #0
004198  3  85 rr                sta charx
00419A  3  A9 1A                lda #26
00419C  3  20 ED 1A             jsr dmsg
00419F  3  A9 C0        h00236: lda #192
0041A1  3                       ; ldy #9
0041A1  3  A0 09                ldy #9
0041A3  3  D1 rr                cmp (z80_ix),y
0041A5  3  90 03                bcc *+5
0041A7  3  4C AF 41             jmp h00280
0041AA  3  A9 C8                lda #200
0041AC  3                       ; ldy #8
0041AC  3  88                   dey
0041AD  3  91 rr                sta (z80_ix),y
0041AF  3  A9 5F        h00280: lda #95
0041B1  3  C5 rr                cmp varj
0041B3  3  90 03                bcc *+5
0041B5  3  4C C8 41             jmp h00335
0041B8  3  A9 A0                lda #160
0041BA  3                       ; ldy #8
0041BA  3  A0 08                ldy #8
0041BC  3  91 rr                sta (z80_ix),y
0041BE  3  A5 rr                lda varj
0041C0  3  38                   sec
0041C1  3  E9 01                sbc #1
0041C3  3  85 rr                sta varj
0041C5  3  4C F5 43             jmp h01730
0041C8  3  A9 00        h00335: lda #0
0041CA  3                       ; ldy #11
0041CA  3  A0 0B                ldy #11
0041CC  3  D1 rr                cmp (z80_ix),y
0041CE  3  F0 03                beq *+5
0041D0  3  4C DA 41             jmp h00377
0041D3  3  A5 rr                lda varj
0041D5  3  38                   sec
0041D6  3  E9 01                sbc #1
0041D8  3  85 rr                sta varj
0041DA  3               h00377: ; ldy #6
0041DA  3  A0 06                ldy #6
0041DC  3  B1 rr                lda (z80_ix),y
0041DE  3  C9 12                cmp #18
0041E0  3  90 03                bcc *+5
0041E2  3  4C 3C 42             jmp h00637
0041E5  3  A9 64                lda #100
0041E7  3                       ; ldy #8
0041E7  3  A0 08                ldy #8
0041E9  3  D1 rr                cmp (z80_ix),y
0041EB  3  90 03                bcc *+5
0041ED  3  4C 1D 42             jmp h00557
0041F0  3  A9 5E                lda #94
0041F2  3  C5 rr                cmp varj
0041F4  3  90 03                bcc *+5
0041F6  3  4C 0E 42             jmp h00509
0041F9  3  A9 FF                lda #255
0041FB  3  85 rr                sta z80_c
0041FD  3                       ; ldy #9
0041FD  3  C8                   iny
0041FE  3  B1 rr                lda (z80_ix),y
004200  3  18                   clc
004201  3  65 rr                adc z80_c
004203  3                       ; ldy #9
004203  3  91 rr                sta (z80_ix),y
004205  3  A9 10                lda #16
004207  3                       ; ldy #6
004207  3  A0 06                ldy #6
004209  3  91 rr                sta (z80_ix),y
00420B  3  4C 1D 42             jmp h00557
00420E  3  A9 11        h00509: lda #17
004210  3                       ; ldy #6
004210  3  A0 06                ldy #6
004212  3  91 rr                sta (z80_ix),y
004214  3                       ; ldy #9
004214  3  A0 09                ldy #9
004216  3  B1 rr                lda (z80_ix),y
004218  3  18                   clc
004219  3  69 01                adc #1
00421B  3                       ; ldy #9
00421B  3  91 rr                sta (z80_ix),y
00421D  3  A9 4B        h00557: lda #75
00421F  3                       ; ldy #9
00421F  3  A0 09                ldy #9
004221  3  D1 rr                cmp (z80_ix),y
004223  3  90 03                bcc *+5
004225  3  4C 3C 42             jmp h00637
004228  3  A9 00                lda #0
00422A  3  C5 rr                cmp varc
00422C  3  F0 03                beq *+5
00422E  3  4C 3C 42             jmp h00637
004231  3  A9 FF                lda #255
004233  3  85 rr                sta z80_c
004235  3                       ; ldy #9
004235  3  B1 rr                lda (z80_ix),y
004237  3  18                   clc
004238  3  65 rr                adc z80_c
00423A  3                       ; ldy #9
00423A  3  91 rr                sta (z80_ix),y
00423C  3  A9 00        h00637: lda #0
00423E  3  C5 rr                cmp varc
004240  3  F0 03                beq *+5
004242  3  4C 55 42             jmp h00688
004245  3                       ; ldy #6
004245  3  A0 06                ldy #6
004247  3  B1 rr                lda (z80_ix),y
004249  3  C9 12                cmp #18
00424B  3  90 03                bcc *+5
00424D  3  4C 55 42             jmp h00688
004250  3  A9 00                lda #0
004252  3  20 59 1E             jsr animsp
004255  3  A9 07        h00688: lda #7
004257  3  85 rr                sta z80_b
004259  3  20 A4 1E             jsr sktyp
00425C  3  B0 03                bcs :+
00425E  3  4C 75 42             jmp h00767
004261  3               :
004261  3                       ; ldy #6
004261  3  A0 06                ldy #6
004263  3  B1 rr                lda (z80_ix),y
004265  3  C9 12                cmp #18
004267  3  90 03                bcc *+5
004269  3  4C 75 42             jmp h00767
00426C  3                       ; ldy #9
00426C  3  A0 09                ldy #9
00426E  3  B1 rr                lda (z80_ix),y
004270  3  18                   clc
004271  3  69 01                adc #1
004273  3                       ; ldy #9
004273  3  91 rr                sta (z80_ix),y
004275  3  A9 10        h00767: lda #16
004277  3                       ; ldy #6
004277  3  A0 06                ldy #6
004279  3  D1 rr                cmp (z80_ix),y
00427B  3  F0 03                beq *+5
00427D  3  4C 9A 42             jmp h00855
004280  3  A9 00                lda #0
004282  3  C5 rr                cmp varj
004284  3  90 03                bcc *+5
004286  3  4C 9A 42             jmp h00855
004289  3  A9 58                lda #88
00428B  3                       ; ldy #9
00428B  3  A0 09                ldy #9
00428D  3  D1 rr                cmp (z80_ix),y
00428F  3  90 03                bcc *+5
004291  3  4C 9A 42             jmp h00855
004294  3  A9 11                lda #17
004296  3                       ; ldy #6
004296  3  A0 06                ldy #6
004298  3  91 rr                sta (z80_ix),y
00429A  3  A9 12        h00855: lda #18
00429C  3                       ; ldy #6
00429C  3  A0 06                ldy #6
00429E  3  D1 rr                cmp (z80_ix),y
0042A0  3  F0 03                beq *+5
0042A2  3  4C BD 43             jmp h01621
0042A5  3  A9 50                lda #80
0042A7  3  C5 rr                cmp varj
0042A9  3  90 03                bcc *+5
0042AB  3  4C C0 42             jmp h00946
0042AE  3  A5 rr                lda varj
0042B0  3  C9 5C                cmp #92
0042B2  3  90 03                bcc *+5
0042B4  3  4C C0 42             jmp h00946
0042B7  3                       ; ldy #9
0042B7  3  A0 09                ldy #9
0042B9  3  B1 rr                lda (z80_ix),y
0042BB  3  18                   clc
0042BC  3  69 01                adc #1
0042BE  3                       ; ldy #9
0042BE  3  91 rr                sta (z80_ix),y
0042C0  3               h00946: ; ldy #9
0042C0  3  A0 09                ldy #9
0042C2  3  B1 rr                lda (z80_ix),y
0042C4  3  C9 1E                cmp #30
0042C6  3  90 03                bcc *+5
0042C8  3  4C 0A 43             jmp h01149
0042CB  3  A9 00                lda #0
0042CD  3                       ; ldy #12
0042CD  3  A0 0C                ldy #12
0042CF  3  91 rr                sta (z80_ix),y
0042D1  3  A9 00                lda #0
0042D3  3  C5 rr                cmp varc
0042D5  3  F0 03                beq *+5
0042D7  3  4C 0A 43             jmp h01149
0042DA  3                       ; ldy #7
0042DA  3  A0 07                ldy #7
0042DC  3  B1 rr                lda (z80_ix),y
0042DE  3  18                   clc
0042DF  3  69 01                adc #1
0042E1  3                       ; ldy #7
0042E1  3  91 rr                sta (z80_ix),y
0042E3  3                       ; ldy #9
0042E3  3  A0 09                ldy #9
0042E5  3  B1 rr                lda (z80_ix),y
0042E7  3  18                   clc
0042E8  3  69 01                adc #1
0042EA  3                       ; ldy #9
0042EA  3  91 rr                sta (z80_ix),y
0042EC  3  A9 1E                lda #30
0042EE  3                       ; ldy #9
0042EE  3  D1 rr                cmp (z80_ix),y
0042F0  3  F0 03                beq *+5
0042F2  3  4C FB 42             jmp h01109
0042F5  3  A9 50                lda #80
0042F7  3                       ; ldy #12
0042F7  3  A0 0C                ldy #12
0042F9  3  91 rr                sta (z80_ix),y
0042FB  3  A9 03        h01109: lda #3
0042FD  3                       ; ldy #7
0042FD  3  A0 07                ldy #7
0042FF  3  D1 rr                cmp (z80_ix),y
004301  3  F0 03                beq *+5
004303  3  4C 0A 43             jmp h01149
004306  3  A9 00                lda #0
004308  3                       ; ldy #7
004308  3  91 rr                sta (z80_ix),y
00430A  3  A9 01        h01149: lda #1
00430C  3                       ; ldy #12
00430C  3  A0 0C                ldy #12
00430E  3  D1 rr                cmp (z80_ix),y
004310  3  90 03                bcc *+5
004312  3  4C 3D 43             jmp h01290
004315  3                       ; ldy #12
004315  3  B1 rr                lda (z80_ix),y
004317  3  38                   sec
004318  3  E9 01                sbc #1
00431A  3                       ; ldy #12
00431A  3  91 rr                sta (z80_ix),y
00431C  3  A9 00                lda #0
00431E  3  C5 rr                cmp varc
004320  3  F0 03                beq *+5
004322  3  4C 2E 43             jmp h01250
004325  3                       ; ldy #7
004325  3  A0 07                ldy #7
004327  3  B1 rr                lda (z80_ix),y
004329  3  18                   clc
00432A  3  69 01                adc #1
00432C  3                       ; ldy #7
00432C  3  91 rr                sta (z80_ix),y
00432E  3  A9 05        h01250: lda #5
004330  3                       ; ldy #7
004330  3  A0 07                ldy #7
004332  3  D1 rr                cmp (z80_ix),y
004334  3  F0 03                beq *+5
004336  3  4C 3D 43             jmp h01290
004339  3  A9 03                lda #3
00433B  3                       ; ldy #7
00433B  3  91 rr                sta (z80_ix),y
00433D  3  A9 1F        h01290: lda #31
00433F  3                       ; ldy #9
00433F  3  A0 09                ldy #9
004341  3  D1 rr                cmp (z80_ix),y
004343  3  F0 03                beq *+5
004345  3  4C 4E 43             jmp h01334
004348  3  A9 00                lda #0
00434A  3                       ; ldy #7
00434A  3  A0 07                ldy #7
00434C  3  91 rr                sta (z80_ix),y
00434E  3  A9 01        h01334: lda #1
004350  3                       ; ldy #12
004350  3  A0 0C                ldy #12
004352  3  D1 rr                cmp (z80_ix),y
004354  3  F0 03                beq *+5
004356  3  4C BD 43             jmp h01621
004359  3  A9 00                lda #0
00435B  3  C5 rr                cmp varc
00435D  3  F0 03                beq *+5
00435F  3  4C 74 43             jmp h01439
004362  3                       ; ldy #9
004362  3  A0 09                ldy #9
004364  3  B1 rr                lda (z80_ix),y
004366  3  18                   clc
004367  3  69 01                adc #1
004369  3                       ; ldy #9
004369  3  91 rr                sta (z80_ix),y
00436B  3                       ; ldy #7
00436B  3  A0 07                ldy #7
00436D  3  B1 rr                lda (z80_ix),y
00436F  3  18                   clc
004370  3  69 01                adc #1
004372  3                       ; ldy #7
004372  3  91 rr                sta (z80_ix),y
004374  3  A9 02        h01439: lda #2
004376  3  C5 rr                cmp varc
004378  3  F0 03                beq *+5
00437A  3  4C 8F 43             jmp h01516
00437D  3                       ; ldy #9
00437D  3  A0 09                ldy #9
00437F  3  B1 rr                lda (z80_ix),y
004381  3  18                   clc
004382  3  69 01                adc #1
004384  3                       ; ldy #9
004384  3  91 rr                sta (z80_ix),y
004386  3                       ; ldy #7
004386  3  A0 07                ldy #7
004388  3  B1 rr                lda (z80_ix),y
00438A  3  18                   clc
00438B  3  69 01                adc #1
00438D  3                       ; ldy #7
00438D  3  91 rr                sta (z80_ix),y
00438F  3  A9 02        h01516: lda #2
004391  3                       ; ldy #7
004391  3  A0 07                ldy #7
004393  3  D1 rr                cmp (z80_ix),y
004395  3  90 03                bcc *+5
004397  3  4C 9E 43             jmp h01556
00439A  3  A9 00                lda #0
00439C  3                       ; ldy #7
00439C  3  91 rr                sta (z80_ix),y
00439E  3  A9 50        h01556: lda #80
0043A0  3                       ; ldy #9
0043A0  3  A0 09                ldy #9
0043A2  3  D1 rr                cmp (z80_ix),y
0043A4  3  F0 03                beq *+5
0043A6  3  4C BD 43             jmp h01621
0043A9  3  A9 00                lda #0
0043AB  3  C5 rr                cmp varj
0043AD  3  F0 03                beq *+5
0043AF  3  4C BD 43             jmp h01621
0043B2  3  A9 00                lda #0
0043B4  3  85 rr                sta scno
0043B6  3  20 AD 1F             jsr nwscr
0043B9  3  A9 01                lda #1
0043BB  3  85 rr                sta restfl
0043BD  3  A5 rr        h01621: lda joyval
0043BF  3  29 10                and #16
0043C1  3  F0 03                beq :+
0043C3  3  4C D9 43             jmp h01675
0043C6  3               :
0043C6  3  A9 00                lda #0
0043C8  3  85 rr                sta varj
0043CA  3  A9 00                lda #0
0043CC  3  85 rr                sta varl
0043CE  3  A9 00                lda #0
0043D0  3  85 rr                sta scno
0043D2  3  20 AD 1F             jsr nwscr
0043D5  3  A9 01                lda #1
0043D7  3  85 rr                sta restfl
0043D9  3  A5 rr        h01675: lda joyval
0043DB  3  29 20                and #32
0043DD  3  F0 03                beq :+
0043DF  3  4C F5 43             jmp h01730
0043E2  3               :
0043E2  3  A9 00                lda #0
0043E4  3  85 rr                sta varj
0043E6  3  A9 00                lda #0
0043E8  3  85 rr                sta varl
0043EA  3  A9 00                lda #0
0043EC  3  85 rr                sta scno
0043EE  3  20 AD 1F             jsr nwscr
0043F1  3  A9 01                lda #1
0043F3  3  85 rr                sta restfl
0043F5  3  A9 5A        h01730: lda #90
0043F7  3  C5 rr                cmp varj
0043F9  3  F0 03                beq *+5
0043FB  3  4C 11 44             jmp h01784
0043FE  3  A9 00                lda #0
004400  3  85 rr                sta varj
004402  3  A9 00                lda #0
004404  3  85 rr                sta varl
004406  3  A9 00                lda #0
004408  3  85 rr                sta scno
00440A  3  20 AD 1F             jsr nwscr
00440D  3  A9 01                lda #1
00440F  3  85 rr                sta restfl
004411  3  60           h01784: rts
004412  3               .out .sprintf("EVENT 7 SIZE = %d", (* - evnt07))
004412  3               
004412  3               evnt08:
004412  3  A9 00                lda #0
004414  3                       ; ldy #12
004414  3  A0 0C                ldy #12
004416  3  D1 rr                cmp (z80_ix),y
004418  3  90 03                bcc *+5
00441A  3  4C 60 45             jmp i00802
00441D  3  A9 00                lda #0
00441F  3  20 59 1E             jsr animsp
004422  3                       ; ldy #12
004422  3  B1 rr                lda (z80_ix),y
004424  3  38                   sec
004425  3  E9 01                sbc #1
004427  3                       ; ldy #12
004427  3  91 rr                sta (z80_ix),y
004429  3  A9 01                lda #1
00442B  3  C5 rr                cmp varc
00442D  3  90 03                bcc *+5
00442F  3  4C 44 44             jmp i00127
004432  3  A9 50                lda #80
004434  3                       ; ldy #12
004434  3  D1 rr                cmp (z80_ix),y
004436  3  90 03                bcc *+5
004438  3  4C 41 44             jmp i00122
00443B  3                       ; ldy #12
00443B  3  B1 rr                lda (z80_ix),y
00443D  3  0A                   asl a
00443E  3  8D DD 0E             sta sndtyp
004441  3  4C 44 44     i00122: jmp i00127
004444  3  A9 00        i00127: lda #0
004446  3                       ; ldy #12
004446  3  A0 0C                ldy #12
004448  3  D1 rr                cmp (z80_ix),y
00444A  3  F0 03                beq *+5
00444C  3  4C 60 45             jmp i00802
00444F  3  A9 00                lda #0
004451  3  85 rr                sta varo
004453  3  A9 06                lda #CUSTOM
004455  3  85 rr                sta z80_b
004457  3  20 85 19             jsr tded
00445A  3  C5 rr                cmp z80_b
00445C  3  F0 03                beq :+
00445E  3  4C 2E 45             jmp i00665
004461  3               :
004461  3  A9 10                lda #16
004463  3  85 rr                sta z80_c
004465  3                       ; ldy #8
004465  3  A0 08                ldy #8
004467  3  B1 rr                lda (z80_ix),y
004469  3  18                   clc
00446A  3  65 rr                adc z80_c
00446C  3                       ; ldy #8
00446C  3  91 rr                sta (z80_ix),y
00446E  3  A9 01                lda #1
004470  3  85 rr                sta z80_b
004472  3  20 A4 1E             jsr sktyp
004475  3  B0 03                bcs :+
004477  3  4C 7E 44             jmp i00259
00447A  3               :
00447A  3  A9 01                lda #1
00447C  3  85 rr                sta varo
00447E  3  A9 08        i00259: lda #8
004480  3  85 rr                sta z80_b
004482  3  20 A4 1E             jsr sktyp
004485  3  B0 03                bcs :+
004487  3  4C 8E 44             jmp i00288
00448A  3               :
00448A  3  A9 01                lda #1
00448C  3  85 rr                sta varo
00448E  3  A9 20        i00288: lda #32
004490  3  85 rr                sta z80_c
004492  3                       ; ldy #8
004492  3  A0 08                ldy #8
004494  3  B1 rr                lda (z80_ix),y
004496  3  38                   sec
004497  3  E5 rr                sbc z80_c
004499  3                       ; ldy #8
004499  3  91 rr                sta (z80_ix),y
00449B  3  A9 01                lda #1
00449D  3  85 rr                sta z80_b
00449F  3  20 A4 1E             jsr sktyp
0044A2  3  B0 03                bcs :+
0044A4  3  4C AB 44             jmp i00358
0044A7  3               :
0044A7  3  A9 01                lda #1
0044A9  3  85 rr                sta varo
0044AB  3  A9 08        i00358: lda #8
0044AD  3  85 rr                sta z80_b
0044AF  3  20 A4 1E             jsr sktyp
0044B2  3  B0 03                bcs :+
0044B4  3  4C BB 44             jmp i00388
0044B7  3               :
0044B7  3  A9 01                lda #1
0044B9  3  85 rr                sta varo
0044BB  3  A9 10        i00388: lda #16
0044BD  3  85 rr                sta z80_c
0044BF  3                       ; ldy #8
0044BF  3  A0 08                ldy #8
0044C1  3  B1 rr                lda (z80_ix),y
0044C3  3  18                   clc
0044C4  3  65 rr                adc z80_c
0044C6  3                       ; ldy #8
0044C6  3  91 rr                sta (z80_ix),y
0044C8  3  A9 10                lda #16
0044CA  3  85 rr                sta z80_c
0044CC  3                       ; ldy #9
0044CC  3  C8                   iny
0044CD  3  B1 rr                lda (z80_ix),y
0044CF  3  18                   clc
0044D0  3  65 rr                adc z80_c
0044D2  3                       ; ldy #9
0044D2  3  91 rr                sta (z80_ix),y
0044D4  3  A9 01                lda #1
0044D6  3  85 rr                sta z80_b
0044D8  3  20 A4 1E             jsr sktyp
0044DB  3  B0 03                bcs :+
0044DD  3  4C E4 44             jmp i00496
0044E0  3               :
0044E0  3  A9 01                lda #1
0044E2  3  85 rr                sta varo
0044E4  3  A9 08        i00496: lda #8
0044E6  3  85 rr                sta z80_b
0044E8  3  20 A4 1E             jsr sktyp
0044EB  3  B0 03                bcs :+
0044ED  3  4C F4 44             jmp i00526
0044F0  3               :
0044F0  3  A9 01                lda #1
0044F2  3  85 rr                sta varo
0044F4  3  A9 20        i00526: lda #32
0044F6  3  85 rr                sta z80_c
0044F8  3                       ; ldy #9
0044F8  3  A0 09                ldy #9
0044FA  3  B1 rr                lda (z80_ix),y
0044FC  3  38                   sec
0044FD  3  E5 rr                sbc z80_c
0044FF  3                       ; ldy #9
0044FF  3  91 rr                sta (z80_ix),y
004501  3  A9 01                lda #1
004503  3  85 rr                sta z80_b
004505  3  20 A4 1E             jsr sktyp
004508  3  B0 03                bcs :+
00450A  3  4C 11 45             jmp i00595
00450D  3               :
00450D  3  A9 01                lda #1
00450F  3  85 rr                sta varo
004511  3  A9 08        i00595: lda #8
004513  3  85 rr                sta z80_b
004515  3  20 A4 1E             jsr sktyp
004518  3  B0 03                bcs :+
00451A  3  4C 21 45             jmp i00625
00451D  3               :
00451D  3  A9 01                lda #1
00451F  3  85 rr                sta varo
004521  3  A9 10        i00625: lda #16
004523  3  85 rr                sta z80_c
004525  3                       ; ldy #9
004525  3  A0 09                ldy #9
004527  3  B1 rr                lda (z80_ix),y
004529  3  18                   clc
00452A  3  65 rr                adc z80_c
00452C  3                       ; ldy #9
00452C  3  91 rr                sta (z80_ix),y
00452E  3  A9 00        i00665: lda #0
004530  3  C5 rr                cmp varo
004532  3  F0 03                beq *+5
004534  3  4C 57 45             jmp i00770
004537  3  A9 00                lda #0
004539  3                       ; ldy #11
004539  3  A0 0B                ldy #11
00453B  3  D1 rr                cmp (z80_ix),y
00453D  3  90 03                bcc *+5
00453F  3  4C 4D 45             jmp i00745
004542  3  A9 FF                lda #255
004544  3  85 rr                sta z80_c
004546  3                       ; ldy #11
004546  3  B1 rr                lda (z80_ix),y
004548  3  18                   clc
004549  3  65 rr                adc z80_c
00454B  3                       ; ldy #11
00454B  3  91 rr                sta (z80_ix),y
00454D  3  A9 01        i00745: lda #1
00454F  3                       ; ldy #5
00454F  3  A0 05                ldy #5
004551  3  91 rr                sta (z80_ix),y
004553  3  60                   rts
004554  3  4C 60 45             jmp i00802
004557  3               i00770: ; ldy #12
004557  3  A0 0C                ldy #12
004559  3  B1 rr                lda (z80_ix),y
00455B  3  18                   clc
00455C  3  69 01                adc #1
00455E  3                       ; ldy #12
00455E  3  91 rr                sta (z80_ix),y
004560  3  60           i00802: rts
004561  3               .out .sprintf("EVENT 8 SIZE = %d", (* - evnt08))
004561  3               
004561  3               evnt09:
004561  3  A9 05                lda #5
004563  3                       ; ldy #5
004563  3  A0 05                ldy #5
004565  3  D1 rr                cmp (z80_ix),y
004567  3  F0 03                beq *+5
004569  3  4C 86 45             jmp j00095
00456C  3  A9 00                lda #0
00456E  3                       ; ldy #9
00456E  3  A0 09                ldy #9
004570  3  D1 rr                cmp (z80_ix),y
004572  3  F0 03                beq *+5
004574  3  4C 80 45             jmp j00077
004577  3  A9 63                lda #99
004579  3                       ; ldy #12
004579  3  A0 0C                ldy #12
00457B  3  91 rr                sta (z80_ix),y
00457D  3  4C 86 45             jmp j00095
004580  3  A9 00        j00077: lda #0
004582  3                       ; ldy #12
004582  3  A0 0C                ldy #12
004584  3  91 rr                sta (z80_ix),y
004586  3  A9 02        j00095: lda #2
004588  3                       ; ldy #5
004588  3  A0 05                ldy #5
00458A  3  D1 rr                cmp (z80_ix),y
00458C  3  F0 03                beq *+5
00458E  3  4C B7 45             jmp j00203
004591  3  A9 28                lda #40
004593  3  0A                   asl a
004594  3  8D DD 0E             sta sndtyp
004597  3  A9 07                lda #7
004599  3  85 rr                sta chary
00459B  3  A9 1D                lda #29
00459D  3  85 rr                sta charx
00459F  3  A9 18                lda #24
0045A1  3  20 ED 1A             jsr dmsg
0045A4  3  A9 07                lda #7
0045A6  3  85 rr                sta chary
0045A8  3  A9 1D                lda #29
0045AA  3  85 rr                sta charx
0045AC  3  A5 rr                lda vark
0045AE  3  20 34 1F             jsr disply
0045B1  3  A9 FF                lda #255
0045B3  3                       ; ldy #10
0045B3  3  A0 0A                ldy #10
0045B5  3  91 rr                sta (z80_ix),y
0045B7  3  A9 00        j00203: lda #0
0045B9  3                       ; ldy #5
0045B9  3  A0 05                ldy #5
0045BB  3  D1 rr                cmp (z80_ix),y
0045BD  3  F0 03                beq *+5
0045BF  3  4C D3 45             jmp j00283
0045C2  3  A9 00                lda #0
0045C4  3                       ; ldy #11
0045C4  3  A0 0B                ldy #11
0045C6  3  91 rr                sta (z80_ix),y
0045C8  3  A9 00                lda #0
0045CA  3                       ; ldy #12
0045CA  3  C8                   iny
0045CB  3  91 rr                sta (z80_ix),y
0045CD  3  A9 FF                lda #255
0045CF  3                       ; ldy #10
0045CF  3  A0 0A                ldy #10
0045D1  3  91 rr                sta (z80_ix),y
0045D3  3  A9 08        j00283: lda #8
0045D5  3                       ; ldy #5
0045D5  3  A0 05                ldy #5
0045D7  3  D1 rr                cmp (z80_ix),y
0045D9  3  F0 03                beq *+5
0045DB  3  4C 15 46             jmp j00485
0045DE  3  A9 14                lda #20
0045E0  3                       ; ldy #12
0045E0  3  A0 0C                ldy #12
0045E2  3  91 rr                sta (z80_ix),y
0045E4  3                       ; ldy #6
0045E4  3  A0 06                ldy #6
0045E6  3  B1 rr                lda (z80_ix),y
0045E8  3                       ; ldy #11
0045E8  3  A0 0B                ldy #11
0045EA  3  91 rr                sta (z80_ix),y
0045EC  3  A9 08                lda #8
0045EE  3  85 rr                sta z80_c
0045F0  3                       ; ldy #11
0045F0  3  B1 rr                lda (z80_ix),y
0045F2  3  38                   sec
0045F3  3  E5 rr                sbc z80_c
0045F5  3                       ; ldy #11
0045F5  3  91 rr                sta (z80_ix),y
0045F7  3  A9 01                lda #1
0045F9  3                       ; ldy #10
0045F9  3  88                   dey
0045FA  3  91 rr                sta (z80_ix),y
0045FC  3  A5 rr                lda varr
0045FE  3  85 rr                sta z80_c
004600  3                       ; ldy #11
004600  3  C8                   iny
004601  3  B1 rr                lda (z80_ix),y
004603  3  18                   clc
004604  3  65 rr                adc z80_c
004606  3                       ; ldy #11
004606  3  91 rr                sta (z80_ix),y
004608  3  A9 02                lda #2
00460A  3                       ; ldy #11
00460A  3  D1 rr                cmp (z80_ix),y
00460C  3  90 03                bcc *+5
00460E  3  4C 15 46             jmp j00485
004611  3  A9 02                lda #2
004613  3                       ; ldy #11
004613  3  91 rr                sta (z80_ix),y
004615  3  60           j00485: rts
004616  3               .out .sprintf("EVENT 9 SIZE = %d", (* - evnt09))
004616  3               
004616  3               evnt10:
004616  3  A5 rr                lda joyval
004618  3  29 40                and #64
00461A  3  F0 03                beq :+
00461C  3  4C 2C 46             jmp k00046
00461F  3               :
00461F  3  A5 rr                lda joyval
004621  3  29 20                and #32
004623  3  F0 03                beq :+
004625  3  4C 2C 46             jmp k00046
004628  3               :
004628  3  A9 01                lda #1
00462A  3  85 rr                sta gamwon
00462C  3  A5 rr        k00046: lda varc
00462E  3  18                   clc
00462F  3  69 01                adc #1
004631  3  85 rr                sta varc
004633  3  A9 03                lda #3
004635  3  C5 rr                cmp varc
004637  3  90 03                bcc *+5
004639  3  4C 40 46             jmp k00086
00463C  3  A9 00                lda #0
00463E  3  85 rr                sta varc
004640  3  A5 rr        k00086: lda scno
004642  3  C9 04                cmp #4
004644  3  90 03                bcc *+5
004646  3  4C F9 46             jmp k00497
004649  3  A9 AA                lda #170
00464B  3  85 rr                sta z80_d
00464D  3  20 A4 1A             jsr random
004650  3  85 rr                sta z80_h
004652  3  20 0D 13             jsr imul
004655  3  A5 rr                lda z80_h
004657  3  85 rr                sta varrnd
004659  3  A5 rr                lda varrnd
00465B  3  C5 rr                cmp clock
00465D  3  F0 03                beq *+5
00465F  3  4C AC 46             jmp k00349
004662  3                       ; ldy #8
004662  3  A0 08                ldy #8
004664  3  B1 rr                lda (z80_ix),y
004666  3  85 rr                sta varo
004668  3                       ; ldy #9
004668  3  C8                   iny
004669  3  B1 rr                lda (z80_ix),y
00466B  3  85 rr                sta varp
00466D  3  A9 58                lda #88
00466F  3                       ; ldy #8
00466F  3  88                   dey
004670  3  91 rr                sta (z80_ix),y
004672  3  A9 60                lda #96
004674  3                       ; ldy #9
004674  3  C8                   iny
004675  3  91 rr                sta (z80_ix),y
004677  3  20 20 14             jsr skobj
00467A  3  85 rr                sta varobj
00467C  3  A9 08                lda #8
00467E  3  C5 rr                cmp varobj
004680  3  F0 03                beq *+5
004682  3  4C 88 46             jmp k00252
004685  3  4C A1 46             jmp k00313
004688  3  A5 rr        k00252: lda vark
00468A  3  C9 0F                cmp #15
00468C  3  90 03                bcc *+5
00468E  3  4C A1 46             jmp k00313
004691  3                       ; ldy #9
004691  3  A0 09                ldy #9
004693  3  B1 rr                lda (z80_ix),y
004695  3  85 rr                sta dispx
004697  3                       ; ldy #8
004697  3  88                   dey
004698  3  B1 rr                lda (z80_ix),y
00469A  3  85 rr                sta dispy
00469C  3  A9 08                lda #8
00469E  3  20 FF 13             jsr drpob
0046A1  3  A5 rr        k00313: lda varo
0046A3  3                       ; ldy #8
0046A3  3  A0 08                ldy #8
0046A5  3  91 rr                sta (z80_ix),y
0046A7  3  A5 rr                lda varp
0046A9  3                       ; ldy #9
0046A9  3  C8                   iny
0046AA  3  91 rr                sta (z80_ix),y
0046AC  3  A9 00        k00349: lda #0
0046AE  3  C5 rr                cmp vark
0046B0  3  F0 03                beq *+5
0046B2  3  4C F9 46             jmp k00497
0046B5  3  A9 32                lda #50
0046B7  3  C5 rr                cmp clock
0046B9  3  F0 03                beq *+5
0046BB  3  4C CB 46             jmp k00407
0046BE  3  A9 1B                lda #27
0046C0  3  85 rr                sta charx
0046C2  3  A9 06                lda #6
0046C4  3  85 rr                sta chary
0046C6  3  A9 03                lda #3
0046C8  3  20 ED 1A             jsr dmsg
0046CB  3  A9 64        k00407: lda #100
0046CD  3  C5 rr                cmp clock
0046CF  3  F0 03                beq *+5
0046D1  3  4C E1 46             jmp k00450
0046D4  3  A9 1B                lda #27
0046D6  3  85 rr                sta charx
0046D8  3  A9 06                lda #6
0046DA  3  85 rr                sta chary
0046DC  3  A9 03                lda #3
0046DE  3  20 ED 1A             jsr dmsg
0046E1  3  A9 3C        k00450: lda #60
0046E3  3  C5 rr                cmp clock
0046E5  3  90 03                bcc *+5
0046E7  3  4C F9 46             jmp k00497
0046EA  3  A5 rr                lda clock
0046EC  3  C9 5A                cmp #90
0046EE  3  90 03                bcc *+5
0046F0  3  4C F9 46             jmp k00497
0046F3  3  A5 rr                lda clock
0046F5  3  0A                   asl a
0046F6  3  8D DD 0E             sta sndtyp
0046F9  3  60           k00497: rts
0046FA  3               .out .sprintf("EVENT 10 SIZE = %d", (* - evnt10))
0046FA  3               
0046FA  3               evnt11:
0046FA  3  60                   rts
0046FB  3               .out .sprintf("EVENT 11 SIZE = %d", (* - evnt11))
0046FB  3               
0046FB  3               evnt12:
0046FB  3  60                   rts
0046FC  3               .out .sprintf("EVENT 12 SIZE = %d", (* - evnt12))
0046FC  3               
0046FC  3               evnt13:
0046FC  3  A9 00                lda #0
0046FE  3  85 rr                sta varq
004700  3  A9 00                lda #0
004702  3  85 rr                sta varr
004704  3  A9 00                lda #0
004706  3  85 rr                sta varm
004708  3  A9 03                lda #3
00470A  3  85 rr                sta vark
00470C  3  A9 06                lda #6
00470E  3  85 rr                sta scno
004710  3  20 AD 1F             jsr nwscr
004713  3  A9 00                lda #0
004715  3  85 rr                sta varl
004717  3  A9 00                lda #0
004719  3  85 rr                sta vari
00471B  3  A9 00                lda #0
00471D  3  85 rr                sta varj
00471F  3  A9 03                lda #3
004721  3  85 rr                sta numlif
004723  3  20 04 11             jsr cls
004726  3  A9 00                lda #0
004728  3  85 rr                sta varf
00472A  3  60                   rts
00472B  3               .out .sprintf("EVENT 13 SIZE = %d", (* - evnt13))
00472B  3               
00472B  3               evnt14:
00472B  3  A9 00                lda #0
00472D  3  85 rr                sta varq
00472F  3  A9 0F                lda #15
004731  3  85 rr                sta vars
004733  3  A9 01                lda #1
004735  3  C5 rr                cmp varl
004737  3  F0 03                beq *+5
004739  3  4C 40 47             jmp o00043
00473C  3  A9 47                lda #71
00473E  3  85 rr                sta vars
004740  3  20 04 11     o00043: jsr cls
004743  3  A5 rr                lda scno
004745  3  C9 06                cmp #6
004747  3  90 03                bcc *+5
004749  3  4C 0F 48             jmp o00450
00474C  3  A9 00                lda #0
00474E  3  85 rr                sta chary
004750  3  A9 1B                lda #27
004752  3  85 rr                sta charx
004754  3  A9 02                lda #2
004756  3  20 ED 1A             jsr dmsg
004759  3  A9 02                lda #2
00475B  3  85 rr                sta chary
00475D  3  A9 1A                lda #26
00475F  3  85 rr                sta charx
004761  3  A9 18                lda #24
004763  3  20 ED 1A             jsr dmsg
004766  3  A9 02                lda #2
004768  3  85 rr                sta chary
00476A  3  A9 1D                lda #29
00476C  3  85 rr                sta charx
00476E  3  A9 18                lda #24
004770  3  20 ED 1A             jsr dmsg
004773  3  A9 02                lda #2
004775  3  85 rr                sta chary
004777  3  A9 1B                lda #27
004779  3  85 rr                sta charx
00477B  3  A5 rr                lda numlif
00477D  3  85 rr                sta loopa
00477F  3  A5 rr        o00164: lda charx
004781  3  85 rr                sta dispx
004783  3  A5 rr                lda chary
004785  3  85 rr                sta dispy
004787  3  A9 57                lda #87
004789  3  20 C9 16             jsr pattr
00478C  3  C6 rr                dec loopa
00478E  3  F0 03                beq :+
004790  3  4C 7F 47             jmp o00164
004793  3               :
004793  3  A9 03                lda #3
004795  3  85 rr                sta chary
004797  3  A9 1B                lda #27
004799  3  85 rr                sta charx
00479B  3  A9 0E                lda #14
00479D  3  20 ED 1A             jsr dmsg
0047A0  3  A9 06                lda #6
0047A2  3  85 rr                sta chary
0047A4  3  A9 1B                lda #27
0047A6  3  85 rr                sta charx
0047A8  3  A9 03                lda #3
0047AA  3  20 ED 1A             jsr dmsg
0047AD  3  A9 09                lda #9
0047AF  3  85 rr                sta chary
0047B1  3  A9 1B                lda #27
0047B3  3  85 rr                sta charx
0047B5  3  A9 04                lda #4
0047B7  3  20 ED 1A             jsr dmsg
0047BA  3  A9 0C                lda #12
0047BC  3  85 rr                sta chary
0047BE  3  A9 1B                lda #27
0047C0  3  85 rr                sta charx
0047C2  3  A9 05                lda #5
0047C4  3  20 ED 1A             jsr dmsg
0047C7  3  A9 01                lda #1
0047C9  3  85 rr                sta chary
0047CB  3  A9 1B                lda #27
0047CD  3  85 rr                sta charx
0047CF  3  20 49 15             jsr dscor
0047D2  3  A9 04                lda #4
0047D4  3  85 rr                sta chary
0047D6  3  A9 1B                lda #27
0047D8  3  85 rr                sta charx
0047DA  3  A9 1D                lda #29
0047DC  3  85 rr                sta charx
0047DE  3  A9 07                lda #7
0047E0  3  85 rr                sta chary
0047E2  3  A5 rr                lda vark
0047E4  3  20 34 1F             jsr disply
0047E7  3  A9 0A                lda #10
0047E9  3  85 rr                sta chary
0047EB  3  A9 1D                lda #29
0047ED  3  85 rr                sta charx
0047EF  3  A5 rr                lda varf
0047F1  3  18                   clc
0047F2  3  69 01                adc #1
0047F4  3  85 rr                sta varf
0047F6  3  A5 rr                lda varf
0047F8  3  20 34 1F             jsr disply
0047FB  3  A5 rr                lda varf
0047FD  3  38                   sec
0047FE  3  E9 01                sbc #1
004800  3  85 rr                sta varf
004802  3  A9 1D                lda #29
004804  3  85 rr                sta charx
004806  3  A9 0D                lda #13
004808  3  85 rr                sta chary
00480A  3  A5 rr                lda vari
00480C  3  20 34 1F             jsr disply
00480F  3  A9 0E        o00450: lda #14
004811  3  85 rr                sta varp
004813  3  A9 24                lda #36
004815  3  85 rr                sta varq
004817  3  A9 0A                lda #10
004819  3  85 rr                sta loopa
00481B  3  A9 1B        o00475: lda #27
00481D  3  85 rr                sta charx
00481F  3  A5 rr                lda varp
004821  3  85 rr                sta chary
004823  3  A5 rr                lda charx
004825  3  85 rr                sta dispx
004827  3  A5 rr                lda chary
004829  3  85 rr                sta dispy
00482B  3  A5 rr                lda varq
00482D  3  20 C9 16             jsr pattr
004830  3  A5 rr                lda varq
004832  3  18                   clc
004833  3  69 01                adc #1
004835  3  85 rr                sta varq
004837  3  A5 rr                lda charx
004839  3  85 rr                sta dispx
00483B  3  A5 rr                lda chary
00483D  3  85 rr                sta dispy
00483F  3  A5 rr                lda varq
004841  3  20 C9 16             jsr pattr
004844  3  A5 rr                lda varq
004846  3  18                   clc
004847  3  69 01                adc #1
004849  3  85 rr                sta varq
00484B  3  A5 rr                lda charx
00484D  3  85 rr                sta dispx
00484F  3  A5 rr                lda chary
004851  3  85 rr                sta dispy
004853  3  A5 rr                lda varq
004855  3  20 C9 16             jsr pattr
004858  3  A5 rr                lda varq
00485A  3  18                   clc
00485B  3  69 01                adc #1
00485D  3  85 rr                sta varq
00485F  3  A5 rr                lda charx
004861  3  85 rr                sta dispx
004863  3  A5 rr                lda chary
004865  3  85 rr                sta dispy
004867  3  A5 rr                lda varq
004869  3  20 C9 16             jsr pattr
00486C  3  A5 rr                lda varq
00486E  3  18                   clc
00486F  3  69 01                adc #1
004871  3  85 rr                sta varq
004873  3  A5 rr                lda charx
004875  3  85 rr                sta dispx
004877  3  A5 rr                lda chary
004879  3  85 rr                sta dispy
00487B  3  A5 rr                lda varq
00487D  3  20 C9 16             jsr pattr
004880  3  A5 rr                lda varq
004882  3  18                   clc
004883  3  69 01                adc #1
004885  3  85 rr                sta varq
004887  3  A5 rr                lda varp
004889  3  18                   clc
00488A  3  69 01                adc #1
00488C  3  85 rr                sta varp
00488E  3  C6 rr                dec loopa
004890  3  F0 03                beq :+
004892  3  4C 1B 48             jmp o00475
004895  3               :
004895  3  A5 rr                lda scno
004897  3  18                   clc
004898  3  69 01                adc #1
00489A  3  85 rr                sta scno
00489C  3  20 AD 1F             jsr nwscr
00489F  3  A5 rr                lda scno
0048A1  3  85 rr                sta varm
0048A3  3  A5 rr                lda scno
0048A5  3  38                   sec
0048A6  3  E9 01                sbc #1
0048A8  3  85 rr                sta scno
0048AA  3  20 AD 1F             jsr nwscr
0048AD  3  A9 04                lda #4
0048AF  3  C5 rr                cmp scno
0048B1  3  F0 03                beq *+5
0048B3  3  4C D6 48             jmp o00861
0048B6  3  A9 17                lda #23
0048B8  3  85 rr                sta chary
0048BA  3  A9 00                lda #0
0048BC  3  85 rr                sta charx
0048BE  3  A9 1A                lda #26
0048C0  3  85 rr                sta loopa
0048C2  3  A5 rr        o00821: lda charx
0048C4  3  85 rr                sta dispx
0048C6  3  A5 rr                lda chary
0048C8  3  85 rr                sta dispy
0048CA  3  A9 1A                lda #26
0048CC  3  20 C9 16             jsr pattr
0048CF  3  C6 rr                dec loopa
0048D1  3  F0 03                beq :+
0048D3  3  4C C2 48             jmp o00821
0048D6  3               :
0048D6  3  A9 08        o00861: lda #8
0048D8  3  85 rr                sta z80_d
0048DA  3  20 A4 1A             jsr random
0048DD  3  85 rr                sta z80_h
0048DF  3  20 0D 13             jsr imul
0048E2  3  A5 rr                lda z80_h
0048E4  3  85 rr                sta varrnd
0048E6  3  A5 rr                lda varrnd
0048E8  3  85 rr                sta varo
0048EA  3  A9 08                lda #8
0048EC  3  85 rr                sta z80_d
0048EE  3  20 A4 1A             jsr random
0048F1  3  85 rr                sta z80_h
0048F3  3  20 0D 13             jsr imul
0048F6  3  A5 rr                lda z80_h
0048F8  3  85 rr                sta varrnd
0048FA  3  A5 rr                lda varo
0048FC  3  C5 rr                cmp varrnd
0048FE  3  F0 03                beq *+5
004900  3  4C 56 49             jmp o01111
004903  3  A9 08                lda #8
004905  3  85 rr                sta z80_d
004907  3  20 A4 1A             jsr random
00490A  3  85 rr                sta z80_h
00490C  3  20 0D 13             jsr imul
00490F  3  A5 rr                lda z80_h
004911  3  85 rr                sta varrnd
004913  3  A5 rr                lda varo
004915  3  C5 rr                cmp varrnd
004917  3  F0 03                beq *+5
004919  3  4C 4F 49             jmp o01097
00491C  3  A9 08                lda #8
00491E  3  85 rr                sta z80_d
004920  3  20 A4 1A             jsr random
004923  3  85 rr                sta z80_h
004925  3  20 0D 13             jsr imul
004928  3  A5 rr                lda z80_h
00492A  3  85 rr                sta varrnd
00492C  3  A5 rr                lda varo
00492E  3  C5 rr                cmp varrnd
004930  3  F0 03                beq *+5
004932  3  4C 48 49             jmp o01083
004935  3  A9 08                lda #8
004937  3  85 rr                sta z80_d
004939  3  20 A4 1A             jsr random
00493C  3  85 rr                sta z80_h
00493E  3  20 0D 13             jsr imul
004941  3  A5 rr                lda z80_h
004943  3  85 rr                sta varrnd
004945  3  4C 4C 49             jmp o01092
004948  3  A5 rr        o01083: lda varrnd
00494A  3  85 rr                sta varh
00494C  3  4C 53 49     o01092: jmp o01106
00494F  3  A5 rr        o01097: lda varrnd
004951  3  85 rr                sta varh
004953  3  4C 5A 49     o01106: jmp o01120
004956  3  A5 rr        o01111: lda varrnd
004958  3  85 rr                sta varh
00495A  3  A5 rr        o01120: lda varo
00495C  3  C5 rr                cmp varh
00495E  3  F0 03                beq *+5
004960  3  4C 82 49             jmp o01202
004963  3  A9 02                lda #2
004965  3  85 rr                sta z80_c
004967  3  A5 rr                lda varh
004969  3  18                   clc
00496A  3  65 rr                adc z80_c
00496C  3  85 rr                sta varh
00496E  3  A9 07                lda #7
004970  3  C5 rr                cmp varh
004972  3  90 03                bcc *+5
004974  3  4C 82 49             jmp o01202
004977  3  A9 07                lda #7
004979  3  85 rr                sta z80_c
00497B  3  A5 rr                lda varh
00497D  3  38                   sec
00497E  3  E5 rr                sbc z80_c
004980  3  85 rr                sta varh
004982  3  A5 rr        o01202: lda varo
004984  3  0A                   asl a
004985  3  0A                   asl a
004986  3  0A                   asl a
004987  3  0A                   asl a
004988  3  85 rr                sta varo
00498A  3  A5 rr                lda varo
00498C  3  85 rr                sta z80_c
00498E  3  A5 rr                lda varh
004990  3  18                   clc
004991  3  65 rr                adc z80_c
004993  3  85 rr                sta varh
004995  3  A9 05                lda #5
004997  3  85 rr                sta varg
004999  3  A9 00                lda #0
00499B  3  85 rr                sta charx
00499D  3  A9 17                lda #23
00499F  3  85 rr                sta chary
0049A1  3  A9 00                lda #0
0049A3  3  C5 rr                cmp scno
0049A5  3  F0 03                beq *+5
0049A7  3  4C E9 49             jmp o01418
0049AA  3  A5 rr                lda charx
0049AC  3  85 rr                sta dispx
0049AE  3  A5 rr                lda chary
0049B0  3  85 rr                sta dispy
0049B2  3  A9 00                lda #0
0049B4  3  20 C9 16             jsr pattr
0049B7  3  A9 0C                lda #12
0049B9  3  85 rr                sta loopa
0049BB  3  A5 rr        o01326: lda charx
0049BD  3  85 rr                sta dispx
0049BF  3  A5 rr                lda chary
0049C1  3  85 rr                sta dispy
0049C3  3  A9 01                lda #1
0049C5  3  20 C9 16             jsr pattr
0049C8  3  A5 rr                lda charx
0049CA  3  85 rr                sta dispx
0049CC  3  A5 rr                lda chary
0049CE  3  85 rr                sta dispy
0049D0  3  A9 00                lda #0
0049D2  3  20 C9 16             jsr pattr
0049D5  3  C6 rr                dec loopa
0049D7  3  F0 03                beq :+
0049D9  3  4C BB 49             jmp o01326
0049DC  3               :
0049DC  3  A5 rr                lda charx
0049DE  3  85 rr                sta dispx
0049E0  3  A5 rr                lda chary
0049E2  3  85 rr                sta dispy
0049E4  3  A9 01                lda #1
0049E6  3  20 C9 16             jsr pattr
0049E9  3  A9 01        o01418: lda #1
0049EB  3  C5 rr                cmp scno
0049ED  3  F0 03                beq *+5
0049EF  3  4C 4B 4A             jmp o01614
0049F2  3  A9 06                lda #6
0049F4  3  85 rr                sta loopa
0049F6  3  A5 rr        o01443: lda charx
0049F8  3  85 rr                sta dispx
0049FA  3  A5 rr                lda chary
0049FC  3  85 rr                sta dispy
0049FE  3  A9 00                lda #0
004A00  3  20 C9 16             jsr pattr
004A03  3  A5 rr                lda charx
004A05  3  85 rr                sta dispx
004A07  3  A5 rr                lda chary
004A09  3  85 rr                sta dispy
004A0B  3  A9 00                lda #0
004A0D  3  20 C9 16             jsr pattr
004A10  3  A5 rr                lda charx
004A12  3  85 rr                sta dispx
004A14  3  A5 rr                lda chary
004A16  3  85 rr                sta dispy
004A18  3  A9 01                lda #1
004A1A  3  20 C9 16             jsr pattr
004A1D  3  A5 rr                lda charx
004A1F  3  85 rr                sta dispx
004A21  3  A5 rr                lda chary
004A23  3  85 rr                sta dispy
004A25  3  A9 01                lda #1
004A27  3  20 C9 16             jsr pattr
004A2A  3  C6 rr                dec loopa
004A2C  3  F0 03                beq :+
004A2E  3  4C F6 49             jmp o01443
004A31  3               :
004A31  3  A5 rr                lda charx
004A33  3  85 rr                sta dispx
004A35  3  A5 rr                lda chary
004A37  3  85 rr                sta dispy
004A39  3  A9 00                lda #0
004A3B  3  20 C9 16             jsr pattr
004A3E  3  A5 rr                lda charx
004A40  3  85 rr                sta dispx
004A42  3  A5 rr                lda chary
004A44  3  85 rr                sta dispy
004A46  3  A9 00                lda #0
004A48  3  20 C9 16             jsr pattr
004A4B  3  A9 02        o01614: lda #2
004A4D  3  C5 rr                cmp scno
004A4F  3  F0 03                beq *+5
004A51  3  4C AD 4A             jmp o01810
004A54  3  A9 06                lda #6
004A56  3  85 rr                sta loopa
004A58  3  A5 rr        o01639: lda charx
004A5A  3  85 rr                sta dispx
004A5C  3  A5 rr                lda chary
004A5E  3  85 rr                sta dispy
004A60  3  A9 00                lda #0
004A62  3  20 C9 16             jsr pattr
004A65  3  A5 rr                lda charx
004A67  3  85 rr                sta dispx
004A69  3  A5 rr                lda chary
004A6B  3  85 rr                sta dispy
004A6D  3  A9 00                lda #0
004A6F  3  20 C9 16             jsr pattr
004A72  3  A5 rr                lda charx
004A74  3  85 rr                sta dispx
004A76  3  A5 rr                lda chary
004A78  3  85 rr                sta dispy
004A7A  3  A9 01                lda #1
004A7C  3  20 C9 16             jsr pattr
004A7F  3  A5 rr                lda charx
004A81  3  85 rr                sta dispx
004A83  3  A5 rr                lda chary
004A85  3  85 rr                sta dispy
004A87  3  A9 01                lda #1
004A89  3  20 C9 16             jsr pattr
004A8C  3  C6 rr                dec loopa
004A8E  3  F0 03                beq :+
004A90  3  4C 58 4A             jmp o01639
004A93  3               :
004A93  3  A5 rr                lda charx
004A95  3  85 rr                sta dispx
004A97  3  A5 rr                lda chary
004A99  3  85 rr                sta dispy
004A9B  3  A9 00                lda #0
004A9D  3  20 C9 16             jsr pattr
004AA0  3  A5 rr                lda charx
004AA2  3  85 rr                sta dispx
004AA4  3  A5 rr                lda chary
004AA6  3  85 rr                sta dispy
004AA8  3  A9 00                lda #0
004AAA  3  20 C9 16             jsr pattr
004AAD  3  A9 03        o01810: lda #3
004AAF  3  C5 rr                cmp scno
004AB1  3  F0 03                beq *+5
004AB3  3  4C 91 4B             jmp o02268
004AB6  3  A9 02                lda #2
004AB8  3  85 rr                sta loopa
004ABA  3  A5 rr        o01835: lda charx
004ABC  3  85 rr                sta dispx
004ABE  3  A5 rr                lda chary
004AC0  3  85 rr                sta dispy
004AC2  3  A9 01                lda #1
004AC4  3  20 C9 16             jsr pattr
004AC7  3  A5 rr                lda charx
004AC9  3  85 rr                sta dispx
004ACB  3  A5 rr                lda chary
004ACD  3  85 rr                sta dispy
004ACF  3  A9 00                lda #0
004AD1  3  20 C9 16             jsr pattr
004AD4  3  A5 rr                lda charx
004AD6  3  85 rr                sta dispx
004AD8  3  A5 rr                lda chary
004ADA  3  85 rr                sta dispy
004ADC  3  A9 00                lda #0
004ADE  3  20 C9 16             jsr pattr
004AE1  3  A5 rr                lda charx
004AE3  3  85 rr                sta dispx
004AE5  3  A5 rr                lda chary
004AE7  3  85 rr                sta dispy
004AE9  3  A9 00                lda #0
004AEB  3  20 C9 16             jsr pattr
004AEE  3  A5 rr                lda charx
004AF0  3  85 rr                sta dispx
004AF2  3  A5 rr                lda chary
004AF4  3  85 rr                sta dispy
004AF6  3  A9 01                lda #1
004AF8  3  20 C9 16             jsr pattr
004AFB  3  A5 rr                lda charx
004AFD  3  85 rr                sta dispx
004AFF  3  A5 rr                lda chary
004B01  3  85 rr                sta dispy
004B03  3  A9 00                lda #0
004B05  3  20 C9 16             jsr pattr
004B08  3  A5 rr                lda charx
004B0A  3  85 rr                sta dispx
004B0C  3  A5 rr                lda chary
004B0E  3  85 rr                sta dispy
004B10  3  A9 01                lda #1
004B12  3  20 C9 16             jsr pattr
004B15  3  A5 rr                lda charx
004B17  3  85 rr                sta dispx
004B19  3  A5 rr                lda chary
004B1B  3  85 rr                sta dispy
004B1D  3  A9 01                lda #1
004B1F  3  20 C9 16             jsr pattr
004B22  3  A5 rr                lda charx
004B24  3  85 rr                sta dispx
004B26  3  A5 rr                lda chary
004B28  3  85 rr                sta dispy
004B2A  3  A9 01                lda #1
004B2C  3  20 C9 16             jsr pattr
004B2F  3  A5 rr                lda charx
004B31  3  85 rr                sta dispx
004B33  3  A5 rr                lda chary
004B35  3  85 rr                sta dispy
004B37  3  A9 00                lda #0
004B39  3  20 C9 16             jsr pattr
004B3C  3  C6 rr                dec loopa
004B3E  3  F0 03                beq :+
004B40  3  4C BA 4A             jmp o01835
004B43  3               :
004B43  3  A5 rr                lda charx
004B45  3  85 rr                sta dispx
004B47  3  A5 rr                lda chary
004B49  3  85 rr                sta dispy
004B4B  3  A9 01                lda #1
004B4D  3  20 C9 16             jsr pattr
004B50  3  A5 rr                lda charx
004B52  3  85 rr                sta dispx
004B54  3  A5 rr                lda chary
004B56  3  85 rr                sta dispy
004B58  3  A9 00                lda #0
004B5A  3  20 C9 16             jsr pattr
004B5D  3  A5 rr                lda charx
004B5F  3  85 rr                sta dispx
004B61  3  A5 rr                lda chary
004B63  3  85 rr                sta dispy
004B65  3  A9 00                lda #0
004B67  3  20 C9 16             jsr pattr
004B6A  3  A5 rr                lda charx
004B6C  3  85 rr                sta dispx
004B6E  3  A5 rr                lda chary
004B70  3  85 rr                sta dispy
004B72  3  A9 00                lda #0
004B74  3  20 C9 16             jsr pattr
004B77  3  A5 rr                lda charx
004B79  3  85 rr                sta dispx
004B7B  3  A5 rr                lda chary
004B7D  3  85 rr                sta dispy
004B7F  3  A9 01                lda #1
004B81  3  20 C9 16             jsr pattr
004B84  3  A5 rr                lda charx
004B86  3  85 rr                sta dispx
004B88  3  A5 rr                lda chary
004B8A  3  85 rr                sta dispy
004B8C  3  A9 00                lda #0
004B8E  3  20 C9 16             jsr pattr
004B91  3  60           o02268: rts
004B92  3               .out .sprintf("EVENT 14 SIZE = %d", (* - evnt14))
004B92  3               
004B92  3               evnt15:
004B92  3  60                   rts
004B93  3               .out .sprintf("EVENT 15 SIZE = %d", (* - evnt15))
004B93  3               
004B93  3               evnt16:
004B93  3  60                   rts
004B94  3               .out .sprintf("EVENT 16 SIZE = %d", (* - evnt16))
004B94  3               
004B94  3               evnt17:
004B94  3  60                   rts
004B95  3               .out .sprintf("EVENT 17 SIZE = %d", (* - evnt17))
004B95  3               
004B95  3               evnt18:
004B95  3  60                   rts
004B96  3               .out .sprintf("EVENT 18 SIZE = %d", (* - evnt18))
004B96  3               
004B96  3               evnt19:
004B96  3  60                   rts
004B97  3               .out .sprintf("EVENT 19 SIZE = %d", (* - evnt19))
004B97  3               
004B97  3               evnt20:
004B97  3  60                   rts
004B98  3               .out .sprintf("EVENT 20 SIZE = %d", (* - evnt20))
004B98  3               
004B98  3  60           ptcusr: rts
004B99  3               script_end:
004B99  3               
004B99  3               .out .sprintf("TOTAL SCRIPT SIZE = %d", (* - script_start))
004B99  3               
004B99  3               data_start:
004B99  3               msgdat:
004B99  3  47 41 4D 45          .byte "GAME",141
004B9D  3  8D           
004B9E  3  4F 56 45 52          .byte "OVER",141
004BA2  3  8D           
004BA3  3  53 43 4F 52          .byte "SCORE",141
004BA7  3  45 8D        
004BA9  3  42 4F 4D 42          .byte "BOMBS",13
004BAD  3  53 0D        
004BAF  3  8D                   .byte 141
004BB0  3  46 4C 4F 4F          .byte "FLOOR",141
004BB4  3  52 8D        
004BB6  3  53 41 56 45          .byte "SAVED",141
004BBA  3  44 8D        
004BBC  3  31 53 54 8D          .byte "1ST",141
004BC0  3  32 4E 44 8D          .byte "2ND",141
004BC4  3  33 52 44 8D          .byte "3RD",141
004BC8  3  34 54 48 8D          .byte "4TH",141
004BCC  3  35 54 48 8D          .byte "5TH",141
004BD0  3  36 54 48 8D          .byte "6TH",141
004BD4  3  37 54 48 8D          .byte "7TH",141
004BD8  3  38 54 48 8D          .byte "8TH",141
004BDC  3  48 49 47 48          .byte "HIGH",141
004BE0  3  8D           
004BE1  3  50 4C 41 59          .byte "PLAY",141
004BE5  3  8D           
004BE6  3  2D 54 45 52          .byte "-TERRAPINS-",141
004BEA  3  52 41 50 49  
004BEE  3  4E 53 2D 8D  
004BF2  3  48 4F 57 2A          .byte "HOW*MANY*KIDTERRAPINS",141
004BF6  3  4D 41 4E 59  
004BFA  3  2A 4B 49 44  
004C08  3  43 41 4E 2A          .byte "CAN*YOU*RESCUE*?",141
004C0C  3  59 4F 55 2A  
004C10  3  52 45 53 43  
004C19  3  4F 52 49 47          .byte "ORIGINAL*ARCADE*GAME*1981",141
004C1D  3  49 4E 41 4C  
004C21  3  2A 41 52 43  
004C33  3  5A 58 2A 47          .byte "ZX*GAME*BY*HIGHRISE*2017",141
004C37  3  41 4D 45 2A  
004C3B  3  42 59 2A 48  
004C4C  3  50 52 45 53          .byte "PRESS*FIRE*TO*PLAY",141
004C50  3  53 2A 46 49  
004C54  3  52 45 2A 54  
004C5F  3  28 62 63 64          .byte "(bcdefghijklmn",141
004C63  3  65 66 67 68  
004C67  3  69 6A 6B 6C  
004C6E  3  48 49 47 48          .byte "HIGH",141
004C72  3  8D           
004C73  3  2A 2A 2A 8D          .byte "***",141
004C77  3  43 4F 4E 47          .byte "CONGRATULATIONS",141
004C7B  3  52 41 54 55  
004C7F  3  4C 41 54 49  
004C87  3  41 2A 54 4F          .byte "A*TOUGHER*CHALLENGE*AWAITS",141
004C8B  3  55 47 48 45  
004C8F  3  52 2A 43 48  
004CA2  3  4B 45 59 42          .byte "KEYBOARD",141
004CA6  3  4F 41 52 44  
004CAA  3  8D           
004CAB  3  4B 45 4D 50          .byte "KEMPSTON",141
004CAF  3  53 54 4F 4E  
004CB3  3  8D           
004CB4  3  53 49 4E 43          .byte "SINCLAIR",141
004CB8  3  4C 41 49 52  
004CBC  3  8D           
004CBD  3  43 4F 4E 54          .byte "CONTROL:",141
004CC1  3  52 4F 4C 3A  
004CC5  3  8D           
004CC6  3  21 27                .byte "!",39
004CC8  3  23 24 25 26          .byte "#$%&",141
004CCC  3  8D           
004CCD  3               nummsg:
004CCD  3  20                   .byte 32
004CCE  3               .out .sprintf("MESSAGE SIZE = %d", (* - msgdat))
004CCE  3               
004CCE  3               chgfx:
004CCE  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0
004CD2  3  00 00 00 00  
004CD6  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0
004CDA  3  00 00 00 00  
004CDE  3  00 FF FF 55          .byte 0,255,255,85,170,0,255,0
004CE2  3  AA 00 FF 00  
004CE6  3  6A 72 6A 72          .byte 106,114,106,114,106,114,106,114
004CEA  3  6A 72 6A 72  
004CEE  3  EA F2 EA 52          .byte 234,242,234,82,170,6,252,1
004CF2  3  AA 06 FC 01  
004CF6  3  6A 75 6A 75          .byte 106,117,106,117,106,112,63,128
004CFA  3  6A 70 3F 80  
004CFE  3  80 3F 7F 75          .byte 128,63,127,117,106,117,106,117
004D02  3  6A 75 6A 75  
004D06  3  01 FC FE 56          .byte 1,252,254,86,170,82,170,82
004D0A  3  AA 52 AA 52  
004D0E  3  6A 72 6A 72          .byte 106,114,106,114,106,118,60,129
004D12  3  6A 76 3C 81  
004D16  3  81 3C 6A 72          .byte 129,60,106,114,106,114,106,114
004D1A  3  6A 72 6A 72  
004D1E  3  01 FC FE 56          .byte 1,252,254,86,170,6,252,1
004D22  3  AA 06 FC 01  
004D26  3  80 3F 7F 55          .byte 128,63,127,85,106,64,63,128
004D2A  3  6A 40 3F 80  
004D2E  3  6A FF FF 55          .byte 106,255,255,85,170,0,255,0
004D32  3  AA 00 FF 00  
004D36  3  00 FF FF 55          .byte 0,255,255,85,170,0,255,118
004D3A  3  AA 00 FF 76  
004D3E  3  01 03 07 0F          .byte 1,3,7,15,31,63,127,255
004D42  3  1F 3F 7F FF  
004D46  3  00 00 7E 40          .byte 0,0,126,64,126,2,126,0
004D4A  3  7E 02 7E 00  
004D4E  3  80 00 BF A1          .byte 128,0,191,161,161,161,161,0
004D52  3  A1 A1 A1 00  
004D56  3  00 00 7E 40          .byte 0,0,126,64,64,64,126,0
004D5A  3  40 40 7E 00  
004D5E  3  80 80 BF 81          .byte 128,128,191,129,191,161,191,0
004D62  3  BF A1 BF 00  
004D66  3  40 00 5F 50          .byte 64,0,95,80,80,80,80,0
004D6A  3  50 50 50 00  
004D6E  3  03 03 03 03          .byte 3,3,3,3,3,3,3,3
004D72  3  03 03 03 03  
004D76  3  60 60 60 60          .byte 96,96,96,96,96,96,96,96
004D7A  3  60 60 60 60  
004D7E  3  00 00 00 00          .byte 0,0,0,0,0,0,255,255
004D82  3  00 00 FF FF  
004D86  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0
004D8A  3  00 00 00 00  
004D8E  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0
004D92  3  00 00 00 00  
004D96  3  18 18 18 18          .byte 24,24,24,24,24,24,24,24
004D9A  3  18 18 18 18  
004D9E  3  00 48 00 20          .byte 0,72,0,32,2,128,0,36
004DA2  3  02 80 00 24  
004DA6  3  88 88 88 88          .byte 136,136,136,136,136,136,136,136
004DAA  3  88 88 88 88  
004DAE  3  60 60 60 60          .byte 96,96,96,96,96,96,224,224
004DB2  3  60 60 E0 E0  
004DB6  3  CE AA CC AA          .byte 206,170,204,170,202,0,0,0
004DBA  3  CA 00 00 00  
004DBE  3  D1 91 D5 95          .byte 209,145,213,149,223,0,0,0
004DC2  3  DF 00 00 00  
004DC6  3  6C 4A 6A 4A          .byte 108,74,106,74,108,0,0,0
004DCA  3  6C 00 00 00  
004DCE  3  5E 52 52 52          .byte 94,82,82,82,82,0,0,0
004DD2  3  52 00 00 00  
004DD6  3  7B 4A 7A 4A          .byte 123,74,122,74,75,0,0,0
004DDA  3  4B 00 00 00  
004DDE  3  DC 12 12 52          .byte 220,18,18,82,220,0,0,0
004DE2  3  DC 00 00 00  
004DE6  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0
004DEA  3  00 00 00 00  
004DEE  3  FF 87 02 02          .byte 255,135,2,2,201,201,200,201
004DF2  3  C9 C9 C8 C9  
004DF6  3  FF FF CE 04          .byte 255,255,206,4,181,165,132,156
004DFA  3  B5 A5 84 9C  
004DFE  3  FF FF 73 21          .byte 255,255,115,33,173,41,33,225
004E02  3  AD 29 21 E1  
004E06  3  FF FF 9B 0A          .byte 255,255,155,10,106,74,10,26
004E0A  3  6A 4A 0A 1A  
004E0E  3  FF FC 28 28          .byte 255,252,40,40,11,73,77,76
004E12  3  0B 49 4D 4C  
004E16  3  C8 C8 CB CF          .byte 200,200,203,207,255,255,255,255
004E1A  3  FF FF FF FF  
004E1E  3  04 94 B5 FF          .byte 4,148,181,255,255,255,255,255
004E22  3  FF FF FF FF  
004E26  3  25 A5 AD FF          .byte 37,165,173,255,255,255,255,255
004E2A  3  FF FF FF FF  
004E2E  3  32 32 76 FF          .byte 50,50,118,255,255,255,255,255
004E32  3  FF FF FF FF  
004E36  3  6A 6A E8 F9          .byte 106,106,232,249,255,255,255,255
004E3A  3  FF FF FF FF  
004E3E  3  FF FF FF FE          .byte 255,255,255,254,254,252,248,252
004E42  3  FE FC F8 FC  
004E46  3  FF FC E4 48          .byte 255,252,228,72,208,80,128,0
004E4A  3  D0 50 80 00  
004E4E  3  00 00 00 01          .byte 0,0,0,1,3,6,12,16
004E52  3  03 06 0C 10  
004E56  3  00 00 FE C3          .byte 0,0,254,195,8,17,55,126
004E5A  3  08 11 37 7E  
004E5E  3  FF 0F 03 01          .byte 255,15,3,1,21,11,0,28
004E62  3  15 0B 00 1C  
004E66  3  FF FC F8 F8          .byte 255,252,248,248,248,240,241,243
004E6A  3  F8 F0 F1 F3  
004E6E  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0
004E72  3  00 00 00 00  
004E76  3  FF FF FC FC          .byte 255,255,252,252,248,248,240,240
004E7A  3  F8 F8 F0 F0  
004E7E  3  FF 07 07 01          .byte 255,7,7,1,0,48,120,232
004E82  3  00 30 78 E8  
004E86  3  F0 E0 C0 C0          .byte 240,224,192,192,224,224,248,224
004E8A  3  E0 E0 F8 E0  
004E8E  3  F3 F3 F3 F0          .byte 243,243,243,240,240,248,252,255
004E92  3  F0 F8 FC FF  
004E96  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0
004E9A  3  00 00 00 00  
004E9E  3  E0 E0 E0 E0          .byte 224,224,224,224,224,224,240,248
004EA2  3  E0 E0 F0 F8  
004EA6  3  C8 98 F8 70          .byte 200,152,248,112,0,0,1,3
004EAA  3  00 00 01 03  
004EAE  3  FC E0 E0 C0          .byte 252,224,224,192,128,0,0,128
004EB2  3  80 00 00 80  
004EB6  3  F1 E0 E0 E0          .byte 241,224,224,224,224,240,240,248
004EBA  3  E0 F0 F0 F8  
004EBE  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0
004EC2  3  00 00 00 00  
004EC6  3  00 00 00 00          .byte 0,0,0,0,0,0,16,62
004ECA  3  00 00 10 3E  
004ECE  3  81 00 00 00          .byte 129,0,0,0,0,0,0,0
004ED2  3  00 00 00 00  
004ED6  3  C0 20 20 00          .byte 192,32,32,0,0,0,0,0
004EDA  3  00 00 00 00  
004EDE  3  FC FE FF FF          .byte 252,254,255,255,255,255,255,255
004EE2  3  FF FF FF FF  
004EE6  3  00 01 07 8F          .byte 0,1,7,143,223,255,255,255
004EEA  3  DF FF FF FF  
004EEE  3  FF FF FF D1          .byte 255,255,255,209,129,193,255,255
004EF2  3  81 C1 FF FF  
004EF6  3  00 C0 F3 FE          .byte 0,192,243,254,192,128,0,0
004EFA  3  C0 80 00 00  
004EFE  3  20 E0 80 00          .byte 32,224,128,0,3,7,13,26
004F02  3  03 07 0D 1A  
004F06  3  FF FF FF FF          .byte 255,255,255,255,255,255,240,224
004F0A  3  FF FF F0 E0  
004F0E  3  9F 0F 0F 07          .byte 159,15,15,7,135,131,65,33
004F12  3  87 83 41 21  
004F16  3  80 80 C0 F8          .byte 128,128,192,248,255,254,255,255
004F1A  3  FF FE FF FF  
004F1E  3  01 47 04 18          .byte 1,71,4,24,224,0,0,7
004F22  3  E0 00 00 07  
004F26  3  E5 02 05 0A          .byte 229,2,5,10,21,43,119,255
004F2A  3  15 2B 77 FF  
004F2E  3  E1 DF C1 C1          .byte 225,223,193,193,225,223,193,193
004F32  3  E1 DF C1 C1  
004F36  3  10 08 80 80          .byte 16,8,128,128,128,64,0,0
004F3A  3  80 40 00 00  
004F3E  3  EA 41 00 01          .byte 234,65,0,1,34,37,107,255
004F42  3  22 25 6B FF  
004F46  3  FF FE AA D4          .byte 255,254,170,212,160,192,64,170
004F4A  3  A0 C0 40 AA  
004F4E  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0
004F52  3  00 00 00 00  
004F56  3  E1 FF FF FF          .byte 225,255,255,255,255,255,255,255
004F5A  3  FF FF FF FF  
004F5E  3  FF FD EA D4          .byte 255,253,234,212,168,212,168,212
004F62  3  A8 D4 A8 D4  
004F66  3  F8 70 E0 C0          .byte 248,112,224,192,234,128,128,128
004F6A  3  EA 80 80 80  
004F6E  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0
004F72  3  00 00 00 00  
004F76  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0
004F7A  3  00 00 00 00  
004F7E  3  00 FE C3 00          .byte 0,254,195,0,0,0,0,0
004F82  3  00 00 00 00  
004F86  3  08 1C 41 1C          .byte 8,28,65,28,54,42,54,73
004F8A  3  36 2A 36 49  
004F8E  3  00 0F FE C3          .byte 0,15,254,195,0,0,0,0
004F92  3  00 00 00 00  
004F96  3  00 00 08 11          .byte 0,0,8,17,55,126,254,255
004F9A  3  37 7E FE FF  
004F9E  3               bprop:
004F9E  3  00                   .byte 0
004F9F  3  00                   .byte 0
004FA0  3  02                   .byte 2
004FA1  3  02                   .byte 2
004FA2  3  02                   .byte 2
004FA3  3  02                   .byte 2
004FA4  3  02                   .byte 2
004FA5  3  02                   .byte 2
004FA6  3  02                   .byte 2
004FA7  3  02                   .byte 2
004FA8  3  02                   .byte 2
004FA9  3  02                   .byte 2
004FAA  3  06                   .byte 6
004FAB  3  02                   .byte 2
004FAC  3  00                   .byte 0
004FAD  3  00                   .byte 0
004FAE  3  00                   .byte 0
004FAF  3  00                   .byte 0
004FB0  3  00                   .byte 0
004FB1  3  00                   .byte 0
004FB2  3  00                   .byte 0
004FB3  3  00                   .byte 0
004FB4  3  00                   .byte 0
004FB5  3  00                   .byte 0
004FB6  3  06                   .byte 6
004FB7  3  00                   .byte 0
004FB8  3  00                   .byte 0
004FB9  3  00                   .byte 0
004FBA  3  00                   .byte 0
004FBB  3  00                   .byte 0
004FBC  3  00                   .byte 0
004FBD  3  00                   .byte 0
004FBE  3  00                   .byte 0
004FBF  3  00                   .byte 0
004FC0  3  00                   .byte 0
004FC1  3  02                   .byte 2
004FC2  3  00                   .byte 0
004FC3  3  00                   .byte 0
004FC4  3  00                   .byte 0
004FC5  3  00                   .byte 0
004FC6  3  00                   .byte 0
004FC7  3  00                   .byte 0
004FC8  3  00                   .byte 0
004FC9  3  00                   .byte 0
004FCA  3  00                   .byte 0
004FCB  3  00                   .byte 0
004FCC  3  00                   .byte 0
004FCD  3  00                   .byte 0
004FCE  3  00                   .byte 0
004FCF  3  00                   .byte 0
004FD0  3  00                   .byte 0
004FD1  3  00                   .byte 0
004FD2  3  00                   .byte 0
004FD3  3  00                   .byte 0
004FD4  3  00                   .byte 0
004FD5  3  00                   .byte 0
004FD6  3  00                   .byte 0
004FD7  3  00                   .byte 0
004FD8  3  00                   .byte 0
004FD9  3  00                   .byte 0
004FDA  3  00                   .byte 0
004FDB  3  00                   .byte 0
004FDC  3  00                   .byte 0
004FDD  3  00                   .byte 0
004FDE  3  00                   .byte 0
004FDF  3  00                   .byte 0
004FE0  3  00                   .byte 0
004FE1  3  00                   .byte 0
004FE2  3  00                   .byte 0
004FE3  3  00                   .byte 0
004FE4  3  00                   .byte 0
004FE5  3  00                   .byte 0
004FE6  3  00                   .byte 0
004FE7  3  00                   .byte 0
004FE8  3  00                   .byte 0
004FE9  3  00                   .byte 0
004FEA  3  00                   .byte 0
004FEB  3  00                   .byte 0
004FEC  3  00                   .byte 0
004FED  3  00                   .byte 0
004FEE  3  00                   .byte 0
004FEF  3  00                   .byte 0
004FF0  3  00                   .byte 0
004FF1  3  00                   .byte 0
004FF2  3  00                   .byte 0
004FF3  3  00                   .byte 0
004FF4  3  00                   .byte 0
004FF5  3  00                   .byte 0
004FF6  3  00                   .byte 0
004FF7  3  00                   .byte 0
004FF8  3               .out .sprintf("BLOCKS SIZE = %d", (* - chgfx))
004FF8  3               
004FF8  3               sprgfx:
004FF8  3  01 C0 02 A2          .byte 1,192,2,162,3,230,112,14,59,228,7,112,13,216,26,172,23,116,26,172,29,220,26,172,15,120,22,183,57,142,97,0
004FFC  3  03 E6 70 0E  
005000  3  3B E4 07 70  
005018  3  00 70 80 A8          .byte 0,112,128,168,128,249,156,3,14,249,1,220,3,118,6,171,5,221,6,171,7,119,6,171,3,222,197,173,142,99,24,64
00501C  3  80 F9 9C 03  
005020  3  0E F9 01 DC  
005038  3  00 1C 20 2A          .byte 0,28,32,42,96,62,231,0,67,190,0,119,128,221,193,170,65,119,193,170,193,221,193,170,128,247,113,107,227,152,6,16
00503C  3  60 3E E7 00  
005040  3  43 BE 00 77  
005058  3  00 07 88 0A          .byte 0,7,136,10,152,15,57,192,144,239,192,29,96,55,176,106,208,93,176,106,112,119,176,106,224,61,220,90,56,230,1,132
00505C  3  98 0F 39 C0  
005060  3  90 EF C0 1D  
005078  3  01 C0 22 A0          .byte 1,192,34,160,51,227,56,14,19,228,7,112,13,216,26,172,23,116,26,172,29,220,26,172,15,122,118,183,57,195,0,129
00507C  3  33 E3 38 0E  
005080  3  13 E4 07 70  
005098  3  00 70 08 A8          .byte 0,112,8,168,204,248,142,3,4,249,1,220,3,118,6,171,5,221,6,171,7,119,6,171,131,222,221,173,206,112,64,32
00509C  3  CC F8 8E 03  
0050A0  3  04 F9 01 DC  
0050B8  3  00 1C 02 2A          .byte 0,28,2,42,51,62,227,128,65,62,0,119,128,221,193,170,65,119,193,170,193,221,193,170,160,247,119,107,51,156,16,8
0050BC  3  33 3E E3 80  
0050C0  3  41 3E 00 77  
0050D8  3  00 07 80 8A          .byte 0,7,128,138,140,207,56,224,144,79,192,29,96,55,176,106,208,93,176,106,112,119,176,106,232,61,221,218,12,231,4,2
0050DC  3  8C CF 38 E0  
0050E0  3  90 4F C0 1D  
0050F8  3  01 C0 02 A0          .byte 1,192,2,160,99,224,56,14,19,231,7,112,13,216,26,172,23,116,26,172,29,220,26,172,47,120,118,180,96,206,64,67
0050FC  3  63 E0 38 0E  
005100  3  13 E7 07 70  
005118  3  00 70 00 A8          .byte 0,112,0,168,24,248,142,3,196,249,1,220,3,118,6,171,5,221,6,171,7,119,6,171,11,222,29,173,152,51,208,16
00511C  3  18 F8 8E 03  
005120  3  C4 F9 01 DC  
005138  3  00 1C 00 2A          .byte 0,28,0,42,6,62,227,128,113,62,0,119,128,221,193,170,65,119,193,170,193,221,193,170,130,247,71,107,230,12,52,4
00513C  3  06 3E E3 80  
005140  3  71 3E 00 77  
005158  3  00 07 80 0A          .byte 0,7,128,10,129,143,56,224,156,79,192,29,96,55,176,106,208,93,176,106,112,119,176,106,224,189,209,218,57,131,13,1
00515C  3  81 8F 38 E0  
005160  3  9C 4F C0 1D  
005178  3  60 80 39 CE          .byte 96,128,57,206,22,183,15,120,26,172,29,220,26,172,23,116,26,172,13,216,7,112,59,228,112,14,3,230,2,162,1,192
00517C  3  16 B7 0F 78  
005180  3  1A AC 1D DC  
005198  3  18 20 8E 73          .byte 24,32,142,115,197,173,3,222,6,171,7,119,6,171,5,221,6,171,3,118,1,220,14,249,156,3,128,249,128,168,0,112
00519C  3  C5 AD 03 DE  
0051A0  3  06 AB 07 77  
0051B8  3  06 08 E3 9C          .byte 6,8,227,156,113,107,128,247,193,170,193,221,193,170,65,119,193,170,128,221,0,119,67,190,231,0,96,62,32,42,0,28
0051BC  3  71 6B 80 F7  
0051C0  3  C1 AA C1 DD  
0051D8  3  01 82 38 E7          .byte 1,130,56,231,220,90,224,61,176,106,112,119,176,106,208,93,176,106,96,55,192,29,144,239,57,192,152,15,136,10,0,7
0051DC  3  DC 5A E0 3D  
0051E0  3  B0 6A 70 77  
0051F8  3  00 41 38 C3          .byte 0,65,56,195,118,183,15,122,26,172,29,220,26,172,23,116,26,172,13,216,7,112,19,228,56,14,51,227,34,160,1,192
0051FC  3  76 B7 0F 7A  
005200  3  1A AC 1D DC  
005218  3  40 10 CE 30          .byte 64,16,206,48,221,173,131,222,6,171,7,119,6,171,5,221,6,171,3,118,1,220,4,249,142,3,204,248,8,168,0,112
00521C  3  DD AD 83 DE  
005220  3  06 AB 07 77  
005238  3  10 04 33 8C          .byte 16,4,51,140,119,107,160,247,193,170,193,221,193,170,65,119,193,170,128,221,0,119,65,62,227,128,51,62,2,42,0,28
00523C  3  77 6B A0 F7  
005240  3  C1 AA C1 DD  
005258  3  04 01 0C E3          .byte 4,1,12,227,221,218,232,61,176,106,112,119,176,106,208,93,176,106,96,55,192,29,144,79,56,224,140,207,128,138,0,7
00525C  3  DD DA E8 3D  
005260  3  B0 6A 70 77  
005278  3  41 03 61 8E          .byte 65,3,97,142,118,180,47,120,26,172,29,220,26,172,23,116,26,172,13,216,7,112,19,231,56,14,99,224,2,160,1,192
00527C  3  76 B4 2F 78  
005280  3  1A AC 1D DC  
005298  3  D0 40 98 63          .byte 208,64,152,99,29,173,11,222,6,171,7,119,6,171,5,221,6,171,3,118,1,220,196,249,142,3,24,248,0,168,0,112
00529C  3  1D AD 0B DE  
0052A0  3  06 AB 07 77  
0052B8  3  34 10 E6 18          .byte 52,16,230,24,71,107,130,247,193,170,193,221,193,170,65,119,193,170,128,221,0,119,113,62,227,128,6,62,0,42,0,28
0052BC  3  47 6B 82 F7  
0052C0  3  C1 AA C1 DD  
0052D8  3  0D 04 39 86          .byte 13,4,57,134,209,218,224,189,176,106,112,119,176,106,208,93,176,106,96,55,192,29,156,79,56,224,129,143,128,10,0,7
0052DC  3  D1 DA E0 BD  
0052E0  3  B0 6A 70 77  
0052F8  3  00 00 80 08          .byte 0,0,128,8,192,24,111,152,94,208,53,96,59,182,213,117,110,215,21,117,59,182,53,96,94,200,111,156,96,14,32,0
0052FC  3  C0 18 6F 98  
005300  3  5E D0 35 60  
005318  3  00 00 20 02          .byte 0,0,32,2,48,6,27,230,23,180,13,88,142,237,117,93,219,181,69,93,142,237,13,88,23,178,27,231,152,3,8,0
00531C  3  30 06 1B E6  
005320  3  17 B4 0D 58  
005338  3  00 00 88 00          .byte 0,0,136,0,140,1,134,249,5,237,3,86,99,187,93,87,118,237,81,87,99,187,3,86,133,236,198,249,230,0,2,0
00533C  3  8C 01 86 F9  
005340  3  05 ED 03 56  
005358  3  00 00 22 00          .byte 0,0,34,0,99,0,97,190,65,123,128,213,216,238,215,85,93,187,212,85,216,238,128,213,33,123,113,190,57,128,0,128
00535C  3  63 00 61 BE  
005360  3  41 7B 80 D5  
005378  3  00 00 20 00          .byte 0,0,32,0,96,14,111,156,94,200,53,96,59,182,85,117,238,215,85,117,59,182,53,96,30,200,47,152,112,12,224,4
00537C  3  60 0E 6F 9C  
005380  3  5E C8 35 60  
005398  3  00 00 08 00          .byte 0,0,8,0,152,3,27,231,23,178,13,88,142,237,85,93,251,181,85,93,142,237,13,88,7,178,11,230,28,3,56,1
00539C  3  98 03 1B E7  
0053A0  3  17 B2 0D 58  
0053B8  3  00 00 02 00          .byte 0,0,2,0,230,0,198,249,133,236,3,86,99,187,85,87,126,237,85,87,99,187,3,86,129,236,130,249,199,0,78,0
0053BC  3  E6 00 C6 F9  
0053C0  3  85 EC 03 56  
0053D8  3  00 00 00 80          .byte 0,0,0,128,57,128,113,190,33,123,128,213,216,238,213,85,95,187,213,85,216,238,128,213,32,123,96,190,49,192,19,128
0053DC  3  39 80 71 BE  
0053E0  3  21 7B 80 D5  
0053F8  3  00 00 E0 04          .byte 0,0,224,4,112,12,47,152,30,200,53,96,59,182,21,117,110,215,213,117,59,182,53,96,94,200,111,152,192,24,128,16
0053FC  3  70 0C 2F 98  
005400  3  1E C8 35 60  
005418  3  00 00 38 01          .byte 0,0,56,1,28,3,11,230,7,178,13,88,142,237,69,93,219,181,117,93,142,237,13,88,23,178,27,230,48,6,32,4
00541C  3  1C 03 0B E6  
005420  3  07 B2 0D 58  
005438  3  00 00 4E 00          .byte 0,0,78,0,199,0,130,249,129,236,3,86,99,187,81,87,118,237,93,87,99,187,3,86,133,236,134,249,140,1,8,1
00543C  3  C7 00 82 F9  
005440  3  81 EC 03 56  
005458  3  00 00 13 80          .byte 0,0,19,128,49,192,96,190,32,123,128,213,216,238,212,85,93,187,215,85,216,238,128,213,33,123,97,190,99,0,66,0
00545C  3  31 C0 60 BE  
005460  3  20 7B 80 D5  
005478  3  00 00 10 01          .byte 0,0,16,1,24,3,25,246,11,122,6,172,109,220,174,171,235,118,174,168,109,220,6,172,19,122,57,246,112,6,0,4
00547C  3  18 03 19 F6  
005480  3  0B 7A 06 AC  
005498  3  00 00 44 00          .byte 0,0,68,0,198,0,134,125,130,222,1,171,27,119,235,170,186,221,43,170,27,119,1,171,132,222,142,125,156,1,0,1
00549C  3  C6 00 86 7D  
0054A0  3  82 DE 01 AB  
0054B8  3  00 00 11 00          .byte 0,0,17,0,49,128,97,159,160,183,192,106,198,221,186,234,110,183,138,234,198,221,192,106,161,55,99,159,103,0,64,0
0054BC  3  31 80 61 9F  
0054C0  3  A0 B7 C0 6A  
0054D8  3  00 00 04 40          .byte 0,0,4,64,12,96,216,103,232,45,176,26,113,183,174,186,219,173,162,186,113,183,176,26,232,77,216,231,25,192,16,0
0054DC  3  0C 60 D8 67  
0054E0  3  E8 2D B0 1A  
0054F8  3  00 00 00 04          .byte 0,0,0,4,112,6,57,246,19,122,6,172,109,220,174,170,235,119,174,170,109,220,6,172,19,120,25,244,48,14,32,7
0054FC  3  70 06 39 F6  
005500  3  13 7A 06 AC  
005518  3  00 00 00 01          .byte 0,0,0,1,156,1,142,125,132,222,1,171,27,119,171,170,250,221,171,170,27,119,1,171,4,222,6,125,140,3,200,1
00551C  3  9C 01 8E 7D  
005520  3  84 DE 01 AB  
005538  3  00 00 40 00          .byte 0,0,64,0,103,0,99,159,161,55,192,106,198,221,170,234,126,183,170,234,198,221,192,106,129,55,65,159,227,0,114,0
00553C  3  67 00 63 9F  
005540  3  A1 37 C0 6A  
005558  3  00 00 10 00          .byte 0,0,16,0,25,192,216,231,232,77,176,26,113,183,170,186,223,173,170,186,113,183,176,26,224,77,208,103,56,192,28,128
00555C  3  19 C0 D8 E7  
005560  3  E8 4D B0 1A  
005578  3  00 00 20 07          .byte 0,0,32,7,48,14,25,244,19,120,6,172,109,220,174,168,235,118,174,171,109,220,6,172,19,122,25,246,24,3,8,1
00557C  3  30 0E 19 F4  
005580  3  13 78 06 AC  
005598  3  00 00 C8 01          .byte 0,0,200,1,140,3,6,125,4,222,1,171,27,119,43,170,186,221,235,170,27,119,1,171,132,222,134,125,198,0,66,0
00559C  3  8C 03 06 7D  
0055A0  3  04 DE 01 AB  
0055B8  3  00 00 72 00          .byte 0,0,114,0,227,0,65,159,129,55,192,106,198,221,138,234,110,183,186,234,198,221,192,106,161,55,97,159,49,128,16,128
0055BC  3  E3 00 41 9F  
0055C0  3  81 37 C0 6A  
0055D8  3  00 00 1C 80          .byte 0,0,28,128,56,192,208,103,224,77,176,26,113,183,162,186,219,173,174,186,113,183,176,26,232,77,216,103,12,96,4,32
0055DC  3  38 C0 D0 67  
0055E0  3  E0 4D B0 1A  
0055F8  3  01 C0 02 A2          .byte 1,192,2,162,3,230,112,14,59,228,5,208,15,120,28,28,30,188,22,52,29,92,31,252,15,120,22,183,57,142,97,0
0055FC  3  03 E6 70 0E  
005600  3  3B E4 05 D0  
005618  3  00 70 80 A8          .byte 0,112,128,168,128,249,156,3,14,249,1,116,3,222,7,7,7,175,5,141,7,87,7,255,3,222,197,173,142,99,24,64
00561C  3  80 F9 9C 03  
005620  3  0E F9 01 74  
005638  3  00 1C 20 2A          .byte 0,28,32,42,96,62,231,0,67,190,0,93,128,247,193,193,193,235,65,99,193,213,193,255,128,247,113,107,227,152,6,16
00563C  3  60 3E E7 00  
005640  3  43 BE 00 5D  
005658  3  00 07 88 0A          .byte 0,7,136,10,152,15,57,192,144,239,64,23,224,61,112,112,240,122,208,88,112,117,240,127,224,61,220,90,56,230,1,132
00565C  3  98 0F 39 C0  
005660  3  90 EF 40 17  
005678  3  01 C0 22 A0          .byte 1,192,34,160,51,227,56,14,19,228,5,208,15,120,30,60,28,156,22,52,29,92,31,252,15,122,118,183,57,195,0,129
00567C  3  33 E3 38 0E  
005680  3  13 E4 05 D0  
005698  3  00 70 08 A8          .byte 0,112,8,168,204,248,142,3,4,249,1,116,3,222,7,143,7,39,5,141,7,87,7,255,131,222,221,173,206,112,64,32
00569C  3  CC F8 8E 03  
0056A0  3  04 F9 01 74  
0056B8  3  00 1C 02 2A          .byte 0,28,2,42,51,62,227,128,65,62,0,93,128,247,193,227,193,201,65,99,193,213,193,255,160,247,119,107,51,156,16,8
0056BC  3  33 3E E3 80  
0056C0  3  41 3E 00 5D  
0056D8  3  00 07 80 8A          .byte 0,7,128,138,140,207,56,224,144,79,64,23,224,61,240,120,112,114,208,88,112,117,240,127,232,61,221,218,12,231,4,2
0056DC  3  8C CF 38 E0  
0056E0  3  90 4F 40 17  
0056F8  3  01 C0 02 A0          .byte 1,192,2,160,99,224,56,14,19,231,5,208,15,120,28,28,30,188,22,52,29,92,31,252,47,120,118,180,96,206,64,67
0056FC  3  63 E0 38 0E  
005700  3  13 E7 05 D0  
005718  3  00 70 00 A8          .byte 0,112,0,168,24,248,142,3,196,249,1,116,3,222,7,7,7,175,5,141,7,87,7,255,11,222,29,173,152,51,208,16
00571C  3  18 F8 8E 03  
005720  3  C4 F9 01 74  
005738  3  00 1C 00 2A          .byte 0,28,0,42,6,62,227,128,113,62,0,93,128,247,193,193,193,235,65,99,193,213,193,255,130,247,71,107,230,12,52,4
00573C  3  06 3E E3 80  
005740  3  71 3E 00 5D  
005758  3  00 07 80 0A          .byte 0,7,128,10,129,143,56,224,156,79,64,23,224,61,112,112,240,122,208,88,112,117,240,127,224,189,209,218,57,131,13,1
00575C  3  81 8F 38 E0  
005760  3  9C 4F 40 17  
005778  3  60 80 39 CE          .byte 96,128,57,206,22,183,15,120,31,252,29,92,22,52,30,188,28,28,15,120,5,208,59,228,112,14,3,230,2,162,1,192
00577C  3  16 B7 0F 78  
005780  3  1F FC 1D 5C  
005798  3  18 20 8E 73          .byte 24,32,142,115,197,173,3,222,7,255,7,87,5,141,7,175,7,7,3,222,1,116,14,249,156,3,128,249,128,168,0,112
00579C  3  C5 AD 03 DE  
0057A0  3  07 FF 07 57  
0057B8  3  06 08 E3 9C          .byte 6,8,227,156,113,107,128,247,193,255,193,213,65,99,193,235,193,193,128,247,0,93,67,190,231,0,96,62,32,42,0,28
0057BC  3  71 6B 80 F7  
0057C0  3  C1 FF C1 D5  
0057D8  3  01 82 38 E7          .byte 1,130,56,231,220,90,224,61,240,127,112,117,208,88,240,122,112,112,224,61,64,23,144,239,57,192,152,15,136,10,0,7
0057DC  3  DC 5A E0 3D  
0057E0  3  F0 7F 70 75  
0057F8  3  00 41 38 C3          .byte 0,65,56,195,118,183,15,122,31,252,29,92,22,52,30,188,28,28,15,120,5,208,19,228,56,14,51,227,34,160,1,192
0057FC  3  76 B7 0F 7A  
005800  3  1F FC 1D 5C  
005818  3  40 10 CE 30          .byte 64,16,206,48,221,173,131,222,7,255,7,87,5,141,7,175,7,7,3,222,1,116,4,249,142,3,204,248,8,168,0,112
00581C  3  DD AD 83 DE  
005820  3  07 FF 07 57  
005838  3  10 04 33 8C          .byte 16,4,51,140,119,107,160,247,193,255,193,213,65,99,193,235,193,193,128,247,0,93,65,62,227,128,51,62,2,42,0,28
00583C  3  77 6B A0 F7  
005840  3  C1 FF C1 D5  
005858  3  04 01 0C E3          .byte 4,1,12,227,221,218,232,61,240,127,112,117,208,88,240,122,112,112,224,61,64,23,144,79,56,224,140,207,128,138,0,7
00585C  3  DD DA E8 3D  
005860  3  F0 7F 70 75  
005878  3  41 03 61 8E          .byte 65,3,97,142,118,180,47,120,31,252,29,92,22,52,28,156,30,60,15,120,5,208,19,231,56,14,99,224,2,160,1,192
00587C  3  76 B4 2F 78  
005880  3  1F FC 1D 5C  
005898  3  D0 40 98 63          .byte 208,64,152,99,29,173,11,222,7,255,7,87,5,141,7,39,7,143,3,222,1,116,196,249,142,3,24,248,0,168,0,112
00589C  3  1D AD 0B DE  
0058A0  3  07 FF 07 57  
0058B8  3  34 10 E6 18          .byte 52,16,230,24,71,107,130,247,193,255,193,213,65,99,193,201,193,227,128,247,0,93,113,62,227,128,6,62,0,42,0,28
0058BC  3  47 6B 82 F7  
0058C0  3  C1 FF C1 D5  
0058D8  3  0D 04 39 86          .byte 13,4,57,134,209,218,224,189,240,127,112,117,208,88,112,114,240,120,224,61,64,23,156,79,56,224,129,143,128,10,0,7
0058DC  3  D1 DA E0 BD  
0058E0  3  F0 7F 70 75  
0058F8  3  00 00 80 08          .byte 0,0,128,8,192,24,111,152,95,208,63,224,59,86,220,117,105,55,28,117,59,86,63,224,95,200,111,156,96,14,32,0
0058FC  3  C0 18 6F 98  
005900  3  5F D0 3F E0  
005918  3  00 00 20 02          .byte 0,0,32,2,48,6,27,230,23,244,15,248,142,213,119,29,218,77,71,29,142,213,15,248,23,242,27,231,152,3,8,0
00591C  3  30 06 1B E6  
005920  3  17 F4 0F F8  
005938  3  00 00 88 00          .byte 0,0,136,0,140,1,134,249,5,253,3,254,99,181,93,199,118,147,81,199,99,181,3,254,133,252,198,249,230,0,2,0
00593C  3  8C 01 86 F9  
005940  3  05 FD 03 FE  
005958  3  00 00 22 00          .byte 0,0,34,0,99,0,97,190,65,127,128,255,88,237,215,113,221,164,212,113,88,237,128,255,33,127,113,190,57,128,0,128
00595C  3  63 00 61 BE  
005960  3  41 7F 80 FF  
005978  3  10 00 30 00          .byte 16,0,48,0,48,14,47,156,31,200,63,224,58,214,92,117,233,55,92,117,58,214,63,224,31,200,47,152,112,12,224,4
00597C  3  30 0E 2F 9C  
005980  3  1F C8 3F E0  
005998  3  04 00 0C 00          .byte 4,0,12,0,140,3,11,231,7,242,15,248,142,181,87,29,250,77,87,29,142,181,15,248,7,242,11,230,28,3,56,1
00599C  3  8C 03 0B E7  
0059A0  3  07 F2 0F F8  
0059B8  3  01 00 03 00          .byte 1,0,3,0,227,0,194,249,129,252,3,254,99,173,85,199,126,147,85,199,99,173,3,254,129,252,130,249,199,0,78,0
0059BC  3  E3 00 C2 F9  
0059C0  3  81 FC 03 FE  
0059D8  3  00 40 00 C0          .byte 0,64,0,192,56,192,112,190,32,127,128,255,88,235,213,113,223,164,213,113,88,235,128,255,32,127,96,190,49,192,19,128
0059DC  3  38 C0 70 BE  
0059E0  3  20 7F 80 FF  
0059F8  3  00 00 E0 04          .byte 0,0,224,4,112,12,47,152,31,200,63,224,59,86,28,117,105,55,220,117,59,86,63,224,95,200,111,152,192,24,128,16
0059FC  3  70 0C 2F 98  
005A00  3  1F C8 3F E0  
005A18  3  00 00 38 01          .byte 0,0,56,1,28,3,11,230,7,242,15,248,142,213,71,29,218,77,119,29,142,213,15,248,23,242,27,230,48,6,32,4
005A1C  3  1C 03 0B E6  
005A20  3  07 F2 0F F8  
005A38  3  00 00 4E 00          .byte 0,0,78,0,199,0,130,249,129,252,3,254,99,181,81,199,118,147,93,199,99,181,3,254,133,252,134,249,140,1,8,1
005A3C  3  C7 00 82 F9  
005A40  3  81 FC 03 FE  
005A58  3  00 00 13 80          .byte 0,0,19,128,49,192,96,190,32,127,128,255,88,237,212,113,221,164,215,113,88,237,128,255,33,127,97,190,99,0,66,0
005A5C  3  31 C0 60 BE  
005A60  3  20 7F 80 FF  
005A78  3  00 00 10 01          .byte 0,0,16,1,24,3,25,246,11,250,7,252,106,220,174,59,236,150,174,56,106,220,7,252,19,250,57,246,112,6,0,4
005A7C  3  18 03 19 F6  
005A80  3  0B FA 07 FC  
005A98  3  00 00 44 00          .byte 0,0,68,0,198,0,134,125,130,254,1,255,26,183,235,142,187,37,43,142,26,183,1,255,132,254,142,125,156,1,0,1
005A9C  3  C6 00 86 7D  
005AA0  3  82 FE 01 FF  
005AB8  3  00 00 11 00          .byte 0,0,17,0,49,128,97,159,160,191,192,127,198,173,186,227,110,201,138,227,198,173,192,127,161,63,99,159,103,0,64,0
005ABC  3  31 80 61 9F  
005AC0  3  A0 BF C0 7F  
005AD8  3  00 00 04 40          .byte 0,0,4,64,12,96,216,103,232,47,240,31,113,171,238,184,91,178,226,184,113,171,240,31,232,79,216,231,25,192,16,0
005ADC  3  0C 60 D8 67  
005AE0  3  E8 2F F0 1F  
005AF8  3  00 08 00 0C          .byte 0,8,0,12,112,12,57,244,19,248,7,252,107,92,174,58,236,151,174,58,107,92,7,252,19,248,25,244,48,14,32,7
005AFC  3  70 0C 39 F4  
005B00  3  13 F8 07 FC  
005B18  3  00 02 00 03          .byte 0,2,0,3,28,3,14,125,4,254,1,255,26,215,171,142,251,37,171,142,26,215,1,255,4,254,6,125,140,3,200,1
005B1C  3  1C 03 0E 7D  
005B20  3  04 FE 01 FF  
005B38  3  80 00 C0 00          .byte 128,0,192,0,199,0,67,159,129,63,192,127,198,181,170,227,126,201,170,227,198,181,192,127,129,63,65,159,227,0,114,0
005B3C  3  C7 00 43 9F  
005B40  3  81 3F C0 7F  
005B58  3  20 00 30 00          .byte 32,0,48,0,49,192,208,231,224,79,240,31,113,173,234,184,95,178,234,184,113,173,240,31,224,79,208,103,56,192,28,128
005B5C  3  31 C0 D0 E7  
005B60  3  E0 4F F0 1F  
005B78  3  00 00 20 07          .byte 0,0,32,7,48,14,25,244,19,248,7,252,106,220,174,56,236,150,174,59,106,220,7,252,19,250,25,246,24,3,8,1
005B7C  3  30 0E 19 F4  
005B80  3  13 F8 07 FC  
005B98  3  00 00 C8 01          .byte 0,0,200,1,140,3,6,125,4,254,1,255,26,183,43,142,187,37,235,142,26,183,1,255,132,254,134,125,198,0,66,0
005B9C  3  8C 03 06 7D  
005BA0  3  04 FE 01 FF  
005BB8  3  00 00 72 00          .byte 0,0,114,0,227,0,65,159,129,63,192,127,198,173,138,227,110,201,186,227,198,173,192,127,161,63,97,159,49,128,16,128
005BBC  3  E3 00 41 9F  
005BC0  3  81 3F C0 7F  
005BD8  3  00 00 1C 80          .byte 0,0,28,128,56,192,208,103,224,79,240,31,113,171,226,184,91,178,238,184,113,171,240,31,232,79,216,103,12,96,4,32
005BDC  3  38 C0 D0 67  
005BE0  3  E0 4F F0 1F  
005BF8  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,1,0,5,64,3,128,14,224,3,128,5,64,1,0,0,0,0,0,0,0,0,0,0,0
005BFC  3  00 00 00 00  
005C00  3  01 00 05 40  
005C18  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,64,1,80,0,224,3,184,0,224,1,80,0,64,0,0,0,0,0,0,0,0,0,0
005C1C  3  00 00 00 00  
005C20  3  00 40 01 50  
005C38  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,16,0,84,0,56,0,238,0,56,0,84,0,16,0,0,0,0,0,0,0,0,0,0
005C3C  3  00 00 00 00  
005C40  3  00 10 00 54  
005C58  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,4,0,21,0,14,128,59,0,14,0,21,0,4,0,0,0,0,0,0,0,0,0,0
005C5C  3  00 00 00 00  
005C60  3  00 04 00 15  
005C78  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,1,0,5,64,3,128,15,224,3,128,5,64,1,0,0,0,0,0,0,0,0,0,0,0
005C7C  3  00 00 00 00  
005C80  3  01 00 05 40  
005C98  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,64,1,80,0,224,3,248,0,224,1,80,0,64,0,0,0,0,0,0,0,0,0,0
005C9C  3  00 00 00 00  
005CA0  3  00 40 01 50  
005CB8  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,16,0,84,0,56,0,254,0,56,0,84,0,16,0,0,0,0,0,0,0,0,0,0
005CBC  3  00 00 00 00  
005CC0  3  00 10 00 54  
005CD8  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,4,0,21,0,14,128,63,0,14,0,21,0,4,0,0,0,0,0,0,0,0,0,0
005CDC  3  00 00 00 00  
005CE0  3  00 04 00 15  
005CF8  3  00 00 00 00          .byte 0,0,0,0,3,96,54,182,75,105,12,24,15,248,15,248,55,246,95,253,31,252,23,244,11,232,13,208,3,96,0,0
005CFC  3  03 60 36 B6  
005D00  3  4B 69 0C 18  
005D18  3  00 00 00 00          .byte 0,0,0,0,0,216,141,173,82,218,3,6,3,254,3,254,141,253,87,255,7,255,5,253,2,250,3,116,0,216,0,0
005D1C  3  00 D8 8D AD  
005D20  3  52 DA 03 06  
005D38  3  00 00 00 00          .byte 0,0,0,0,0,54,99,107,148,182,128,193,128,255,128,255,99,127,213,255,193,255,65,127,128,190,0,221,0,54,0,0
005D3C  3  00 36 63 6B  
005D40  3  94 B6 80 C1  
005D58  3  00 00 00 00          .byte 0,0,0,0,128,13,216,218,165,45,96,48,224,63,224,63,216,223,245,127,240,127,208,95,160,47,64,55,128,13,0,0
005D5C  3  80 0D D8 DA  
005D60  3  A5 2D 60 30  
005D78  3  00 00 00 00          .byte 0,0,0,0,3,96,7,240,11,104,12,24,63,254,79,249,87,245,31,252,31,252,23,244,11,236,21,210,19,98,48,3
005D7C  3  03 60 07 F0  
005D80  3  0B 68 0C 18  
005D98  3  00 00 00 00          .byte 0,0,0,0,0,216,1,252,2,218,3,6,143,255,83,254,85,253,7,255,7,255,5,253,2,251,133,116,132,216,204,0
005D9C  3  00 D8 01 FC  
005DA0  3  02 DA 03 06  
005DB8  3  00 00 00 00          .byte 0,0,0,0,0,54,0,127,128,182,128,193,227,255,148,255,85,127,193,255,193,255,65,127,192,190,33,93,33,54,51,0
005DBC  3  00 36 00 7F  
005DC0  3  80 B6 80 C1  
005DD8  3  00 00 00 00          .byte 0,0,0,0,128,13,192,31,160,45,96,48,248,255,229,63,213,95,240,127,240,127,208,95,176,47,72,87,136,77,12,192
005DDC  3  80 0D C0 1F  
005DE0  3  A0 2D 60 30  
005DF8  3  00 00 00 00          .byte 0,0,0,0,99,99,22,180,11,104,12,24,15,248,15,248,23,244,31,252,31,252,55,246,75,233,77,209,35,98,0,0
005DFC  3  63 63 16 B4  
005E00  3  0B 68 0C 18  
005E18  3  00 00 00 00          .byte 0,0,0,0,216,216,5,173,2,218,3,6,3,254,3,254,5,253,7,255,7,255,141,253,82,250,83,116,136,216,0,0
005E1C  3  D8 D8 05 AD  
005E20  3  02 DA 03 06  
005E38  3  00 00 00 00          .byte 0,0,0,0,54,54,65,107,128,182,128,193,128,255,128,255,65,127,193,255,193,255,99,127,148,190,20,221,34,54,0,0
005E3C  3  36 36 41 6B  
005E40  3  80 B6 80 C1  
005E58  3  00 00 00 00          .byte 0,0,0,0,141,141,208,90,160,45,96,48,224,63,224,63,208,95,240,127,240,127,216,223,165,47,69,55,136,141,0,0
005E5C  3  8D 8D D0 5A  
005E60  3  A0 2D 60 30  
005E78  3  00 00 03 60          .byte 0,0,3,96,5,208,11,232,23,244,31,252,95,253,55,246,31,252,15,248,12,24,75,105,54,182,3,96,0,0,0,0
005E7C  3  05 D0 0B E8  
005E80  3  17 F4 1F FC  
005E98  3  00 00 00 D8          .byte 0,0,0,216,1,116,2,250,5,253,7,255,87,255,141,253,7,255,3,254,3,6,82,218,141,173,0,216,0,0,0,0
005E9C  3  01 74 02 FA  
005EA0  3  05 FD 07 FF  
005EB8  3  00 00 00 36          .byte 0,0,0,54,0,93,128,190,65,127,193,255,213,255,99,127,193,255,128,255,128,193,148,182,99,107,0,54,0,0,0,0
005EBC  3  00 5D 80 BE  
005EC0  3  41 7F C1 FF  
005ED8  3  00 00 80 0D          .byte 0,0,128,13,64,23,160,47,208,95,240,127,245,127,216,223,240,127,224,63,96,48,165,45,216,218,128,13,0,0,0,0
005EDC  3  40 17 A0 2F  
005EE0  3  D0 5F F0 7F  
005EF8  3  00 00 43 61          .byte 0,0,67,97,69,209,43,234,23,244,31,252,31,252,87,245,95,253,47,250,12,24,11,104,7,240,3,96,0,0,0,0
005EFC  3  45 D1 2B EA  
005F00  3  17 F4 1F FC  
005F18  3  00 00 50 D8          .byte 0,0,80,216,81,116,138,250,5,253,7,255,7,255,85,253,87,255,139,254,3,6,2,218,1,252,0,216,0,0,0,0
005F1C  3  51 74 8A FA  
005F20  3  05 FD 07 FF  
005F38  3  00 00 14 36          .byte 0,0,20,54,20,93,162,190,65,127,193,255,193,255,85,127,213,255,162,255,128,193,128,182,0,127,0,54,0,0,0,0
005F3C  3  14 5D A2 BE  
005F40  3  41 7F C1 FF  
005F58  3  00 00 85 0D          .byte 0,0,133,13,69,23,168,175,208,95,240,127,240,127,213,95,245,127,232,191,96,48,160,45,192,31,128,13,0,0,0,0
005F5C  3  45 17 A8 AF  
005F60  3  D0 5F F0 7F  
005F78  3  00 00 23 62          .byte 0,0,35,98,69,209,75,233,55,246,31,252,31,252,23,244,31,252,15,248,12,24,11,104,22,180,99,99,0,0,0,0
005F7C  3  45 D1 4B E9  
005F80  3  37 F6 1F FC  
005F98  3  00 00 88 D8          .byte 0,0,136,216,81,116,82,250,141,253,7,255,7,255,5,253,7,255,3,254,3,6,2,218,5,173,216,216,0,0,0,0
005F9C  3  51 74 52 FA  
005FA0  3  8D FD 07 FF  
005FB8  3  00 00 22 36          .byte 0,0,34,54,20,93,148,190,99,127,193,255,193,255,65,127,193,255,128,255,128,193,128,182,65,107,54,54,0,0,0,0
005FBC  3  14 5D 94 BE  
005FC0  3  63 7F C1 FF  
005FD8  3  00 00 88 8D          .byte 0,0,136,141,69,23,165,47,216,223,240,127,240,127,208,95,240,127,224,63,96,48,160,45,208,90,141,141,0,0,0,0
005FDC  3  45 17 A5 2F  
005FE0  3  D8 DF F0 7F  
005FF8  3  00 00 04 10          .byte 0,0,4,16,2,8,15,8,22,240,47,232,95,220,127,212,63,200,127,212,95,220,47,232,22,240,15,8,2,8,4,16
005FFC  3  02 08 0F 08  
006000  3  16 F0 2F E8  
006018  3  00 00 01 04          .byte 0,0,1,4,0,130,3,194,5,188,11,250,23,247,31,245,15,242,31,245,23,247,11,250,5,188,3,194,0,130,1,4
00601C  3  00 82 03 C2  
006020  3  05 BC 0B FA  
006038  3  00 00 00 41          .byte 0,0,0,65,128,32,128,240,1,111,130,254,197,253,71,253,131,252,71,253,197,253,130,254,1,111,128,240,128,32,0,65
00603C  3  80 20 80 F0  
006040  3  01 6F 82 FE  
006058  3  00 00 40 10          .byte 0,0,64,16,32,8,32,60,192,91,160,191,113,127,81,255,32,255,81,255,113,127,160,191,192,91,32,60,32,8,64,16
00605C  3  20 08 20 3C  
006060  3  C0 5B A0 BF  
006078  3  00 00 03 00          .byte 0,0,3,0,192,128,47,0,22,240,47,232,95,220,127,220,63,200,127,220,95,220,47,232,22,240,47,0,192,128,3,0
00607C  3  C0 80 2F 00  
006080  3  16 F0 2F E8  
006098  3  00 00 00 C0          .byte 0,0,0,192,48,32,11,192,5,188,11,250,23,247,31,247,15,242,31,247,23,247,11,250,5,188,11,192,48,32,0,192
00609C  3  30 20 0B C0  
0060A0  3  05 BC 0B FA  
0060B8  3  00 00 00 30          .byte 0,0,0,48,12,8,2,240,1,111,130,254,197,253,199,253,131,252,199,253,197,253,130,254,1,111,2,240,12,8,0,48
0060BC  3  0C 08 02 F0  
0060C0  3  01 6F 82 FE  
0060D8  3  00 00 00 0C          .byte 0,0,0,12,3,2,0,188,192,91,160,191,113,127,113,255,32,255,113,255,113,127,160,191,192,91,0,188,3,2,0,12
0060DC  3  03 02 00 BC  
0060E0  3  C0 5B A0 BF  
0060F8  3  00 00 30 04          .byte 0,0,48,4,72,4,15,8,22,240,47,232,95,220,127,212,63,200,127,212,95,220,47,232,22,240,15,8,72,4,48,4
0060FC  3  48 04 0F 08  
006100  3  16 F0 2F E8  
006118  3  00 00 0C 01          .byte 0,0,12,1,18,1,3,194,5,188,11,250,23,247,31,245,15,242,31,245,23,247,11,250,5,188,3,194,18,1,12,1
00611C  3  12 01 03 C2  
006120  3  05 BC 0B FA  
006138  3  00 00 43 00          .byte 0,0,67,0,68,128,128,240,1,111,130,254,197,253,71,253,131,252,71,253,197,253,130,254,1,111,128,240,68,128,67,0
00613C  3  44 80 80 F0  
006140  3  01 6F 82 FE  
006158  3  00 00 10 C0          .byte 0,0,16,192,17,32,32,60,192,91,160,191,113,127,81,255,32,255,81,255,113,127,160,191,192,91,32,60,17,32,16,192
00615C  3  11 20 20 3C  
006160  3  C0 5B A0 BF  
006178  3  00 00 08 20          .byte 0,0,8,32,16,64,16,240,15,104,23,244,59,250,43,254,19,252,43,254,59,250,23,244,15,104,16,240,16,64,8,32
00617C  3  10 40 10 F0  
006180  3  0F 68 17 F4  
006198  3  00 00 02 08          .byte 0,0,2,8,4,16,4,60,3,218,5,253,142,254,138,255,4,255,138,255,142,254,5,253,3,218,4,60,4,16,2,8
00619C  3  04 10 04 3C  
0061A0  3  03 DA 05 FD  
0061B8  3  00 00 00 82          .byte 0,0,0,130,1,4,1,15,128,246,65,127,163,191,226,191,193,63,226,191,163,191,65,127,128,246,1,15,1,4,0,130
0061BC  3  01 04 01 0F  
0061C0  3  80 F6 41 7F  
0061D8  3  00 00 80 20          .byte 0,0,128,32,0,65,192,67,160,61,208,95,232,239,248,175,240,79,248,175,232,239,208,95,160,61,192,67,0,65,128,32
0061DC  3  00 41 C0 43  
0061E0  3  A0 3D D0 5F  
0061F8  3  00 00 00 C0          .byte 0,0,0,192,1,3,0,244,15,104,23,244,59,250,59,254,19,252,59,254,59,250,23,244,15,104,0,244,1,3,0,192
0061FC  3  01 03 00 F4  
006200  3  0F 68 17 F4  
006218  3  00 00 00 30          .byte 0,0,0,48,192,64,0,61,3,218,5,253,142,254,142,255,4,255,142,255,142,254,5,253,3,218,0,61,192,64,0,48
00621C  3  C0 40 00 3D  
006220  3  03 DA 05 FD  
006238  3  00 00 00 0C          .byte 0,0,0,12,48,16,64,15,128,246,65,127,163,191,227,191,193,63,227,191,163,191,65,127,128,246,64,15,48,16,0,12
00623C  3  30 10 40 0F  
006240  3  80 F6 41 7F  
006258  3  00 00 00 03          .byte 0,0,0,3,12,4,208,3,160,61,208,95,232,239,248,239,240,79,248,239,232,239,208,95,160,61,208,3,12,4,0,3
00625C  3  0C 04 D0 03  
006260  3  A0 3D D0 5F  
006278  3  00 00 20 0C          .byte 0,0,32,12,32,18,16,240,15,104,23,244,59,250,43,254,19,252,43,254,59,250,23,244,15,104,16,240,32,18,32,12
00627C  3  20 12 10 F0  
006280  3  0F 68 17 F4  
006298  3  00 00 08 03          .byte 0,0,8,3,136,4,4,60,3,218,5,253,142,254,138,255,4,255,138,255,142,254,5,253,3,218,4,60,136,4,8,3
00629C  3  88 04 04 3C  
0062A0  3  03 DA 05 FD  
0062B8  3  00 00 C2 00          .byte 0,0,194,0,34,1,1,15,128,246,65,127,163,191,226,191,193,63,226,191,163,191,65,127,128,246,1,15,34,1,194,0
0062BC  3  22 01 01 0F  
0062C0  3  80 F6 41 7F  
0062D8  3  00 00 30 80          .byte 0,0,48,128,72,128,192,67,160,61,208,95,232,239,248,175,240,79,248,175,232,239,208,95,160,61,192,67,72,128,48,128
0062DC  3  48 80 C0 43  
0062E0  3  A0 3D D0 5F  
0062F8  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,7,224,15,240,31,248,63,252,127,254,63,252,33,204,33,132,33,132,63,132,63,132,63,132
0062FC  3  00 00 00 00  
006300  3  07 E0 0F F0  
006318  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,1,248,3,252,7,254,15,255,159,255,15,255,8,115,8,97,8,97,15,225,15,225,15,225
00631C  3  00 00 00 00  
006320  3  01 F8 03 FC  
006338  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,126,0,255,129,255,195,255,231,255,195,255,194,28,66,24,66,24,67,248,67,248,67,248
00633C  3  00 00 00 00  
006340  3  00 7E 00 FF  
006358  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,128,31,192,63,224,127,240,255,249,255,240,255,48,135,16,134,16,134,16,254,16,254,16,254
00635C  3  00 00 00 00  
006360  3  80 1F C0 3F  
006378  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
00637C  3  00 00 00 00  
006380  3  00 00 00 00  
006398  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
00639C  3  00 00 00 00  
0063A0  3  00 00 00 00  
0063B8  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0063BC  3  00 00 00 00  
0063C0  3  00 00 00 00  
0063D8  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0063DC  3  00 00 00 00  
0063E0  3  00 00 00 00  
0063F8  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,0,0,160,3,192,1,64,1,224,2,128,0,0,0,0,0,0,0,0,0,0,0,0
0063FC  3  00 00 00 00  
006400  3  00 00 00 A0  
006418  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,0,0,40,0,240,0,80,0,120,0,160,0,0,0,0,0,0,0,0,0,0,0,0
00641C  3  00 00 00 00  
006420  3  00 00 00 28  
006438  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,0,0,10,0,60,0,20,0,30,0,40,0,0,0,0,0,0,0,0,0,0,0,0
00643C  3  00 00 00 00  
006440  3  00 00 00 0A  
006458  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,0,128,2,0,15,0,5,128,7,0,10,0,0,0,0,0,0,0,0,0,0,0,0
00645C  3  00 00 00 00  
006460  3  00 00 80 02  
006478  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,0,2,128,1,224,1,64,3,192,0,160,0,0,0,0,0,0,0,0,0,0,0,0
00647C  3  00 00 00 00  
006480  3  00 00 02 80  
006498  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,0,0,160,0,120,0,80,0,240,0,40,0,0,0,0,0,0,0,0,0,0,0,0
00649C  3  00 00 00 00  
0064A0  3  00 00 00 A0  
0064B8  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,0,0,40,0,30,0,20,0,60,0,10,0,0,0,0,0,0,0,0,0,0,0,0
0064BC  3  00 00 00 00  
0064C0  3  00 00 00 28  
0064D8  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,0,0,10,128,7,0,5,0,15,128,2,0,0,0,0,0,0,0,0,0,0,0,0
0064DC  3  00 00 00 00  
0064E0  3  00 00 00 0A  
0064F8  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,0,1,32,1,192,3,96,1,192,2,64,0,0,0,0,0,0,0,0,0,0,0,0
0064FC  3  00 00 00 00  
006500  3  00 00 01 20  
006518  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,0,0,72,0,112,0,216,0,112,0,144,0,0,0,0,0,0,0,0,0,0,0,0
00651C  3  00 00 00 00  
006520  3  00 00 00 48  
006538  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,0,0,18,0,28,0,54,0,28,0,36,0,0,0,0,0,0,0,0,0,0,0,0
00653C  3  00 00 00 00  
006540  3  00 00 00 12  
006558  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,0,128,4,0,7,128,13,0,7,0,9,0,0,0,0,0,0,0,0,0,0,0,0
00655C  3  00 00 00 00  
006560  3  00 00 80 04  
006578  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,0,2,64,1,192,3,96,1,192,1,32,0,0,0,0,0,0,0,0,0,0,0,0
00657C  3  00 00 00 00  
006580  3  00 00 02 40  
006598  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,0,0,144,0,112,0,216,0,112,0,72,0,0,0,0,0,0,0,0,0,0,0,0
00659C  3  00 00 00 00  
0065A0  3  00 00 00 90  
0065B8  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,0,0,36,0,28,0,54,0,28,0,18,0,0,0,0,0,0,0,0,0,0,0,0
0065BC  3  00 00 00 00  
0065C0  3  00 00 00 24  
0065D8  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,0,0,9,0,7,128,13,0,7,128,4,0,0,0,0,0,0,0,0,0,0,0,0
0065DC  3  00 00 00 00  
0065E0  3  00 00 00 09  
0065F8  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,19,192,5,160,1,128,8,16
0065FC  3  00 00 00 00  
006600  3  00 00 00 00  
006618  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,240,1,104,0,96,2,4
00661C  3  00 00 00 00  
006620  3  00 00 00 00  
006638  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,60,0,90,0,24,0,129
00663C  3  00 00 00 00  
006640  3  00 00 00 00  
006658  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,79,128,22,0,6,64,32
00665C  3  00 00 00 00  
006660  3  00 00 00 00  
006678  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,192,21,160,1,128,4,32
00667C  3  00 00 00 00  
006680  3  00 00 00 00  
006698  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,240,5,104,0,96,1,8
00669C  3  00 00 00 00  
0066A0  3  00 00 00 00  
0066B8  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,60,1,90,0,24,0,66
0066BC  3  00 00 00 00  
0066C0  3  00 00 00 00  
0066D8  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,128,86,0,6,128,16
0066DC  3  00 00 00 00  
0066E0  3  00 00 00 00  
0066F8  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,200,5,160,1,128,8,16
0066FC  3  00 00 00 00  
006700  3  00 00 00 00  
006718  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,242,1,104,0,96,2,4
00671C  3  00 00 00 00  
006720  3  00 00 00 00  
006738  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,128,60,0,90,0,24,0,129
00673C  3  00 00 00 00  
006740  3  00 00 00 00  
006758  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,32,15,128,22,0,6,64,32
00675C  3  00 00 00 00  
006760  3  00 00 00 00  
006778  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,192,5,168,1,128,4,32
00677C  3  00 00 00 00  
006780  3  00 00 00 00  
006798  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,240,1,106,0,96,1,8
00679C  3  00 00 00 00  
0067A0  3  00 00 00 00  
0067B8  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,60,128,90,0,24,0,66
0067BC  3  00 00 00 00  
0067C0  3  00 00 00 00  
0067D8  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,160,22,0,6,128,16
0067DC  3  00 00 00 00  
0067E0  3  00 00 00 00  
0067F8  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,192,26,160,55,112,106,168,221,211,74,165,32,70,48,96
0067FC  3  00 00 00 00  
006800  3  00 00 00 00  
006818  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,112,6,168,13,220,26,170,247,116,82,169,136,17,12,24
00681C  3  00 00 00 00  
006820  3  00 00 00 00  
006838  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,92,1,170,3,119,134,170,61,221,84,170,98,4,3,6
00683C  3  00 00 00 00  
006840  3  00 00 00 00  
006858  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,23,128,106,192,221,161,170,79,119,149,42,24,129,128,193
00685C  3  00 00 00 00  
006860  3  00 00 00 00  
006878  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,192,26,160,55,112,106,168,93,211,170,165,80,134,24,192
00687C  3  00 00 00 00  
006880  3  00 00 00 00  
006898  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,112,6,168,13,220,26,170,215,116,106,169,148,33,6,48
00689C  3  00 00 00 00  
0068A0  3  00 00 00 00  
0068B8  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,92,1,170,3,119,134,170,53,221,90,170,101,8,1,140
0068BC  3  00 00 00 00  
0068C0  3  00 00 00 00  
0068D8  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,23,128,106,192,221,161,170,77,119,150,170,25,66,0,99
0068DC  3  00 00 00 00  
0068E0  3  00 00 00 00  
0068F8  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,192,26,160,55,112,106,168,93,211,162,133,72,38,12,48
0068FC  3  00 00 00 00  
006900  3  00 00 00 00  
006918  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,112,6,168,13,220,26,170,215,116,104,161,146,9,3,12
00691C  3  00 00 00 00  
006920  3  00 00 00 00  
006938  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,92,1,170,3,119,134,170,53,221,90,40,100,130,0,195
00693C  3  00 00 00 00  
006940  3  00 00 00 00  
006958  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,23,128,106,192,221,161,170,77,119,22,138,153,32,192,48
00695C  3  00 00 00 00  
006960  3  00 00 00 00  
006978  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,0,0,0,3,64,12,176,23,104,58,187,21,229,43,6,116,48,32,16,144,0,24,0
00697C  3  00 00 00 00  
006980  3  00 00 00 00  
006998  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,0,0,0,0,208,3,44,5,218,206,174,69,121,138,193,29,12,8,4,36,0,6,0
00699C  3  00 00 00 00  
0069A0  3  00 00 00 00  
0069B8  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,0,0,0,0,52,0,203,129,118,179,171,81,94,98,176,7,67,2,1,9,0,1,128
0069BC  3  00 00 00 00  
0069C0  3  00 00 00 00  
0069D8  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,0,0,0,0,13,192,50,160,93,236,234,148,87,24,172,193,208,64,128,2,64,0,96
0069DC  3  00 00 00 00  
0069E0  3  00 00 00 00  
0069F8  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,7,12,12,148,51,216,44,128,91,48,102,24,156,0,216,0,160,0,96,0,144,0,24,0
0069FC  3  00 00 00 00  
006A00  3  07 0C 0C 94  
006A18  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,1,195,3,37,12,246,11,32,22,204,25,134,39,0,54,0,40,0,24,0,36,0,6,0
006A1C  3  00 00 00 00  
006A20  3  01 C3 03 25  
006A38  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,192,112,64,201,131,61,2,200,5,179,134,97,9,192,13,128,10,0,6,0,9,0,1,128
006A3C  3  00 00 00 00  
006A40  3  C0 70 40 C9  
006A58  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,48,28,80,50,96,207,0,178,193,108,97,152,2,112,3,96,2,128,1,128,2,64,0,96
006A5C  3  00 00 00 00  
006A60  3  30 1C 50 32  
006A78  3  07 C0 0F E0          .byte 7,192,15,224,13,96,25,48,25,48,31,240,30,240,15,224,69,68,226,142,56,56,7,192,56,56,224,14,64,4,0,0
006A7C  3  0D 60 19 30  
006A80  3  19 30 1F F0  
006A98  3  01 F0 03 F8          .byte 1,240,3,248,3,88,6,76,6,76,7,252,7,188,3,248,17,81,184,163,14,14,1,240,14,14,184,3,16,1,0,0
006A9C  3  03 58 06 4C  
006AA0  3  06 4C 07 FC  
006AB8  3  00 7C 00 FE          .byte 0,124,0,254,0,214,1,147,1,147,1,255,1,239,0,254,68,84,238,40,131,131,0,124,131,131,238,0,68,0,0,0
006ABC  3  00 D6 01 93  
006AC0  3  01 93 01 FF  
006AD8  3  00 1F 80 3F          .byte 0,31,128,63,128,53,192,100,192,100,192,127,192,123,128,63,17,21,59,138,224,224,0,31,224,224,59,128,17,0,0,0
006ADC  3  80 35 C0 64  
006AE0  3  C0 64 C0 7F  
006AF8  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
006AFC  3  00 00 00 00  
006B00  3  00 00 00 00  
006B18  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
006B1C  3  00 00 00 00  
006B20  3  00 00 00 00  
006B38  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
006B3C  3  00 00 00 00  
006B40  3  00 00 00 00  
006B58  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
006B5C  3  00 00 00 00  
006B60  3  00 00 00 00  
006B78  3               frmlst:
006B78  3  00 03                .byte 0,3
006B7A  3  03 03                .byte 3,3
006B7C  3  06 03                .byte 6,3
006B7E  3  09 03                .byte 9,3
006B80  3  0C 03                .byte 12,3
006B82  3  0F 03                .byte 15,3
006B84  3  12 03                .byte 18,3
006B86  3  15 03                .byte 21,3
006B88  3  18 02                .byte 24,2
006B8A  3  1A 03                .byte 26,3
006B8C  3  1D 03                .byte 29,3
006B8E  3  20 03                .byte 32,3
006B90  3  23 03                .byte 35,3
006B92  3  26 02                .byte 38,2
006B94  3  28 02                .byte 40,2
006B96  3  2A 02                .byte 42,2
006B98  3  2C 02                .byte 44,2
006B9A  3  2E 02                .byte 46,2
006B9C  3  30 05                .byte 48,5
006B9E  3  35 02 37 00          .byte 53,2,55,0
006BA2  3               .out .sprintf("SPRITES SIZE = %d", (* - sprgfx))
006BA2  3               
006BA2  3               scdat:
006BA2  3  4E 02 09 00          .word 590,9,9,9,198,307,9
006BA6  3  09 00 09 00  
006BAA  3  C6 00 33 01  
006BB0  3  01 00 01 00          .byte 1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,0,1,0,1,0,1,0
006BB4  3  01 00 01 00  
006BB8  3  01 00 01 00  
006BD1  3  01 00 01 00          .byte 1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,1,0,6,2,2,7,1,0,9,0,1,9,24,23
006BD5  3  01 00 01 00  
006BD9  3  01 00 01 00  
006BF2  3  09 00 01 09          .byte 9,0,1,9,1,0,6,2,2,7,1,0,0,1,3,24,23,3,0,1,3,1,0,3,23,23,3,1,0,3,0,1,3
006BF6  3  01 00 06 02  
006BFA  3  02 07 01 00  
006C13  3  18 17 03 00          .byte 24,23,3,0,1,1,0,8,23,23,8,1,0,3,0,1,5,2,2,4,0,1,3,1,0,8,23,23,8,1,0,0,1
006C17  3  01 01 00 08  
006C1B  3  17 17 08 01  
006C34  3  00 01 00 01          .byte 0,1,0,1,0,1,3,1,0,1,0,1,0,1,0,3,0,1,0,1,0,1,0,1,1,0,1,0,1,0,1,0,3
006C38  3  00 01 03 01  
006C3C  3  00 01 00 01  
006C55  3  00 01 00 01          .byte 0,1,0,1,0,1,0,1,3,1,0,1,0,1,0,1,0,0,1,6,255,2,5,4,1,0,9,0,1,9,1,0,5
006C59  3  00 01 00 01  
006C5D  3  03 01 00 01  
006C76  3  FF 02 05 07          .byte 255,2,5,7,0,1,1,0,3,0,1,0,1,0,1,0,1,3,1,0,3,0,1,0,1,0,1,0,1,3,1,0,0
006C7A  3  00 01 01 00  
006C7E  3  03 00 01 00  
006C97  3  01 03 01 00          .byte 1,3,1,0,1,0,1,0,1,0,3,0,1,3,1,0,1,0,1,0,1,0,3,0,1,1,0,8,0,1,11,2,2
006C9B  3  01 00 01 00  
006C9F  3  01 00 03 00  
006CB8  3  07 00 01 03          .byte 7,0,1,3,1,0,3,0,1,6,2,2,10,0,1,8,1,0,0,1,0,1,0,1,24,23,3,1,0,3,0,1,3
006CBC  3  01 00 03 00  
006CC0  3  01 06 02 02  
006CD9  3  01 00 03 18          .byte 1,0,3,24,23,0,1,0,1,0,1,1,0,1,0,1,0,23,23,3,0,1,3,1,0,3,0,1,3,23,23,1,0
006CDD  3  17 00 01 00  
006CE1  3  01 00 01 01  
006CFA  3  01 00 01 00          .byte 1,0,1,0,0,1,9,1,0,11,2,2,4,1,0,3,0,1,3,1,0,5,2,2,10,1,0,9,0,1,1,0,3
006CFE  3  00 01 09 01  
006D02  3  00 0B 02 02  
006D1B  3  00 01 00 01          .byte 0,1,0,1,0,1,0,1,3,1,0,3,0,1,0,1,0,1,0,1,3,1,0,0,1,3,1,0,1,0,1,0,1
006D1F  3  00 01 00 01  
006D23  3  03 01 00 03  
006D3C  3  00 03 00 01          .byte 0,3,0,1,3,1,0,1,0,1,0,1,0,3,0,1,1,0,5,255,2,5,7,0,1,8,1,0,8,0,1,6,255,2,5
006D40  3  03 01 00 01  
006D44  3  00 01 00 01  
006D5F  3  04 01 00 00          .byte 4,1,0,0,1,0,1,0,1,0,1,3,1,0,1,0,1,0,1,0,3,0,1,0,1,0,1,0,1,1,0,1,0
006D63  3  01 00 01 00  
006D67  3  01 00 01 03  
006D80  3  01 00 01 00          .byte 1,0,1,0,3,0,1,0,1,0,1,0,1,3,1,0,1,0,1,0,1,0,0,1,9,24,23,9,0,1,3,1,0
006D84  3  03 00 01 00  
006D88  3  01 00 01 00  
006DA1  3  06 02 02 07          .byte 6,2,2,7,1,0,3,0,1,9,24,23,9,0,1,1,0,3,23,23,3,1,0,3,0,1,3,24,23,3,0,1,3
006DA5  3  01 00 03 00  
006DA9  3  01 09 18 17  
006DC2  3  01 00 03 17          .byte 1,0,3,23,23,3,1,0,0,1,5,2,2,4,0,1,8,1,0,8,23,23,8,1,0,8,0,1,5,2,2,4,0
006DC6  3  17 03 01 00  
006DCA  3  00 01 05 02  
006DE3  3  01 01 00 01          .byte 1,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
006DE7  3  00 01 00 01  
006DEB  3  00 01 00 01  
006DFE  3  FF 01 00 FF          .byte 255,1,0,255,1,0,255,1,86
006E02  3  01 00 FF 01  
006E06  3  56           
006E07  3  FF 01 00 FF          .byte 255,1,0,255,1,0,255,1,86
006E0B  3  01 00 FF 01  
006E0F  3  56           
006E10  3  FF 01 00 FF          .byte 255,1,0,255,1,0,255,1,86
006E14  3  01 00 FF 01  
006E18  3  56           
006E19  3  FF 17 3D 0E          .byte 255,23,61,14,255,27,10,255,23,14,14,1,255,27,10,255,23,13,14,1,1,255,27,10,255,23,13,1,1,1,255,27,10
006E1D  3  FF 1B 0A FF  
006E21  3  17 0E 0E 01  
006E3A  3  FF 17 0D 01          .byte 255,23,13,1,1,1,255,27,10,255,23,13,1,1,1,255,27,10,255,23,13,1,1,1,255,27,10,255,23,13,1,1,1
006E3E  3  01 01 FF 1B  
006E42  3  0A FF 17 0D  
006E5B  3  FF 1B 0A FF          .byte 255,27,10,255,23,13,1,1,1,255,27,10,255,23,13,1,1,1,255,27,10,255,23,13,1,1,1,255,27,10,255,23,13
006E5F  3  17 0D 01 01  
006E63  3  01 FF 1B 0A  
006E7C  3  01 01 01 FF          .byte 1,1,1,255,27,10,255,23,13,1,1,1,255,27,10,255,23,13,1,1,1,255,27,10,255,23,13,1,1,1,255,27,10
006E80  3  1B 0A FF 17  
006E84  3  0D 01 01 01  
006E9D  3  FF 17 0D 01          .byte 255,23,13,1,1,1,255,27,10,255,23,13,1,1,1,255,27,10,255,23,13,1,1,1,15,16,17,18,19,255,27,5,255,23,13
006EA1  3  01 01 FF 1B  
006EA5  3  0A FF 17 0D  
006EC0  3  01 01 01 17          .byte 1,1,1,23,23,25,23,23,255,27,5,255,23,13,1,1,1,23,23,25,23,23,255,27,5,255,23,6,255,26,26
006EC4  3  17 19 17 17  
006EC8  3  FF 1B 05 FF  
006EDF  3  FF 17 6D 14          .byte 255,23,109,20,22,22,28,23,23,20,22,22,28,23,23,20,22,22,28,255,23,10,20,23,23,21,23,23,20,23,23,21,23,23
006EE3  3  16 16 1C 17  
006EE7  3  17 14 16 16  
006F01  3  14 17 17 15          .byte 20,23,23,21,255,23,10,20,22,22,28,23,23,20,22,22,28,23,23,20,22,22,28,255,23,10,20,23,23,21,23,23,20
006F05  3  FF 17 0A 14  
006F09  3  16 16 1C 17  
006F22  3  17 17 15 17          .byte 23,23,21,23,23,20,23,23,21,255,23,10,20,22,22,28,23,23,20,22,22,28,23,23,20,22,22,28,255,23,10,20,23,23
006F26  3  17 14 17 17  
006F2A  3  15 FF 17 0A  
006F44  3  15 17 17 14          .byte 21,23,23,20,23,23,21,23,23,20,23,23,21,255,23,10,20,22,22,28,23,23,20,22,22,28,23,23,20,22,22,28,255,23,10
006F48  3  17 17 15 17  
006F4C  3  17 14 17 17  
006F67  3  14 17 17 15          .byte 20,23,23,21,23,23,20,23,23,21,23,23,20,23,23,21,255,23,10,20,22,22,28,23,23,20,22,22,28,23,23,20,22,22
006F6B  3  17 17 14 17  
006F6F  3  17 15 17 17  
006F89  3  1C FF 17 0A          .byte 28,255,23,10,20,23,23,21,23,23,20,23,23,21,23,23,20,23,23,21,255,23,10,20,22,22,28,23,23,20,22,22,28
006F8D  3  14 17 17 15  
006F91  3  17 17 14 17  
006FAA  3  17 17 14 16          .byte 23,23,20,22,22,28,255,23,10,20,23,23,21,23,23,20,23,23,21,23,23,20,23,23,21,255,23,10,20,22,22,28,23,23
006FAE  3  16 1C FF 17  
006FB2  3  0A 14 17 17  
006FCC  3  14 16 16 1C          .byte 20,22,22,28,23,23,20,22,22,28,255,23,10,20,23,23,21,23,23,20,23,23,21,23,23,20,23,23,21,255,23,10,20
006FD0  3  17 17 14 16  
006FD4  3  16 1C FF 17  
006FED  3  16 16 1C 17          .byte 22,22,28,23,23,20,22,22,28,23,23,20,22,22,28,255,23,10,20,23,23,21,23,23,20,23,23,21,23,23,20,23,23
006FF1  3  17 14 16 16  
006FF5  3  1C 17 17 14  
00700E  3  15 FF 17 53          .byte 21,255,23,83
007012  3  FF 17 00 FF          .byte 255,23,0,255,23,0,255,23,86
007016  3  17 00 FF 17  
00701A  3  56           
00701B  3               numsc:
00701B  3  07                   .byte 7
00701C  3               .out .sprintf("SCREENS SIZE = %d", (* - scdat))
00701C  3               
00701C  3               nmedat:
00701C  3  00 00 B0 00          .byte 0,0,176,0,8,9,0,192,8,9,0,0,255
007020  3  08 09 00 C0  
007024  3  08 09 00 00  
007029  3  00 00 B0 00          .byte 0,0,176,0,8,10,0,192,8,9,0,0,255
00702D  3  08 0A 00 C0  
007031  3  08 09 00 00  
007036  3  00 00 A8 00          .byte 0,0,168,0,8,10,0,0,8,10,0,192,255
00703A  3  08 0A 00 00  
00703E  3  08 0A 00 C0  
007043  3  00 00 B0 00          .byte 0,0,176,0,8,10,0,0,8,11,0,96,8,10,0,192,255
007047  3  08 0A 00 00  
00704B  3  08 0B 00 60  
007054  3  07 10 00 80          .byte 7,16,0,128,7,16,0,88,7,18,160,0,255
007058  3  07 10 00 58  
00705C  3  07 12 A0 00  
007061  3  05 00 50 60          .byte 5,0,80,96,5,9,144,48,5,9,120,96,5,9,144,144,255
007065  3  05 09 90 30  
007069  3  05 09 78 60  
007072  3  05 10 28 48          .byte 5,16,40,72,5,16,40,0,5,16,40,144,255
007076  3  05 10 28 00  
00707A  3  05 10 28 90  
00707F  3               .out .sprintf("POSITIONS SIZE = %d", (* - nmedat))
00707F  3               
00707F  3               NUMOBJ = 9
00707F  3               objdta:
00707F  3  00 00 3F FC          .byte 0,0,63,252,95,250,120,30,112,14,113,142,115,206,127,206,127,142,126,30,126,126,127,254,126,126,94,122,63,252,0,0,0,24,24,0,24,24
007083  3  5F FA 78 1E  
007087  3  70 0E 71 8E  
0070A5  3  00 00 3F FC          .byte 0,0,63,252,95,250,120,30,112,14,113,142,115,206,127,206,127,142,126,30,126,126,127,254,126,126,94,122,63,252,0,0,0,0,0,0,0,0
0070A9  3  5F FA 78 1E  
0070AD  3  70 0E 71 8E  
0070CB  3  00 00 3F FC          .byte 0,0,63,252,95,250,120,30,112,14,113,142,115,206,127,206,127,142,126,30,126,126,127,254,126,126,94,122,63,252,0,0,0,0,0,0,0,0
0070CF  3  5F FA 78 1E  
0070D3  3  70 0E 71 8E  
0070F1  3  00 00 3F FC          .byte 0,0,63,252,95,250,120,30,112,14,113,142,115,206,127,206,127,142,126,30,126,126,127,254,126,126,94,122,63,252,0,0,0,0,0,0,0,0
0070F5  3  5F FA 78 1E  
0070F9  3  70 0E 71 8E  
007117  3  00 00 3F FC          .byte 0,0,63,252,95,250,120,30,112,14,113,142,115,206,127,206,127,142,126,30,126,126,127,254,126,126,94,122,63,252,0,0,0,0,0,0,0,0
00711B  3  5F FA 78 1E  
00711F  3  70 0E 71 8E  
00713D  3  00 00 3F FC          .byte 0,0,63,252,95,250,120,30,112,14,113,142,115,206,127,206,127,142,126,30,126,126,127,254,126,126,94,122,63,252,0,0,0,0,0,0,0,0
007141  3  5F FA 78 1E  
007145  3  70 0E 71 8E  
007163  3  00 00 3F FC          .byte 0,0,63,252,95,250,120,30,112,14,113,142,115,206,127,206,127,142,126,30,126,126,127,254,126,126,94,122,63,252,0,0,0,0,0,0,0,0
007167  3  5F FA 78 1E  
00716B  3  70 0E 71 8E  
007189  3  00 00 3F FC          .byte 0,0,63,252,95,250,120,30,112,14,113,142,115,206,127,206,127,142,126,30,126,126,127,254,126,126,94,122,63,252,0,0,0,0,0,0,0,0
00718D  3  5F FA 78 1E  
007191  3  70 0E 71 8E  
0071AF  3  00 00 00 00          .byte 0,0,0,0,1,0,17,16,9,32,0,0,3,128,58,184,3,128,0,0,9,32,17,16,1,0,0,0,0,0,0,0,255,0,0,255,0,0
0071B3  3  01 00 11 10  
0071B7  3  09 20 00 00  
0071D5  3               .out .sprintf("OBJECTS SIZE = %d", (* - objdta))
0071D5  3               
0071D5  3               font:
0071D5  3  9E 87 C9 C9          .byte 158,135,201,201,201,201,201,0
0071D9  3  C9 C9 C9 00  
0071DD  3  40 9C 84 88          .byte 64,156,132,136,144,156,64,0
0071E1  3  90 9C 40 00  
0071E5  3  00 EE 4A 4A          .byte 0,238,74,74,74,78,0,0
0071E9  3  4A 4E 00 00  
0071ED  3  00 75 45 47          .byte 0,117,69,71,69,117,0,0
0071F1  3  45 75 00 00  
0071F5  3  00 77 55 75          .byte 0,119,85,117,85,85,0,0
0071F9  3  55 55 00 00  
0071FD  3  00 77 44 47          .byte 0,119,68,71,84,119,0,0
007201  3  54 77 00 00  
007205  3  40 20 20 20          .byte 64,32,32,32,32,32,64,0
007209  3  20 20 40 00  
00720D  3  00 08 10 00          .byte 0,8,16,0,0,0,0,0
007211  3  00 00 00 00  
007215  3  EE 8A EE 28          .byte 238,138,238,40,232,0,0,0
007219  3  E8 00 00 00  
00721D  3  20 10 10 10          .byte 32,16,16,16,16,16,16,32
007221  3  10 10 10 20  
007225  3  00 00 00 00          .byte 0,0,0,0,0,0,0,0
007229  3  00 00 00 00  
00722D  3  00 00 08 08          .byte 0,0,8,8,62,8,8,0
007231  3  3E 08 08 00  
007235  3  00 00 00 00          .byte 0,0,0,0,0,8,8,16
007239  3  00 08 08 10  
00723D  3  00 00 00 00          .byte 0,0,0,0,62,0,0,0
007241  3  3E 00 00 00  
007245  3  00 00 00 00          .byte 0,0,0,0,0,24,24,0
007249  3  00 18 18 00  
00724D  3  00 00 02 04          .byte 0,0,2,4,8,16,32,0
007251  3  08 10 20 00  
007255  3  00 7E 42 42          .byte 0,126,66,66,70,70,126,0
007259  3  46 46 7E 00  
00725D  3  00 18 08 08          .byte 0,24,8,8,24,24,24,0
007261  3  18 18 18 00  
007265  3  00 7E 42 02          .byte 0,126,66,2,126,96,126,0
007269  3  7E 60 7E 00  
00726D  3  00 7C 44 1E          .byte 0,124,68,30,6,70,126,0
007271  3  06 46 7E 00  
007275  3  00 7C 44 44          .byte 0,124,68,68,68,126,12,0
007279  3  44 7E 0C 00  
00727D  3  00 7E 40 7E          .byte 0,126,64,126,6,70,126,0
007281  3  06 46 7E 00  
007285  3  00 7E 40 7E          .byte 0,126,64,126,70,70,126,0
007289  3  46 46 7E 00  
00728D  3  00 7C 04 04          .byte 0,124,4,4,12,12,12,0
007291  3  0C 0C 0C 00  
007295  3  00 3C 24 7E          .byte 0,60,36,126,70,70,126,0
007299  3  46 46 7E 00  
00729D  3  00 7E 42 42          .byte 0,126,66,66,126,6,6,0
0072A1  3  7E 06 06 00  
0072A5  3  00 00 00 10          .byte 0,0,0,16,0,0,16,0
0072A9  3  00 00 10 00  
0072AD  3  00 00 10 00          .byte 0,0,16,0,0,16,16,32
0072B1  3  00 10 10 20  
0072B5  3  00 00 04 08          .byte 0,0,4,8,16,8,4,0
0072B9  3  10 08 04 00  
0072BD  3  00 00 00 3E          .byte 0,0,0,62,0,62,0,0
0072C1  3  00 3E 00 00  
0072C5  3  00 00 10 08          .byte 0,0,16,8,4,8,16,0
0072C9  3  04 08 10 00  
0072CD  3  00 7E 02 3E          .byte 0,126,2,62,48,0,48,0
0072D1  3  30 00 30 00  
0072D5  3  00 3C 4A 56          .byte 0,60,74,86,94,64,60,0
0072D9  3  5E 40 3C 00  
0072DD  3  00 3C 24 24          .byte 0,60,36,36,126,98,98,0
0072E1  3  7E 62 62 00  
0072E5  3  00 7C 44 7E          .byte 0,124,68,126,98,98,126,0
0072E9  3  62 62 7E 00  
0072ED  3  00 7E 42 40          .byte 0,126,66,64,96,98,126,0
0072F1  3  60 62 7E 00  
0072F5  3  00 7E 42 42          .byte 0,126,66,66,98,98,126,0
0072F9  3  62 62 7E 00  
0072FD  3  00 7E 40 7C          .byte 0,126,64,124,96,96,126,0
007301  3  60 60 7E 00  
007305  3  00 7E 40 7C          .byte 0,126,64,124,96,96,96,0
007309  3  60 60 60 00  
00730D  3  00 7E 42 40          .byte 0,126,66,64,102,98,126,0
007311  3  66 62 7E 00  
007315  3  00 42 42 7E          .byte 0,66,66,126,98,98,98,0
007319  3  62 62 62 00  
00731D  3  00 08 08 08          .byte 0,8,8,8,24,24,24,0
007321  3  18 18 18 00  
007325  3  00 04 04 04          .byte 0,4,4,4,70,70,124,0
007329  3  46 46 7C 00  
00732D  3  00 44 44 7E          .byte 0,68,68,126,98,98,98,0
007331  3  62 62 62 00  
007335  3  00 20 20 20          .byte 0,32,32,32,48,48,62,0
007339  3  30 30 3E 00  
00733D  3  00 7E 4A 4A          .byte 0,126,74,74,106,106,106,0
007341  3  6A 6A 6A 00  
007345  3  00 7E 42 42          .byte 0,126,66,66,98,98,98,0
007349  3  62 62 62 00  
00734D  3  00 7E 46 42          .byte 0,126,70,66,66,66,126,0
007351  3  42 42 7E 00  
007355  3  00 7E 42 42          .byte 0,126,66,66,126,96,96,0
007359  3  7E 60 60 00  
00735D  3  00 7E 42 42          .byte 0,126,66,66,66,78,126,0
007361  3  42 4E 7E 00  
007365  3  00 7C 44 44          .byte 0,124,68,68,126,98,98,0
007369  3  7E 62 62 00  
00736D  3  00 7E 40 7E          .byte 0,126,64,126,6,70,126,0
007371  3  06 46 7E 00  
007375  3  00 7C 10 10          .byte 0,124,16,16,24,24,24,0
007379  3  18 18 18 00  
00737D  3  00 42 42 42          .byte 0,66,66,66,98,98,126,0
007381  3  62 62 7E 00  
007385  3  00 62 62 62          .byte 0,98,98,98,102,36,60,0
007389  3  66 24 3C 00  
00738D  3  00 4A 4A 4A          .byte 0,74,74,74,106,106,126,0
007391  3  6A 6A 7E 00  
007395  3  00 42 42 3C          .byte 0,66,66,60,98,98,98,0
007399  3  62 62 62 00  
00739D  3  00 42 42 7E          .byte 0,66,66,126,24,24,24,0
0073A1  3  18 18 18 00  
0073A5  3  00 7E 06 3C          .byte 0,126,6,60,112,96,126,0
0073A9  3  70 60 7E 00  
0073AD  3  CD E8 7B 3A          .byte 205,232,123,58,48,125,119,201
0073B1  3  30 7D 77 C9  
0073B5  3  CD C8 EB 7E          .byte 205,200,235,126,50,48,125,201
0073B9  3  32 30 7D C9  
0073BD  3  06 00 3A 2F          .byte 6,0,58,47,125,71,33,35
0073C1  3  7D 47 21 23  
0073C5  3  F8 09 C9 FC          .byte 248,9,201,252,48,48,48,0
0073C9  3  30 30 30 00  
0073CD  3  00 00 00 00          .byte 0,0,0,0,0,0,0,255
0073D1  3  00 00 00 FF  
0073D5  3  00 3A 2D 7D          .byte 0,58,45,125,103,58,46,125
0073D9  3  67 3A 2E 7D  
0073DD  3  6F 11 01 00          .byte 111,17,1,0,205,181,3,201
0073E1  3  CD B5 03 C9  
0073E5  3  DA 92 D2 92          .byte 218,146,210,146,218,0,0,0
0073E9  3  DA 00 00 00  
0073ED  3  E8 A8 E8 A8          .byte 232,168,232,168,172,0,0,0
0073F1  3  AC 00 00 00  
0073F5  3  EA 4A 4E 4A          .byte 234,74,78,74,74,0,0,0
0073F9  3  4A 00 00 00  
0073FD  3  A7 42 42 42          .byte 167,66,66,66,162,0,0,0
007401  3  A2 00 00 00  
007405  3  73 52 52 52          .byte 115,82,82,82,115,0,0,0
007409  3  73 00 00 00  
00740D  3  0E 88 8E 82          .byte 14,136,142,130,46,0,0,0
007411  3  2E 00 00 00  
007415  3  EE AA EE A8          .byte 238,170,238,168,168,0,0,0
007419  3  A8 00 00 00  
00741D  3  95 95 F5 95          .byte 149,149,245,149,149,0,0,0
007421  3  95 00 00 00  
007425  3  B8 29 B3 29          .byte 184,41,179,41,168,0,0,0
007429  3  A8 00 00 00  
00742D  3  31 21 A1 21          .byte 49,33,161,33,53,0,0,0
007431  3  35 00 00 00  
007435  3  5D 55 D5 55          .byte 93,85,213,85,93,0,0,0
007439  3  5D 00 00 00  
00743D  3  17 15 57 55          .byte 23,21,87,85,245,0,0,0
007441  3  F5 00 00 00  
007445  3  76 55 65 55          .byte 118,85,101,85,86,0,0,0
007449  3  56 00 00 00  
00744D  3  EE 3A 2F 7D          .byte 238,58,47,125,50,73,175,201
007451  3  32 49 AF C9  
007455  3  AD 06 09 77          .byte 173,6,9,119,35,16,252,201
007459  3  23 10 FC C9  
00745D  3  30 30 30 30          .byte 48,48,48,48,48,48,205,153
007461  3  30 30 CD 99  
007465  3  7C C9 CD 99          .byte 124,201,205,153,124,205,185,124
007469  3  7C CD B9 7C  
00746D  3  C9 06 05 21          .byte 201,6,5,33,176,91,17,192
007471  3  B0 5B 11 C0  
007475  3  86 AF 1A BE          .byte 134,175,26,190,202,171,124,210
007479  3  CA AB 7C D2  
00747D  3  B0 7C C9 2C          .byte 176,124,201,44,28,16,242,201
007481  3  1C 10 F2 C9  
007485  3  77 2C 1C 1A          .byte 119,44,28,26,16,250,195,171
007489  3  10 FA C3 AB  
00748D  3  7C 3E 02 CD          .byte 124,62,2,205,1,22,62,22
007491  3  01 16 3E 16  
007495  3  D7 3A 31 7D          .byte 215,58,49,125,215,58,50,125
007499  3  D7 3A 32 7D  
00749D  3  D7 06 05 11          .byte 215,6,5,17,176,91,26,215
0074A1  3  B0 5B 1A D7  
0074A5  3  13 10 FB C9          .byte 19,16,251,201,124,96,124,0
0074A9  3  7C 60 7C 00  
0074AD  3  EE 3A 2A 7D          .byte 238,58,42,125,50,5,125,201
0074B1  3  32 05 7D C9  
0074B5  3  00 08 08 08          .byte 0,8,8,8,8,8,8,0
0074B9  3  08 08 08 00  
0074BD  3  00 70 10 1C          .byte 0,112,16,28,16,16,112,0
0074C1  3  10 10 70 00  
0074C5  3  00 14 28 00          .byte 0,20,40,0,0,0,0,0
0074C9  3  00 00 00 00  
0074CD  3  7E 81 BD A1          .byte 126,129,189,161,161,189,129,126
0074D1  3  A1 BD 81 7E  
0074D5  3               .out .sprintf("FONT SIZE = %d", (* - font))
0074D5  3               
0074D5  3  42 61 68 48  keys:   .byte 66,97,104,72,98,16,55,48,49,17,18
0074D9  3  62 10 37 30  
0074DD  3  31 11 12     
0074E0  3               .out .sprintf("KEYS SIZE = %d", (* - keys))
0074E0  3               
0074E0  3               data_end:
0074E0  3               .out .sprintf("TOTAL DATA SIZE = %d", (* - data_start))
0074E0  3               
0074E0  2               
0074E0  1               
0074E0  1               end_asm:
0074E0  1               
0074E0  1               ;----------------------------------------------------------------------
0074E0  1               ; RELOCATION OF BEEB CODE FROM LOAD ADDRESS
0074E0  1               ;----------------------------------------------------------------------
0074E0  1               
0074E0  1               relocate:
0074E0  1               ; Issue *TAPE otherwise DFS goes mental that we've overwritten workspace from &E00 - &1100
0074E0  1               
0074E0  1  A9 8C            lda #$8C
0074E2  1  A2 0C            ldx #$0C
0074E4  1  A0 00            ldy #$00
0074E6  1  20 F4 FF         jsr OSBYTE					; *FX &8C,0,0 - *TAPE 1200
0074E9  1               
0074E9  1               ; Other one off initialisation could happen here...
0074E9  1               
0074E9  1               ; Relocate all code down to &E00
0074E9  1  A2 67        	ldx #>(end_asm - start_asm) + 1
0074EB  1  A0 00        	ldy #0
0074ED  1               reloop:
0074ED  1  B9 00 12     	lda load_address, y
0074F0  1  99 00 0E     	sta asm_code, y
0074F3  1  C8           	iny
0074F4  1  D0 F7        	bne reloop
0074F6  1  EE EF 78     	inc reloop + 2 + load_address - asm_code
0074F9  1  EE F2 78     	inc reloop + 5 + load_address - asm_code
0074FC  1  CA           	dex
0074FD  1  D0 EE        	bne reloop
0074FF  1  4C 03 0E     	jmp boot_game
0074FF  1               
